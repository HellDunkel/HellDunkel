/*! Built with IMPACT - impactjs.com */

!function(e){"use strict";if(Number.prototype.map=function(e,i,t,s){return t+(this-e)/(i-e)*(s-t)},Number.prototype.limit=function(e,i){return Math.min(i,Math.max(e,this))},Number.prototype.round=function(e){return e=Math.pow(10,e||0),Math.round(this*e)/e},Number.prototype.floor=function(){return Math.floor(this)},Number.prototype.ceil=function(){return Math.ceil(this)},Number.prototype.toInt=function(){return 0|this},Number.prototype.toRad=function(){return this/180*Math.PI},Number.prototype.toDeg=function(){return 180*this/Math.PI},Object.defineProperty(Array.prototype,"erase",{value:function(e){for(var i=this.length;i--;)this[i]===e&&this.splice(i,1);return this}}),Object.defineProperty(Array.prototype,"random",{value:function(e){return this[Math.floor(Math.random()*this.length)]}}),Function.prototype.bind=Function.prototype.bind||function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var i=Array.prototype.slice.call(arguments,1),t=this,s=function(){},n=function(){return t.apply(this instanceof s&&e?this:e,i.concat(Array.prototype.slice.call(arguments)))};return s.prototype=this.prototype,n.prototype=new s,n},e.ig={game:null,debug:null,version:"1.24",global:e,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:e.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(e){return"#"==e.charAt(0)?document.getElementById(e.substr(1)):document.getElementsByTagName(e)},$new:function(e){return document.createElement(e)},copy:function(e){if(!e||"object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class)return e;if(e instanceof Array){for(var i=[],t=0,s=e.length;t<s;t++)i[t]=ig.copy(e[t]);return i}var i={};for(var t in e)i[t]=ig.copy(e[t]);return i},merge:function(e,i){for(var t in i){var s=i[t];"object"!=typeof s||s instanceof HTMLElement||s instanceof ig.Class||null===s?e[t]=s:(e[t]&&"object"==typeof e[t]||(e[t]=s instanceof Array?[]:{}),ig.merge(e[t],s))}return e},ksort:function(e){if(!e||"object"!=typeof e)return[];var i=[],t=[];for(var s in e)i.push(s);i.sort();for(var s=0;s<i.length;s++)t.push(e[i[s]]);return t},setVendorAttribute:function(e,i,t){var s=i.charAt(0).toUpperCase()+i.substr(1);e[i]=e["ms"+s]=e["moz"+s]=e["webkit"+s]=e["o"+s]=t},getVendorAttribute:function(e,i){var t=i.charAt(0).toUpperCase()+i.substr(1);return e[i]||e["ms"+t]||e["moz"+t]||e["webkit"+t]||e["o"+t]},normalizeVendorAttribute:function(e,i){var t=ig.getVendorAttribute(e,i);!e[i]&&t&&(e[i]=t)},getImagePixels:function(e,i,t,s,n){var a=ig.$new("canvas");a.width=e.width,a.height=e.height;var o=a.getContext("2d");ig.System.SCALE.CRISP(a,o);var r=ig.getVendorAttribute(o,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(o,"getImageDataHD");var h=e.width/r,l=e.height/r;return a.width=Math.ceil(h),a.height=Math.ceil(l),o.drawImage(e,0,0,h,l),1===r?o.getImageData(i,t,s,n):o.getImageDataHD(i,t,s,n)},module:function(e){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[e]&&ig.modules[e].body)throw"Module '"+e+"' is already defined";return ig._current={name:e,requires:[],loaded:!1,body:null},ig.modules[e]=ig._current,ig._loadQueue.push(ig._current),ig},requires:function(){return ig._current.requires=Array.prototype.slice.call(arguments),ig},defines:function(e){ig._current.body=e,ig._current=null,ig._initDOMReady()},addResource:function(e){ig.resources.push(e)},setNocache:function(e){ig.nocache=e?"?"+Date.now():""},log:function(){},assert:function(e,i){},show:function(e,i){},mark:function(e,i){},_loadScript:function(e,i){ig.modules[e]={name:e,requires:[],loaded:!1,body:null},ig._waitForOnload++;var t=ig.prefix+ig.lib+e.replace(/\./g,"/")+".js"+ig.nocache,s=ig.$new("script");s.type="text/javascript",s.src=t,s.onload=function(){ig._waitForOnload--,ig._execModules()},s.onerror=function(){throw"Failed to load module "+e+" at "+t+" required from "+i},ig.$("head")[0].appendChild(s)},_execModules:function(){for(var e=!1,i=0;i<ig._loadQueue.length;i++){for(var t=ig._loadQueue[i],s=!0,n=0;n<t.requires.length;n++){var a=t.requires[n];ig.modules[a]?ig.modules[a].loaded||(s=!1):(s=!1,ig._loadScript(a,t.name))}s&&t.body&&(ig._loadQueue.splice(i,1),t.loaded=!0,t.body(),e=!0,i--)}if(e)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){for(var o=[],i=0;i<ig._loadQueue.length;i++){for(var r=[],h=ig._loadQueue[i].requires,n=0;n<h.length;n++){var t=ig.modules[h[n]];t&&t.loaded||r.push(h[n])}o.push(ig._loadQueue[i].name+" (requires: "+r.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+o.join("\n")}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0,ig._waitForOnload--,ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&ig.setNocache(!0),ig.ua.pixelRatio=e.devicePixelRatio||1,ig.ua.viewport={width:e.innerWidth,height:e.innerHeight},ig.ua.screen={width:e.screen.availWidth*ig.ua.pixelRatio,height:e.screen.availHeight*ig.ua.pixelRatio},ig.ua.iPhone=/iPhone/i.test(navigator.userAgent),ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio,ig.ua.iPad=/iPad/i.test(navigator.userAgent),ig.ua.android=/android/i.test(navigator.userAgent),ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent),ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad,ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||/mobile/i.test(navigator.userAgent),ig.ua.touchDevice="ontouchstart"in e||e.navigator.msMaxTouchPoints},_initDOMReady:function(){if(ig.modules["dom.ready"])return void ig._execModules();ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),e.addEventListener("load",ig._DOMReady,!1))}},ig.normalizeVendorAttribute(e,"requestAnimationFrame"),e.requestAnimationFrame){var i=1,t={};e.ig.setAnimation=function(s,n){var a=i++;t[a]=!0;var o=function(){t[a]&&(e.requestAnimationFrame(o,n),s())};return e.requestAnimationFrame(o,n),a},e.ig.clearAnimation=function(e){delete t[e]}}else e.ig.setAnimation=function(i,t){return e.setInterval(i,1e3/60)},e.ig.clearAnimation=function(i){e.clearInterval(i)};var s=!1,n=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,a=0;e.ig.Class=function(){};var o=function(e){var i=this.prototype,t={};for(var s in e)"function"==typeof e[s]&&"function"==typeof i[s]&&n.test(e[s])?(t[s]=i[s],i[s]=function(e,i){return function(){var s=this.parent;this.parent=t[e];var n=i.apply(this,arguments);return this.parent=s,n}}(s,e[s])):i[s]=e[s]};e.ig.Class.extend=function(i){function t(){if(!s){if(this.staticInstantiate){var e=this.staticInstantiate.apply(this,arguments);if(e)return e}for(var i in this)"object"==typeof this[i]&&(this[i]=ig.copy(this[i]));this.init&&this.init.apply(this,arguments)}return this}var r=this.prototype;s=!0;var h=new this;s=!1;for(var l in i)"function"==typeof i[l]&&"function"==typeof r[l]&&n.test(i[l])?h[l]=function(e,i){return function(){var t=this.parent;this.parent=r[e];var s=i.apply(this,arguments);return this.parent=t,s}}(l,i[l]):h[l]=i[l];return t.prototype=h,t.prototype.constructor=t,t.extend=e.ig.Class.extend,t.inject=o,t.classId=h.classId=++a,t},e.ImpactMixin&&ig.merge(ig,e.ImpactMixin)}(window),ig.baked=!0,ig.module("impact.image").defines(function(){"use strict";ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(e){return ig.Image.cache[e]||null},init:function(e){this.path=e,this.load()},load:function(e){if(this.loaded)return void(e&&e(this.path,!0));!this.loaded&&ig.ready?(this.loadCallback=e||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),ig.Image.cache[this.path]=this},reload:function(){this.loaded=!1,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.src=this.path+"?"+Date.now()},onload:function(e){this.width=this.data.width,this.height=this.data.height,this.loaded=!0,1!=ig.system.scale&&this.resize(ig.system.scale),this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(e){this.failed=!0,this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(e){var i=ig.getImagePixels(this.data,0,0,this.width,this.height),t=this.width*e,s=this.height*e,n=ig.$new("canvas");n.width=t,n.height=s;for(var a=n.getContext("2d"),o=a.getImageData(0,0,t,s),r=0;r<s;r++)for(var h=0;h<t;h++){var l=4*(Math.floor(r/e)*this.width+Math.floor(h/e)),g=4*(r*t+h);o.data[g]=i.data[l],o.data[g+1]=i.data[l+1],o.data[g+2]=i.data[l+2],o.data[g+3]=i.data[l+3]}a.putImageData(o,0,0),this.data=n},draw:function(e,i,t,s,n,a){if(this.loaded){var o=ig.system.scale;t=t?t*o:0,s=s?s*o:0,n=(n||this.width)*o,a=(a||this.height)*o,ig.system.context.drawImage(this.data,t,s,n,a,ig.system.getDrawPos(e),ig.system.getDrawPos(i),n,a),ig.Image.drawCount++}},drawTile:function(e,i,t,s,n,a,o){if(n=n||s,!(!this.loaded||s>this.width||n>this.height)){var r=ig.system.scale,h=Math.floor(s*r),l=Math.floor(n*r),g=a?-1:1,c=o?-1:1;(a||o)&&(ig.system.context.save(),ig.system.context.scale(g,c)),ig.system.context.drawImage(this.data,Math.floor(t*s)%this.width*r,Math.floor(t*s/this.width)*n*r,h,l,ig.system.getDrawPos(e)*g-(a?h:0),ig.system.getDrawPos(i)*c-(o?l:0),h,l),(a||o)&&ig.system.context.restore(),ig.Image.drawCount++}}}),ig.Image.drawCount=0,ig.Image.cache={},ig.Image.reloadCache=function(){for(var e in ig.Image.cache)ig.Image.cache[e].reload()}}),ig.baked=!0,ig.module("impact.font").requires("impact.image").defines(function(){"use strict";ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(e){this._loadMetrics(this.data),this.parent(e)},widthForString:function(e){if(-1!==e.indexOf("\n")){for(var i=e.split("\n"),t=0,s=0;s<i.length;s++)t=Math.max(t,this._widthForLine(i[s]));return t}return this._widthForLine(e)},_widthForLine:function(e){for(var i=0,t=0;t<e.length;t++)i+=this.widthMap[e.charCodeAt(t)-this.firstChar]+this.letterSpacing;return i},heightForString:function(e){return e.split("\n").length*(this.height+this.lineSpacing)},draw:function(e,i,t,s){if("string"!=typeof e&&(e=e.toString()),-1===e.indexOf("\n")){if(s==ig.Font.ALIGN.RIGHT||s==ig.Font.ALIGN.CENTER){var n=this._widthForLine(e);i-=s==ig.Font.ALIGN.CENTER?n/2:n}1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(var a=0;a<e.length;a++){var o=e.charCodeAt(a);i+=this._drawChar(o-this.firstChar,i,t)}1!==this.alpha&&(ig.system.context.globalAlpha=1),ig.Image.drawCount+=e.length}else for(var r=e.split("\n"),h=this.height+this.lineSpacing,a=0;a<r.length;a++)this.draw(r[a],i,t+a*h,s)},_drawChar:function(e,i,t){if(!this.loaded||e<0||e>=this.indices.length)return 0;var s=ig.system.scale,n=this.indices[e]*s,a=this.widthMap[e]*s,o=(this.height-2)*s;return ig.system.context.drawImage(this.data,n,0,a,o,ig.system.getDrawPos(i),ig.system.getDrawPos(t),a,o),this.widthMap[e]+this.letterSpacing},_loadMetrics:function(e){this.height=e.height-1,this.widthMap=[],this.indices=[];for(var i=ig.getImagePixels(e,0,e.height-1,e.width,1),t=0,s=0,n=0;n<e.width;n++){var a=4*n+3;i.data[a]>127?s++:i.data[a]<128&&s&&(this.widthMap.push(s),this.indices.push(n-s),t++,s=0)}this.widthMap.push(s),this.indices.push(n-s)}}),ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}}),ig.baked=!0,ig.module("impact.sound").defines(function(){"use strict";ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)return void(ig.Sound.enabled=!1);for(var e=new Audio,i=0;i<ig.Sound.use.length;i++){var t=ig.Sound.use[i];if(e.canPlayType(t.mime)){this.format=t;break}}this.format||(ig.Sound.enabled=!1),ig.Sound.enabled&&ig.Sound.useWebAudio&&(this.audioContext=new AudioContext,this.boundWebAudioUnlock=this.unlockWebAudio.bind(this),document.addEventListener("touchstart",this.boundWebAudioUnlock,!1))},unlockWebAudio:function(){document.removeEventListener("touchstart",this.boundWebAudioUnlock,!1);var e=this.audioContext.createBuffer(1,1,22050),i=this.audioContext.createBufferSource();i.buffer=e,i.connect(this.audioContext.destination),i.start(0)},load:function(e,i,t){return i&&ig.Sound.useWebAudio?this.loadWebAudio(e,i,t):this.loadHTML5Audio(e,i,t)},loadWebAudio:function(e,i,t){var s=ig.prefix+e.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[e])return this.clips[e];var n=new ig.Sound.WebAudioSource;this.clips[e]=n;var a=new XMLHttpRequest;a.open("GET",s,!0),a.responseType="arraybuffer";var o=this;return a.onload=function(i){o.audioContext.decodeAudioData(a.response,function(s){n.buffer=s,t(e,!0,i)},function(i){t(e,!1,i)})},a.onerror=function(i){t(e,!1,i)},a.send(),n},loadHTML5Audio:function(e,i,t){var s=ig.prefix+e.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[e]){if(this.clips[e]instanceof ig.Sound.WebAudioSource)return this.clips[e];if(i&&this.clips[e].length<ig.Sound.channels)for(var n=this.clips[e].length;n<ig.Sound.channels;n++){var a=new Audio(s);a.load(),this.clips[e].push(a)}return this.clips[e][0]}var o=new Audio(s);if(t&&(ig.ua.mobile?setTimeout(function(){t(e,!0,null)},0):(o.addEventListener("canplaythrough",function i(s){o.removeEventListener("canplaythrough",i,!1),t(e,!0,s)},!1),o.addEventListener("error",function(i){t(e,!1,i)},!1))),o.preload="auto",o.load(),this.clips[e]=[o],i)for(var n=1;n<ig.Sound.channels;n++){var a=new Audio(s);a.load(),this.clips[e].push(a)}return o},get:function(e){var i=this.clips[e];if(i&&i instanceof ig.Sound.WebAudioSource)return i;for(var t,s=0;t=i[s++];)if(t.paused||t.ended)return t.ended&&(t.currentTime=0),t;return i[0].pause(),i[0].currentTime=0,i[0]}}),ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this),Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})},add:function(e,i){if(ig.Sound.enabled){var t=e instanceof ig.Sound?e.path:e,s=ig.soundManager.load(t,!1);if(s instanceof ig.Sound.WebAudioSource)throw ig.system.stopRunLoop(),"Sound '"+t+"' loaded as Multichannel but used for Music. Set the multiChannel param to false when loading, e.g.: new ig.Sound(path, false)";s.loop=this._loop,s.volume=this._volume,s.addEventListener("ended",this._endedCallbackBound,!1),this.tracks.push(s),i&&(this.namedTracks[i]=s),this.currentTrack||(this.currentTrack=s)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(e){if(e&&this.namedTracks[e]){var i=this.namedTracks[e];i!=this.currentTrack&&(this.stop(),this.currentTrack=i)}else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(e){this._loop=e;for(var i in this.tracks)this.tracks[i].loop=e},getVolume:function(){return this._volume},setVolume:function(e){this._volume=e.limit(0,1);for(var i in this.tracks)this.tracks[i].volume=this._volume},fadeOut:function(e){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(e),this._fadeInterval=setInterval(this._fadeStep.bind(this),50))},_fadeStep:function(){var e=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;e<=.01?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=e},_endedCallback:function(){this._loop?this.play():this.next()}}),ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,_loop:!1,init:function(e,i){this.path=e,this.multiChannel=!1!==i,Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)}),this.load()},getLooping:function(){return this._loop},setLooping:function(e){this._loop=e,this.currentClip&&(this.currentClip.loop=e)},load:function(e){if(!ig.Sound.enabled)return void(e&&e(this.path,!0));ig.ready?ig.soundManager.load(this.path,this.multiChannel,e):ig.addResource(this)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.loop=this._loop,this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}}),ig.Sound.WebAudioSource=ig.Class.extend({sources:[],gain:null,buffer:null,_loop:!1,init:function(){this.gain=ig.soundManager.audioContext.createGain(),this.gain.connect(ig.soundManager.audioContext.destination),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)}),Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)})},play:function(){if(this.buffer){var e=ig.soundManager.audioContext.createBufferSource();e.buffer=this.buffer,e.connect(this.gain),e.loop=this._loop;var i=this;this.sources.push(e),e.onended=function(){i.sources.erase(e)},e.start(0)}},pause:function(){for(var e=0;e<this.sources.length;e++)try{this.sources[e].stop()}catch(e){}},getLooping:function(){return this._loop},setLooping:function(e){this._loop=e;for(var i=0;i<this.sources.length;i++)this.sources[i].loop=e},getVolume:function(){return this.gain.gain.value},setVolume:function(e){this.gain.gain.value=e}}),ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},CAF:{ext:"caf",mime:"audio/x-caf"}},ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3],ig.Sound.channels=4,ig.Sound.enabled=!0,ig.normalizeVendorAttribute(window,"AudioContext"),ig.Sound.useWebAudio=!!window.AudioContext&&!window.nwf}),ig.baked=!0,ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(e,i){this.gameClass=e,this.resources=i,this._loadCallbackBound=this._loadCallback.bind(this);for(var t=0;t<this.resources.length;t++)this._unloaded.push(this.resources[t].path)},load:function(){if(ig.system.clear("#000"),!this.resources.length)return void this.end();for(var e=0;e<this.resources.length;e++)this.loadResource(this.resources[e]);this._intervalId=setInterval(this.draw.bind(this),16)},loadResource:function(e){e.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),ig.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var e=ig.system.scale,i=.6*ig.system.width,t=.1*ig.system.height,s=.5*ig.system.width-i/2,n=.5*ig.system.height-t/2;ig.system.context.fillStyle="#000",ig.system.context.fillRect(0,0,480,320),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(s*e,n*e,i*e,t*e),ig.system.context.fillStyle="#000",ig.system.context.fillRect(s*e+e,n*e+e,i*e-e-e,t*e-e-e),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(s*e,n*e,i*e*this._drawStatus,t*e)},_loadCallback:function(e,i){if(!i)throw"Failed to load resource: "+e;this._unloaded.erase(e),this.status=1-this._unloaded.length/this.resources.length,0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})}),ig.baked=!0,ig.module("impact.timer").defines(function(){"use strict";ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(e){this.base=ig.Timer.time,this.last=ig.Timer.time,this.target=e||0},set:function(e){this.target=e||0,this.base=ig.Timer.time,this.pausedAt=0},reset:function(){this.base=ig.Timer.time,this.pausedAt=0},tick:function(){var e=ig.Timer.time-this.last;return this.last=ig.Timer.time,this.pausedAt?0:e},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}}),ig.Timer._last=0,ig.Timer.time=Number.MIN_VALUE,ig.Timer.timeScale=1,ig.Timer.maxStep=.05,ig.Timer.step=function(){var e=Date.now(),i=(e-ig.Timer._last)/1e3;ig.Timer.time+=Math.min(i,ig.Timer.maxStep)*ig.Timer.timeScale,ig.Timer._last=e}}),ig.baked=!0,ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(e,i,t,s,n){this.fps=i,this.clock=new ig.Timer,this.canvas=ig.$(e),this.resize(t,s,n),this.context=this.canvas.getContext("2d"),this.getDrawPos=ig.System.drawMode,1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP),ig.System.scaleMode(this.canvas,this.context)},resize:function(e,i,t){this.width=e,this.height=i,this.scale=t||this.scale,this.realWidth=this.width*this.scale,this.realHeight=this.height*this.scale,this.canvas.width=this.realWidth,this.canvas.height=this.realHeight},setGame:function(e){this.running?this.newGameClass=e:this.setGameNow(e)},setGameNow:function(e){ig.game=new e,ig.system.setDelegate(ig.game)},setDelegate:function(e){if("function"!=typeof e.run)throw"System.setDelegate: No run() function in object";this.delegate=e,this.startRunLoop()},stopRunLoop:function(){ig.clearAnimation(this.animationId),this.running=!1},startRunLoop:function(){this.stopRunLoop(),this.animationId=ig.setAnimation(this.run.bind(this),this.canvas),this.running=!0},clear:function(e){this.context.fillStyle=e,this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step(),this.tick=this.clock.tick(),this.delegate.run(),ig.input.clearPressed(),this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null}),ig.System.DRAW={AUTHENTIC:function(e){return Math.round(e)*this.scale},SMOOTH:function(e){return Math.round(e*this.scale)},SUBPIXEL:function(e){return e*this.scale}},ig.System.drawMode=ig.System.DRAW.SMOOTH,ig.System.SCALE={CRISP:function(e,i){ig.setVendorAttribute(i,"imageSmoothingEnabled",!1),e.style.imageRendering="-moz-crisp-edges",e.style.imageRendering="-o-crisp-edges",e.style.imageRendering="-webkit-optimize-contrast",e.style.imageRendering="crisp-edges",e.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(e,i){ig.setVendorAttribute(i,"imageSmoothingEnabled",!0),e.style.imageRendering="",e.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH}),ig.baked=!0,ig.module("impact.input").defines(function(){"use strict";ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190},ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var e=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",e,!1),ig.system.canvas.addEventListener("DOMMouseScroll",e,!1),ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1),ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1),ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||(this.isUsingAccelerometer=!0,window.addEventListener("devicemotion",this.devicemotion.bind(this),!1))},mousewheel:function(e){var i=e.wheelDelta?e.wheelDelta:-1*e.detail,t=i>0?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN,s=this.bindings[t];s&&(this.actions[s]=!0,this.presses[s]=!0,this.delayedKeyup[s]=!0,e.stopPropagation(),e.preventDefault())},mousemove:function(e){var i=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,t=ig.system.scale*(i/ig.system.realWidth),s={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(s=ig.system.canvas.getBoundingClientRect());var n=e.touches?e.touches[0]:e;this.mouse.x=(n.clientX-s.left)/t,this.mouse.y=(n.clientY-s.top)/t},contextmenu:function(e){this.bindings[ig.KEY.MOUSE2]&&(e.stopPropagation(),e.preventDefault())},keydown:function(e){var i=e.target.tagName;if("INPUT"!=i&&"TEXTAREA"!=i){var t="keydown"==e.type?e.keyCode:2==e.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1;t<0&&!ig.ua.mobile&&window.focus(),"touchstart"!=e.type&&"mousedown"!=e.type||this.mousemove(e);var s=this.bindings[t];s&&(this.actions[s]=!0,this.locks[s]||(this.presses[s]=!0,this.locks[s]=!0),e.preventDefault())}},keyup:function(e){var i=e.target.tagName;if("INPUT"!=i&&"TEXTAREA"!=i){var t="keyup"==e.type?e.keyCode:2==e.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,s=this.bindings[t];s&&(this.delayedKeyup[s]=!0,e.preventDefault())}},devicemotion:function(e){this.accel=e.accelerationIncludingGravity},bind:function(e,i){e<0?this.initMouse():e>0&&this.initKeyboard(),this.bindings[e]=i},bindTouch:function(e,i){var t=ig.$(e),s=this;t.addEventListener("touchstart",function(e){s.touchStart(e,i)},!1),t.addEventListener("touchend",function(e){s.touchEnd(e,i)},!1),t.addEventListener("MSPointerDown",function(e){s.touchStart(e,i)},!1),t.addEventListener("MSPointerUp",function(e){s.touchEnd(e,i)},!1)},unbind:function(e){var i=this.bindings[e];this.delayedKeyup[i]=!0,this.bindings[e]=null},unbindAll:function(){this.bindings={},this.actions={},this.presses={},this.locks={},this.delayedKeyup={}},state:function(e){return this.actions[e]},pressed:function(e){return this.presses[e]},released:function(e){return!!this.delayedKeyup[e]},clearPressed:function(){for(var e in this.delayedKeyup)this.actions[e]=!1,this.locks[e]=!1;this.delayedKeyup={},this.presses={}},touchStart:function(e,i){return this.actions[i]=!0,this.presses[i]=!0,e.stopPropagation(),e.preventDefault(),!1},touchEnd:function(e,i){return this.delayedKeyup[i]=!0,e.stopPropagation(),e.preventDefault(),!1}})}),ig.baked=!0,ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){"use strict";ig.main=function(e,i,t,s,n,a,o){ig.system=new ig.System(e,t,s,n,a||1),ig.input=new ig.Input,ig.soundManager=new ig.SoundManager,ig.music=new ig.Music,ig.ready=!0,new(o||ig.Loader)(i,ig.resources).load()}}),ig.merge=function(e,i){if(e=e||{},i)for(var t in i){var s=i[t],n=typeof s;"undefined"!==n&&("object"!==n||s instanceof HTMLElement||s instanceof ig.Class?("string"===n&&("true"===s?s=!0:"false"===s&&(s=!1)),e[t]=s):(e[t]&&"object"==typeof e[t]||(e[t]=s instanceof Array?[]:{}),ig.merge(e[t],s)))}return e},ig.baked=!0,ig.module("plusplus.config-user").defines(function(){ig.CONFIG_USER={TOP_DOWN:!0,GAME_WIDTH_PCT:1,GAME_HEIGHT_PCT:1,GAME_WIDTH_VIEW:320,GAME_HEIGHT_VIEW:200,TRANSITION_LEVELS:!0,FONT:{CHAT_NAME:"helmut_font_10px.png"},TEXT_BUBBLE:{PIXEL_PERFECT:!0,TRIANGLE_LENGTH:0,PADDING_X:5,PADDING_Y:4,R:0,G:0,B:0,ALPHA:.8,CORNER_RADIUS:0},CAMERA:{AUTO_FOLLOW_PLAYER:!1},CHARACTER:{MAX_VEL_GROUNDED_Y:30,MAX_VEL_GROUNDED_X:60}}}),ig.baked=!0,ig.module("plusplus.core.config").requires("plusplus.config-user").defines(function(){"use strict";ig.CONFIG={},ig.CONFIG.FORCE_ENTITY_EXTENDED=!0,ig.CONFIG.AUTO_CRISP_SCALING=!0,ig.CONFIG.MIN_TIME_STEP=(ig.ua.mobile?1e3/30:1e3/60)/1e3,ig.CONFIG.PATH_TO_MEDIA="media/",ig.CONFIG.DURATION_THROTTLE=500,ig.CONFIG.DURATION_THROTTLE_MEDIUM=250,ig.CONFIG.DURATION_THROTTLE_SHORT=60,ig.CONFIG.DURATION_TWEEN=500,ig.CONFIG.DURATION_FADE=300,ig.CONFIG.GAME_WIDTH=ig.ua.viewport.width,ig.CONFIG.GAME_HEIGHT=ig.ua.viewport.height,ig.CONFIG.GAME_WIDTH_PCT=0,ig.CONFIG.GAME_HEIGHT_PCT=0,ig.CONFIG.GAME_WIDTH_VIEW=0,ig.CONFIG.GAME_HEIGHT_VIEW=0,ig.CONFIG.TOP_DOWN=!1,ig.CONFIG.FLIP_Y=!1,ig.CONFIG.SCALE=1,ig.CONFIG.SCALE_MIN=1,ig.CONFIG.SCALE_MAX=1/0,ig.CONFIG.RESIZE_DELAY=500,ig.CONFIG.GRAVITY=400,ig.CONFIG.AUTO_SORT_LAYERS=!1,ig.CONFIG.AUTO_SORT_OVERLAY_LAYER=!0,ig.CONFIG.AUTO_SORT_UI_LAYER=!0,ig.CONFIG.PRERENDER_MAPS=!0,ig.CONFIG.PRERENDER_BACKGROUND_LAYER=!0,ig.CONFIG.PRERENDER_FOREGROUND_LAYER=!0,ig.CONFIG.CLEAR_ON_LOAD_UI_LAYER=!1,ig.CONFIG.IGNORE_PAUSE_UI_LAYER=!0,ig.CONFIG.IGNORE_PAUSE_OVERLAY_LAYER=!1,ig.CONFIG.NO_UPDATE_BACKGROUND_LAYER=!0,ig.CONFIG.NO_UPDATE_FOREGROUND_LAYER=!0,ig.CONFIG.LOADER_MAX_WIDTH_PCT=.5,ig.CONFIG.LOADER_MAX_HEIGHT_PCT=.5,ig.CONFIG.LOADER_BG_COLOR="#111111",ig.CONFIG.LOADER_FADE_COLOR="#DDDDDD",ig.CONFIG.LOADER_BAR=!0,ig.CONFIG.LOADER_BAR_COLOR="#DDDDDD",ig.CONFIG.LOADER_BAR_WIDTH_PCT=.25,ig.CONFIG.LOADER_BAR_HEIGHT_PCT=.025,ig.CONFIG.LOADER_BAR_LINE_WIDTH=3,ig.CONFIG.LOADER_BAR_SPACE_PCT=.005,ig.CONFIG.LOADER_SPACE_PCT=.02,ig.CONFIG.LOADER_LOGO_SRC_MAIN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP8AAAAtCAYAAABh/r3uAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QUTEQcqYSZEBgAAAVtJREFUeNrt3MGNwjAQBVC8oqPctpxtYevYFiiHm2tiryARKdaMjcHv3UCBOA5f/oGIctqxbdvtBLy9Wmt59vyXqYE1CT8sqqj6sOYlgJUf1H5gqdqv6oOVHxB+QPgB4QeEHxB+QPgB4Qfmds56o+vfz9Pnv38v6YPe29eR/baO8377I8eyt31kzK1zEhln1lxlnZfZ5qd1nJHtsz6TVn5A+IFg7R9ZUSLvkzXOSBXsfSmUNc6suerx2pFzlVXRW7e38gPCD0xY+2cw8leGIxWutVr3GHPWOFc4p+/42bbyA8IPvLD2v6pGZlXuyH5HvnbkvmY4pyuL3BBl5QeEH+hU+3tXlKxvqnuPM1KnZ6u7kbmKHGOP+Wn9BaT12Ge7gcfKDwg/8Mj/9oOVHxB+QPgB4QeEHxB+QPgB4QcmV+4fuOEHPluttVj5Qe0Hlq/9LgHgs6u+lR8QfljVP9Eqv3CR+x/VAAAAAElFTkSuQmCC",
ig.CONFIG.LOADER_LOGO_SRC_ALT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QUGFCwN01BpQgAAACZpVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVAgb24gYSBNYWOV5F9bAAADT0lEQVR42u3du27UQBiG4VlkUSCuIRU9QhuKpMpFUFOkTcl1bElLTcFFUCUFsai4EwqEEFAkGwkL4zE+zeF5qxw2m43z/+98Y896dmGA/X7/KyBb2rbd/ev7jxyiulEACgA1szPm150JGMAQAAWAejOAMZ8BoACgACZwe9aG27PW0WQAVB0CuxY4vdk7wgyA6qaBTMAAyIRmjV/CCAyAmjJAX+d3YQIGQMkGiDUBIzAASjYAEzAAFMA4U7i6yAAoLQOMzQKyAQOgRAMwwbjjseTfywCV05TQKbIBAyDHDDA1C+SeDVLIQAxgCCgrRad8BvH6cBmuD5cKAGYBRc8Sjl1+/ubdH1/vfs4AqGMWkMq4nPos4Xicvr96G0II4fGHq8VfNwMwQHorglI3Qt8Yv9TxYQCUYYDSTFACDMAA+a0HKNUES2ULBkCaBkjVBDVlAwaoHAUwYKbS35+gAGSAdG4Vm0u3zZUNtkj9DIB0DVCrCWQAMAATMAA2oHEI5jdVnxFSSP0MgHwyQG5ZIMdswAAMkM+mUUuZ4OuPuz64+PRi1M99fPk5hBDC0+ZntiZgAAbIb9u4uU0wtUP7Xs+a6/sZAPUYYC4TzN2R759/CSGE8OzJt2yyAANUThZnAuc+g7ZUJ568Ptx9cD/m9xkrJRMwgAyQ/+bRY7PA0h2Y004pDFA5RRTA6c1+k65K8Z4/DIB8ZwFT0/7RAmtdPUzxnj8MgHwNkGpHpbiShwHgPEBq8/Ecd0VjAAbYzgBrja2xJvjf15PzfogMwADlZoDYDl16TSADgAFiOnKtq3TdtXpL4X0BSJ6q3hv4cK0gXPnPMwBWywBb7Y4VO69P7X0GDAAZYA5iz+hNXUfgDiFggC2Z65pCjfsGMIBZQHpnAvs6uuSVOQwABqh57x4GQD0GAANAAUABQAFAAUABQAFAAaCiAsj19iol3BaGAfBAMqeCh7qq79Lw0OPGPr77uOP3x/780OtI5ZI2A1ROs3XHdzuh23F9n8d24NDiktjOnPp8Y38fA6BsA5RGrKlkADDAkrOHoc6L7eDY5xvKJLGzFAZA3ecB5ppFgAGgAKAAEJcBul+wTLxs2rbdMQAUABQA/pYBZIKyx3wGgAKAAsA9vwE+PY+Xd5MPtQAAAABJRU5ErkJggg==",ig.CONFIG.CLEAR_COLOR="#000000",ig.CONFIG.STATIC="static",ig.CONFIG.MOVABLE="movable",ig.CONFIG.DYNAMIC="dynamic",ig.CONFIG.AUTO_SPAWN_PLAYER=!0,ig.CONFIG.Z_INDEX_BELOW_ALL=-1,ig.CONFIG.Z_INDEX_BELOW_PLAYER=0,ig.CONFIG.Z_INDEX_PLAYER=100,ig.CONFIG.Z_INDEX_ABOVE_PLAYER=200,ig.CONFIG.Z_INDEX_ABOVE_ALL=9999,ig.CONFIG.TRANSITION_LEVELS=!0,ig.CONFIG.TRANSITIONER_COLOR="#333333",ig.CONFIG.TRANSITIONER_R=51,ig.CONFIG.TRANSITIONER_G=51,ig.CONFIG.TRANSITIONER_B=51,ig.CONFIG.TRANSITIONER_LAYER="ui",ig.CONFIG.Z_INDEX_TRANSITIONER=ig.CONFIG.Z_INDEX_ABOVE_PLAYER,ig.CONFIG.DIMMED_PAUSE=!0,ig.CONFIG.DIMMER_COLOR="#333333",ig.CONFIG.DIMMER_R=51,ig.CONFIG.DIMMER_G=51,ig.CONFIG.DIMMER_B=51,ig.CONFIG.DIMMER_ALPHA=.75,ig.CONFIG.LAYERS_CUSTOM={},ig.CONFIG.LEVEL_MAX=4,ig.CONFIG.RANKS_MAP={NONE:0,EASY:Math.round(.25*ig.CONFIG.LEVEL_MAX),MEDIUM:Math.round(.5*ig.CONFIG.LEVEL_MAX),HARD:Math.round(.75*ig.CONFIG.LEVEL_MAX),IMPOSSIBLE:ig.CONFIG.LEVEL_MAX},ig.CONFIG.PRECISION_ZERO=.01,ig.CONFIG.PRECISION_ZERO_TWEEN=.1,ig.CONFIG.PRECISION_PCT_ONE_SIDED=.01,ig.CONFIG.FONT={},ig.CONFIG.FONT.MAIN_NAME="font_04b03_white_8.png",ig.CONFIG.FONT.ALT_NAME="",ig.CONFIG.FONT.CHAT_NAME="",ig.CONFIG.FONT.SCALE=1,ig.CONFIG.FONT.SCALE_OF_SYSTEM_SCALE=1,ig.CONFIG.FONT.SCALE_MIN=1,ig.CONFIG.FONT.SCALE_MAX=1/0,ig.CONFIG.FONT.IGNORE_SYSTEM_SCALE=!1,ig.CONFIG.UI={},ig.CONFIG.UI.POS_AS_PCT=!0,ig.CONFIG.UI.SCALE=1,ig.CONFIG.UI.SCALE_OF_SYSTEM_SCALE=1,ig.CONFIG.UI.SCALE_MIN=1,ig.CONFIG.UI.SCALE_MAX=1/0,ig.CONFIG.UI.IGNORE_SYSTEM_SCALE=!1,ig.CONFIG.UI.MARGIN_AS_PCT_SMALLEST=!0,ig.CONFIG.UI.MARGIN_SCALELESS=!0,ig.CONFIG.UI.CAN_FLIP_X=!0,ig.CONFIG.UI.CAN_FLIP_Y=!1,ig.CONFIG.GESTURE={RELEASE_DELAY:.3,DIRECTION_SWITCH_PCT:.03,HOLD_DELAY:.15,HOLD_DELAY_BLOCK_TAP:.3,HOLD_DELAY_ACTIVATE:.5,HOLD_ACTIVATE_DISTANCE_PCT:.01,SWIPE_DISTANCE_PCT:.05,SWIPE_DURATION_TRY:.3,SWIPE_DURATION_RESET:.1,TAP_MULTI_DISTANCE_PCT:.05,TARGET_UP:!1,TARGET_DOWN:!1,TARGET_DOWN_START:!0,TARGET_TAP:!0,TARGET_SEARCH_RADIUS:10},ig.CONFIG.CAMERA={AUTO_FOLLOW_PLAYER:!0,SNAP_FIRST_FOLLOW:!0,CENTER_FIRST_FOLLOW:!0,KEEP_CENTERED:!0,KEEP_INSIDE_LEVEL:!1,LERP:1,BOUNDS_TRAP_AS_PCT:!1,BOUNDS_TRAP_MINX:0,BOUNDS_TRAP_MINY:0,BOUNDS_TRAP_MAXX:0,BOUNDS_TRAP_MAXY:0,BOUNDS_TRAP_PCT_MINX:0,BOUNDS_TRAP_PCT_MINY:0,BOUNDS_TRAP_PCT_MAXX:0,BOUNDS_TRAP_PCT_MAXY:0,TRANSITION_DURATION:1,TRANSITION_DURATION_MIN:.2,TRANSITION_DURATION_MAX:2,TRANSITION_DISTANCE:100},ig.CONFIG.ENTITY={},ig.CONFIG.ENTITY.SIZE_X=16,ig.CONFIG.ENTITY.SIZE_Y=16,ig.CONFIG.ENTITY.SIZE_OFFSET_X=0,ig.CONFIG.ENTITY.SIZE_OFFSET_Y=0,ig.CONFIG.ENTITY.SCALE=1,ig.CONFIG.ENTITY.SCALE_OF_SYSTEM_SCALE=1,ig.CONFIG.ENTITY.SCALE_MIN=1,ig.CONFIG.ENTITY.SCALE_MAX=1/0,ig.CONFIG.ENTITY.IGNORE_SYSTEM_SCALE=!1,ig.CONFIG.ENTITY.CAN_FLIP_X=!0,ig.CONFIG.ENTITY.CAN_FLIP_Y=!1,ig.CONFIG.ENTITY.FRICTION_X=0,ig.CONFIG.ENTITY.FRICTION_Y=0,ig.CONFIG.ENTITY.MAX_VEL_X=100,ig.CONFIG.ENTITY.MAX_VEL_Y=100,ig.CONFIG.ENTITY.BOUNCINESS=0,ig.CONFIG.ENTITY.MIN_BOUNCE_VEL=40,ig.CONFIG.ENTITY.NEEDS_BOUNDS=!1,ig.CONFIG.ENTITY.NEEDS_VERTICES=!1,ig.CONFIG.ENTITY.HEALTH=1,ig.CONFIG.ENTITY.SLOPE_STICKING=!1,ig.CONFIG.ENTITY.SLOPE_SPEED_MOD=.75,ig.CONFIG.ENTITY.SLOPE_STANDING_MIN=-136,ig.CONFIG.ENTITY.SLOPE_STANDING_MAX=-44,ig.CONFIG.ENTITY.OPAQUE=!1,ig.CONFIG.ENTITY.OPAQUE_OFFSET={left:0,right:0,top:0,bottom:0},ig.CONFIG.ENTITY.OPAQUE_OFFSET_RIGHT=0,ig.CONFIG.ENTITY.OPAQUE_OFFSET_TOP=0,ig.CONFIG.ENTITY.OPAQUE_OFFSET_BOTTOM=0,ig.CONFIG.ENTITY.OPAQUE_FROM_VERTICES=!1,ig.CONFIG.ENTITY.DIFFUSE=.8,ig.CONFIG.LIGHT={},ig.CONFIG.LIGHT.PIXEL_PERFECT=!1,ig.CONFIG.LIGHT.GRADIENT=!0,ig.CONFIG.LIGHT.CASTS_SHADOWS=!1,ig.CONFIG.LIGHT.CASTS_SHADOWS_MOVABLE=!1,ig.CONFIG.LIGHT.R=1,ig.CONFIG.LIGHT.G=1,ig.CONFIG.LIGHT.B=1,ig.CONFIG.LIGHT.ALPHA=.25,ig.CONFIG.LIGHT.DIFFUSE=.8,ig.CONFIG.LIGHT.SAMPLES=1,ig.CONFIG.CHARACTER={},ig.CONFIG.CHARACTER.ANIM_AUTOMATIC=!0,ig.CONFIG.CHARACTER.SIZE_X=32,ig.CONFIG.CHARACTER.SIZE_Y=32,ig.CONFIG.CHARACTER.SIZE_OFFSET_X=0,ig.CONFIG.CHARACTER.SIZE_OFFSET_Y=0,ig.CONFIG.CHARACTER.MAX_VEL_UNGROUNDED_X=100,ig.CONFIG.CHARACTER.MAX_VEL_UNGROUNDED_Y=200,ig.CONFIG.CHARACTER.MAX_VEL_GROUNDED_X=100,ig.CONFIG.CHARACTER.MAX_VEL_GROUNDED_Y=100,ig.CONFIG.CHARACTER.MAX_VEL_CLIMBING_X=75,ig.CONFIG.CHARACTER.MAX_VEL_CLIMBING_Y=75,ig.CONFIG.CHARACTER.FRICTION_UNGROUNDED_X=0,ig.CONFIG.CHARACTER.FRICTION_UNGROUNDED_Y=0,ig.CONFIG.CHARACTER.FRICTION_GROUNDED_X=1600,ig.CONFIG.CHARACTER.FRICTION_GROUNDED_Y=1600,ig.CONFIG.CHARACTER.SPEED_X=750,ig.CONFIG.CHARACTER.SPEED_Y=750,ig.CONFIG.CHARACTER.CAN_JUMP=!0,ig.CONFIG.CHARACTER.JUMP_STEPS=4,ig.CONFIG.CHARACTER.JUMP_FORCE=10,ig.CONFIG.CHARACTER.JUMP_CONTROL=.75,ig.CONFIG.CHARACTER.SLOPE_STICKING=!0,ig.CONFIG.CHARACTER.UNGROUNDED_FOR_THRESHOLD=.1,ig.CONFIG.CHARACTER.UNGROUNDED_FOR_AND_FALLING_THRESHOLD=.25,ig.CONFIG.CHARACTER.CAN_CLIMB=!0,ig.CONFIG.CHARACTER.CLIMBING_CONTROL=1,ig.CONFIG.CHARACTER.CAN_PATHFIND=!0,ig.CONFIG.CHARACTER.PATHFINDING_DELAY=1,ig.CONFIG.CHARACTER.PATHFINDING_UPDATE_DELAY=.2,ig.CONFIG.CHARACTER.PATHFINDING_SIMPLE_DELAY=.075,ig.CONFIG.CHARACTER.STUCK_DELAY=.1,ig.CONFIG.CHARACTER.HEALTH=1,ig.CONFIG.CHARACTER.ENERGY=1,ig.CONFIG.CHARACTER.REGEN_RATE_HEALTH=0,ig.CONFIG.CHARACTER.REGEN_RATE_ENERGY=0,ig.CONFIG.CHARACTER.EXPLODING_DAMAGE=!0,ig.CONFIG.CHARACTER.EXPLODING_DAMAGE_PARTICLE_COUNT=3,ig.CONFIG.CHARACTER.EXPLODING_DEATH=!0,ig.CONFIG.CHARACTER.EXPLODING_DEATH_PARTICLE_COUNT=10,ig.CONFIG.PLAYER_MANAGER={},ig.CONFIG.PLAYER_MANAGER.AUTO_MANAGE_PLAYER=!0,ig.CONFIG.PLAYER_MANAGER.HOLD_TO_MOVE=!0,ig.CONFIG.PLAYER_MANAGER.SWIPE_TO_JUMP=!0,ig.CONFIG.CREATURE={},ig.CONFIG.CREATURE.REACTION_DISTANCE=100,ig.CONFIG.CREATURE.REACTION_DELAY=.2,ig.CONFIG.CREATURE.PREDATOR_FROM_DAMAGE=!1,ig.CONFIG.CREATURE.CAN_LEARN_PREDATORS=!1,ig.CONFIG.CREATURE.NEEDS_LINE_OF_SIGHT_PREY=!0,ig.CONFIG.CREATURE.DETECT_HIDDEN_PREY=!1,ig.CONFIG.CREATURE.MOVE_TO_PREY_SETTINGS={avoidEntities:!0,searchDistance:ig.CONFIG.CREATURE.REACTION_DISTANCE},ig.CONFIG.CREATURE.NEEDS_LINE_OF_SIGHT_PREDATOR=!0,ig.CONFIG.CREATURE.DETECT_HIDDEN_PREDATOR=!1,ig.CONFIG.CREATURE.MOVE_TO_PREDATOR_SETTINGS={avoidEntities:!0,searchDistance:ig.CONFIG.CREATURE.REACTION_DISTANCE},ig.CONFIG.CREATURE.CAN_FLEE=!0,ig.CONFIG.CREATURE.FLEE_HEALTH_PCT=.15,ig.CONFIG.CREATURE.CAN_BREAK_TETHER=!1,ig.CONFIG.CREATURE.TETHER_TO_SPAWNER=!1;ig.CONFIG.CREATURE.TETHER_DISTANCE=100,ig.CONFIG.CREATURE.MOVE_TO_TETHER_SETTINGS={avoidEntities:!0},ig.CONFIG.CREATURE.CAN_WANDER_X=!0,ig.CONFIG.CREATURE.CAN_WANDER_Y=!1,ig.CONFIG.CREATURE.WANDER_SWITCH_CHANCE=0,ig.CONFIG.CREATURE.WANDER_SWITCH_CHANCE_STOPPED=0,ig.CONFIG.CREATURE.MOVE_TO_WANDER_SETTINGS={simple:!0,avoidUngrounded:!0,avoidSlopes:!0},ig.CONFIG.PARTICLE={},ig.CONFIG.PARTICLE.ANIM_AUTOMATIC=!0,ig.CONFIG.COLLISION={},ig.CONFIG.COLLISION.ALLOW_FIXED=!1,ig.CONFIG.COLLISION.TILE_SOLID=1,ig.CONFIG.COLLISION.TILE_ONE_WAY_UP=12,ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN=23,ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT=34,ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT=45,ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP=46,ig.CONFIG.COLLISION.TILE_CLIMBABLE=47,ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP=48,ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS=49,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY={},ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_UP]=!0,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN]=!0,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT]=!0,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT]=!0,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE={},ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY={},ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS={},ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE={0:!0,50:!0,51:!0},ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_UP]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT={0:!0,50:!0,51:!0},ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0,ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0,ig.CONFIG.COLLISION.TILES_HASH_SLOPED={2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,13:!0,14:!0,15:!0,16:!0,17:!0,18:!0,19:!0,20:!0,21:!0,22:!0,24:!0,25:!0,26:!0,27:!0,28:!0,29:!0,30:!0,31:!0,32:!0,33:!0,35:!0,36:!0,37:!0,38:!0,39:!0,40:!0,41:!0,42:!0,43:!0,44:!0,52:!0,53:!0,54:!0,55:!0},ig.CONFIG.PATHFINDING={},ig.CONFIG.PATHFINDING.BUILD_WITH_LEVEL=!0,ig.CONFIG.PATHFINDING.WEIGHTED=!0,ig.CONFIG.PATHFINDING.ALLOW_DIAGONAL=!0,ig.CONFIG.PATHFINDING.DIAGONAL_REQUIRES_BOTH_DIRECT=!0,ig.CONFIG.PATHFINDING.AVOID_ENTITIES=!0,ig.CONFIG.PATHFINDING.WEIGHT=10,ig.CONFIG.PATHFINDING.WEIGHT_AWAY_FROM=2,ig.CONFIG.PATHFINDING.AWAY_FROM_DISTANCE=100,ig.CONFIG.PATHFINDING.AWAY_FROM_MIN_DISTANCE_PCT=.4,ig.CONFIG.PATHFINDING.AWAY_FROM_MAX_NODES=40,ig.CONFIG.PATHFINDING.STRICT_SLOPE_CHECK=!1,ig.CONFIG.PATHFINDING.TILE_DEF={0:{weightPct:1},1:{weightPct:0,walkable:!0},2:{weightPct:.25,walkable:!0},3:{weightPct:.75,walkable:!0},4:{walkable:!1}},ig.CONFIG.OVERLAY={},ig.CONFIG.OVERLAY.R=0,ig.CONFIG.OVERLAY.G=0,ig.CONFIG.OVERLAY.B=0,ig.CONFIG.OVERLAY.ALPHA=.8,ig.CONFIG.OVERLAY.PIXEL_PERFECT=!1,ig.CONFIG.TEXT_BUBBLE={},ig.CONFIG.TEXT_BUBBLE.SIZE_X=120,ig.CONFIG.TEXT_BUBBLE.SIZE_Y=70,ig.CONFIG.TEXT_BUBBLE.SIZE_AS_PCT=!0,ig.CONFIG.TEXT_BUBBLE.SIZE_PCT_X=.5,ig.CONFIG.TEXT_BUBBLE.SIZE_PCT_Y=.5,ig.CONFIG.TEXT_BUBBLE.CORNER_RADIUS=5,ig.CONFIG.TEXT_BUBBLE.CORNER_RADIUS_AS_PCT=!1,ig.CONFIG.TEXT_BUBBLE.PIXEL_PERFECT=!1,ig.CONFIG.TEXT_BUBBLE.R=.9,ig.CONFIG.TEXT_BUBBLE.G=.9,ig.CONFIG.TEXT_BUBBLE.B=.9,ig.CONFIG.TEXT_BUBBLE.ALPHA=1,ig.CONFIG.TEXT_BUBBLE.TRIANGLE_LENGTH=10,ig.CONFIG.TEXT_BUBBLE.TRIANGLE_WIDTH=12,ig.CONFIG.TEXT_BUBBLE.PADDING_X=6,ig.CONFIG.TEXT_BUBBLE.PADDING_Y=6,ig.CONFIG.TEXT_BUBBLE.SHRINK_TO_TEXT=!0,ig.merge(ig.CONFIG,ig.CONFIG_USER),ig.CONFIG.ENTITY.CAN_FLIP_Y=ig.CONFIG.ENTITY.CAN_FLIP_Y||ig.CONFIG.FLIP_Y,ig.CONFIG.FONT.MAIN_PATH=ig.CONFIG.FONT.MAIN_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.MAIN_NAME:"",ig.CONFIG.FONT.ALT_PATH=ig.CONFIG.FONT.ALT_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.ALT_NAME:"",ig.CONFIG.FONT.CHAT_PATH=ig.CONFIG.FONT.CHAT_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.CHAT_NAME:"",ig.CONFIG.RANKS=function(){var e=[];for(var i in ig.CONFIG.RANKS_MAP)e.push({name:i,level:ig.CONFIG.RANKS_MAP[i]});return e.sort(function(e,i){return e.level-i.level}),e}(),ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X=ig.CONFIG.ENTITY.SIZE_X-2*ig.CONFIG.ENTITY.SIZE_OFFSET_X,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y=ig.CONFIG.ENTITY.SIZE_Y-2*ig.CONFIG.ENTITY.SIZE_OFFSET_Y,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_MIN=Math.min(ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y),ig.CONFIG.ENTITY.SIZE_EFFECTIVE_MAX=Math.max(ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y),ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X=ig.CONFIG.CHARACTER.SIZE_X-2*ig.CONFIG.CHARACTER.SIZE_OFFSET_X,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y=ig.CONFIG.CHARACTER.SIZE_Y-2*ig.CONFIG.CHARACTER.SIZE_OFFSET_Y,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_MIN=Math.min(ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y),ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_MAX=Math.max(ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y)}),ig.baked=!0,ig.module("plusplus.helpers.utilsmath").defines(function(){"use strict";ig.utilsmath={},ig.utilsmath.GOLDEN_ANGLE=Math.PI*(3-Math.sqrt(5)),ig.utilsmath.TWOPI=2*Math.PI,ig.utilsmath.HALFPI=.5*Math.PI,ig.utilsmath.clamp=function(e,i,t){return Math.min(Math.max(e,i),t)},ig.utilsmath.map=function(e,i,t,s,n){return s+(e-i)/(t-i)*(n-s)},ig.utilsmath.degreesToRadians=function(e){return e/180*Math.PI},ig.utilsmath.radiansToDegrees=function(e){return 180*e/Math.PI},ig.utilsmath.almostEqual=function(e,i,t){if(e===i)return!0;var s=i-e;return s>0?s<t:s>-t},ig.utilsmath.oppositeSidesOfZero=function(e,i){return e<0&&i>0||e>0&&i<0},ig.utilsmath.direction=function(e){return 0===e?0:e<0?-1:1},ig.utilsmath.directionChange=function(e,i){return 0===e&&0!==i||0!==e&&0===i||ig.utilsmath.oppositeSidesOfZero(e,i)}}),ig.baked=!0,ig.module("plusplus.core.loader").requires("impact.loader","plusplus.core.config","plusplus.helpers.utilsmath").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utilsmath;ig.LoaderExtended=ig.Loader.extend({_endTime:0,init:function(i,t){this.logoMain=ig.$new("img"),this.logoMain.src=e.LOADER_LOGO_SRC_MAIN,this.logoAlt=ig.$new("img"),this.logoAlt.src=e.LOADER_LOGO_SRC_ALT,this.parent(i,t),i.prototype.resize.call(this)},end:function(){this.parent(),this._endTime=Date.now(),ig.system.setDelegate(this)},run:function(){var t=Date.now()-this._endTime,s=1;if(t<e.DURATION_FADE)this.draw(),s=i.map(t,0,e.DURATION_FADE,0,1);else{if(!(t<2*e.DURATION_FADE))return void ig.system.setDelegate(ig.game);ig.game.run(),s=i.map(t,e.DURATION_FADE,2*e.DURATION_FADE,1,0)}var n=ig.system.context;n.globalAlpha=s,n.fillStyle=e.LOADER_FADE_COLOR,n.fillRect(0,0,ig.system.realWidth,ig.system.realHeight),n.globalAlpha=1},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var i,t,s,n=ig.system.context,a=ig.system.realWidth,o=ig.system.realHeight,r=Math.min(a,o)*e.LOADER_SPACE_PCT;e.LOADER_BAR?(i=a*e.LOADER_BAR_WIDTH_PCT,t=o*e.LOADER_BAR_HEIGHT_PCT,s=Math.min(a,o)*e.LOADER_BAR_SPACE_PCT):i=t=s=0;var h=this.logoMain.width,l=this.logoMain.height,g=this.logoAlt.width,c=this.logoAlt.height,u=Math.max(i,h,g),d=l+r+t+r+c,m=u/a,p=d/o,f=1,y=1;m>e.LOADER_MAX_WIDTH_PCT&&(f=1-(m-e.LOADER_MAX_WIDTH_PCT)),p>e.LOADER_MAX_HEIGHT_PCT&&(y=1-(p-e.LOADER_MAX_HEIGHT_PCT));var E=Math.min(1,f,y),v=(a-u*E)/2,T=(o-d*E)/2;n.fillStyle=e.LOADER_BG_COLOR,n.clearRect(0,0,a,o),n.save(),n.translate(v,T),n.scale(E,E),n.drawImage(this.logoMain,.5*(u-h),0),e.LOADER_BAR&&(n.lineWidth=e.LOADER_BAR_LINE_WIDTH,n.strokeStyle=e.LOADER_BAR_COLOR,n.strokeRect(.5*(u-i),l+r,i,t),n.fillStyle=e.LOADER_BAR_COLOR,n.fillRect(.5*(u-i)+s,l+r+s,Math.max(0,i*this._drawStatus-2*s),t-2*s)),n.drawImage(this.logoAlt,.5*(u-g),d-c),n.restore()}})}),ig.baked=!0,ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){"use strict";ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(e,i,t){this.width=i,this.height=t,this.image=new ig.Image(e)}}),ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(e,i,t,s){this.sheet=e,this.pivot={x:e.width/2,y:e.height/2},this.timer=new ig.Timer,this.frameTime=i,this.sequence=t,this.stop=!!s,this.tile=this.sequence[0]},rewind:function(){return this.timer.set(),this.loopCount=0,this.frame=0,this.tile=this.sequence[0],this},gotoFrame:function(e){this.timer.set(this.frameTime*-e-1e-4),this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var e=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(e/this.sequence.length),this.stop&&this.loopCount>0?this.frame=this.sequence.length-1:this.frame=e%this.sequence.length,this.tile=this.sequence[this.frame]},draw:function(e,i){var t=Math.max(this.sheet.width,this.sheet.height);e>ig.system.width||i>ig.system.height||e+t<0||i+t<0||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(e,i,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(e+this.pivot.x),ig.system.getDrawPos(i+this.pivot.y)),ig.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})}),ig.baked=!0,ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:44..toRad(),max:136..toRad()},init:function(e,i,t){this.id=++ig.Entity._lastId,this.pos.x=this.last.x=e,this.pos.y=this.last.y=i,ig.merge(this,t)},reset:function(e,i,t){var s=this.constructor.prototype;this.pos.x=e,this.pos.y=i,this.last.x=e,this.last.y=i,this.vel.x=s.vel.x,this.vel.y=s.vel.y,this.accel.x=s.accel.x,this.accel.y=s.accel.y,this.health=s.health,this._killed=s._killed,this.standing=s.standing,this.type=s.type,this.checkAgainst=s.checkAgainst,this.collides=s.collides,ig.merge(this,t)},addAnim:function(e,i,t,s){if(!this.animSheet)throw"No animSheet to add the animation "+e+" to.";var n=new ig.Animation(this.animSheet,i,t,s);return this.anims[e]=n,this.currentAnim||(this.currentAnim=n),n},update:function(){this.last.x=this.pos.x,this.last.y=this.pos.y,this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor,this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x),this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var e=this.vel.x*ig.system.tick,i=this.vel.y*ig.system.tick,t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,e,i,this.size.x,this.size.y);this.handleMovementTrace(t),this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(e,i,t,s){if(i)return(e+i*ig.system.tick).limit(-s,s);if(t){var n=t*ig.system.tick;return e-n>0?e-n:e+n<0?e+n:0}return e.limit(-s,s)},handleMovementTrace:function(e){if(this.standing=!1,e.collision.y&&(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(this.vel.y>0&&(this.standing=!0),this.vel.y=0)),e.collision.x&&(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*=-this.bounciness:this.vel.x=0),e.collision.slope){var i=e.collision.slope;if(this.bounciness>0){var t=this.vel.x*i.nx+this.vel.y*i.ny;this.vel.x=(this.vel.x-i.nx*t*2)*this.bounciness,this.vel.y=(this.vel.y-i.ny*t*2)*this.bounciness}else{var s=i.x*i.x+i.y*i.y,n=(this.vel.x*i.x+this.vel.y*i.y)/s;this.vel.x=i.x*n,this.vel.y=i.y*n;var a=Math.atan2(i.x,i.y);a>this.slopeStanding.min&&a<this.slopeStanding.max&&(this.standing=!0)}}this.pos=e.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(e,i){this.health-=e,this.health<=0&&this.kill()},touches:function(e){return!(this.pos.x>=e.pos.x+e.size.x||this.pos.x+this.size.x<=e.pos.x||this.pos.y>=e.pos.y+e.size.y||this.pos.y+this.size.y<=e.pos.y)},distanceTo:function(e){var i=this.pos.x+this.size.x/2-(e.pos.x+e.size.x/2),t=this.pos.y+this.size.y/2-(e.pos.y+e.size.y/2);return Math.sqrt(i*i+t*t)},angleTo:function(e){return Math.atan2(e.pos.y+e.size.y/2-(this.pos.y+this.size.y/2),e.pos.x+e.size.x/2-(this.pos.x+this.size.x/2))},check:function(e){},collideWith:function(e,i){},ready:function(){},erase:function(){}}),ig.Entity._lastId=0,ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8},ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3},ig.Entity.checkPair=function(e,i){e.checkAgainst&i.type&&e.check(i),i.checkAgainst&e.type&&i.check(e),e.collides&&i.collides&&e.collides+i.collides>ig.Entity.COLLIDES.ACTIVE&&ig.Entity.solveCollision(e,i)},ig.Entity.solveCollision=function(e,i){var t=null;e.collides==ig.Entity.COLLIDES.LITE||i.collides==ig.Entity.COLLIDES.FIXED?t=e:i.collides!=ig.Entity.COLLIDES.LITE&&e.collides!=ig.Entity.COLLIDES.FIXED||(t=i),e.last.x+e.size.x>i.last.x&&e.last.x<i.last.x+i.size.x?(e.last.y<i.last.y?ig.Entity.seperateOnYAxis(e,i,t):ig.Entity.seperateOnYAxis(i,e,t),e.collideWith(i,"y"),i.collideWith(e,"y")):e.last.y+e.size.y>i.last.y&&e.last.y<i.last.y+i.size.y&&(e.last.x<i.last.x?ig.Entity.seperateOnXAxis(e,i,t):ig.Entity.seperateOnXAxis(i,e,t),e.collideWith(i,"x"),i.collideWith(e,"x"))},ig.Entity.seperateOnXAxis=function(e,i,t){var s=e.pos.x+e.size.x-i.pos.x;if(t){var n=e===t?i:e;t.vel.x=-t.vel.x*t.bounciness+n.vel.x;var a=ig.game.collisionMap.trace(t.pos.x,t.pos.y,t==e?-s:s,0,t.size.x,t.size.y);t.pos.x=a.pos.x}else{var o=(e.vel.x-i.vel.x)/2;e.vel.x=-o,i.vel.x=o;var r=ig.game.collisionMap.trace(e.pos.x,e.pos.y,-s/2,0,e.size.x,e.size.y);e.pos.x=Math.floor(r.pos.x);var h=ig.game.collisionMap.trace(i.pos.x,i.pos.y,s/2,0,i.size.x,i.size.y);i.pos.x=Math.ceil(h.pos.x)}},ig.Entity.seperateOnYAxis=function(e,i,t){var s=e.pos.y+e.size.y-i.pos.y;if(t){var n=e===t?i:e;t.vel.y=-t.vel.y*t.bounciness+n.vel.y;var a=0;t==e&&Math.abs(t.vel.y-n.vel.y)<t.minBounceVelocity&&(t.standing=!0,a=n.vel.x*ig.system.tick);var o=ig.game.collisionMap.trace(t.pos.x,t.pos.y,a,t==e?-s:s,t.size.x,t.size.y);t.pos.y=o.pos.y,t.pos.x=o.pos.x}else if(ig.game.gravity&&(i.standing||e.vel.y>0)){var r=ig.game.collisionMap.trace(e.pos.x,e.pos.y,0,-(e.pos.y+e.size.y-i.pos.y),e.size.x,e.size.y);e.pos.y=r.pos.y,e.bounciness>0&&e.vel.y>e.minBounceVelocity?e.vel.y*=-e.bounciness:(e.standing=!0,e.vel.y=0)}else{var h=(e.vel.y-i.vel.y)/2;e.vel.y=-h,i.vel.y=h;var a=i.vel.x*ig.system.tick,r=ig.game.collisionMap.trace(e.pos.x,e.pos.y,a,-s/2,e.size.x,e.size.y);e.pos.y=r.pos.y;var l=ig.game.collisionMap.trace(i.pos.x,i.pos.y,0,s/2,i.size.x,i.size.y);i.pos.y=l.pos.y}}}),ig.baked=!0,ig.module("impact.map").defines(function(){"use strict";ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(e,i){this.tilesize=e,this.data=i,this.height=i.length,this.width=i[0].length,this.pxWidth=this.width*this.tilesize,this.pxHeight=this.height*this.tilesize},getTile:function(e,i){var t=Math.floor(e/this.tilesize),s=Math.floor(i/this.tilesize);return t>=0&&t<this.width&&s>=0&&s<this.height?this.data[s][t]:0},setTile:function(e,i,t){var s=Math.floor(e/this.tilesize),n=Math.floor(i/this.tilesize);s>=0&&s<this.width&&n>=0&&n<this.height&&(this.data[n][s]=t)}})}),ig.baked=!0,ig.module("impact.collision-map").requires("impact.map").defines(function(){"use strict";ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(e,i,t){this.parent(e,i),this.tiledef=t||ig.CollisionMap.defaultTileDef;for(var s in this.tiledef)s|0>this.lastSlope&&(this.lastSlope=0|s)},trace:function(e,i,t,s,n,a){var o={collision:{x:!1,y:!1,slope:!1},pos:{x:e,y:i},tile:{x:0,y:0}},r=Math.ceil(Math.max(Math.abs(t),Math.abs(s))/this.tilesize);if(r>1)for(var h=t/r,l=s/r,g=0;g<r&&(h||l)&&(this._traceStep(o,e,i,h,l,n,a,t,s,g),e=o.pos.x,i=o.pos.y,o.collision.x&&(h=0,t=0),o.collision.y&&(l=0,s=0),!o.collision.slope);g++);else this._traceStep(o,e,i,t,s,n,a,t,s,0);return o},_traceStep:function(e,i,t,s,n,a,o,r,h,l){e.pos.x+=s,e.pos.y+=n;var g=0;if(s){var c=s>0?a:0,u=s<0?this.tilesize:0,d=Math.max(Math.floor(t/this.tilesize),0),m=Math.min(Math.ceil((t+o)/this.tilesize),this.height),p=Math.floor((e.pos.x+c)/this.tilesize),f=Math.floor((i+c)/this.tilesize);if((l>0||p==f||f<0||f>=this.width)&&(f=-1),p>=0&&p<this.width)for(var y=d;y<m&&!(-1!=f&&(g=this.data[y][f])>1&&g<=this.lastSlope&&this._checkTileDef(e,g,i,t,r,h,a,o,f,y));y++)if(1==(g=this.data[y][p])||g>this.lastSlope||g>1&&this._checkTileDef(e,g,i,t,r,h,a,o,p,y)){if(g>1&&g<=this.lastSlope&&e.collision.slope)break;e.collision.x=!0,e.tile.x=g,i=e.pos.x=p*this.tilesize-c+u,r=0;break}}if(n){var E=n>0?o:0,v=n<0?this.tilesize:0,T=Math.max(Math.floor(e.pos.x/this.tilesize),0),I=Math.min(Math.ceil((e.pos.x+a)/this.tilesize),this.width),y=Math.floor((e.pos.y+E)/this.tilesize),A=Math.floor((t+E)/this.tilesize);if((l>0||y==A||A<0||A>=this.height)&&(A=-1),y>=0&&y<this.height)for(var p=T;p<I&&!(-1!=A&&(g=this.data[A][p])>1&&g<=this.lastSlope&&this._checkTileDef(e,g,i,t,r,h,a,o,p,A));p++)if(1==(g=this.data[y][p])||g>this.lastSlope||g>1&&this._checkTileDef(e,g,i,t,r,h,a,o,p,y)){if(g>1&&g<=this.lastSlope&&e.collision.slope)break;e.collision.y=!0,e.tile.y=g,e.pos.y=y*this.tilesize-E+v;break}}},_checkTileDef:function(e,i,t,s,n,a,o,r,h,l){var g=this.tiledef[i];if(!g)return!1;var c=(h+g[0])*this.tilesize,u=(l+g[1])*this.tilesize,d=(g[2]-g[0])*this.tilesize,m=(g[3]-g[1])*this.tilesize,p=g[4],f=t+n+(m<0?o:0)-c,y=s+a+(d>0?r:0)-u;if(d*y-m*f>0){if(n*-m+a*d<0)return p;var E=Math.sqrt(d*d+m*m),v=m/E,T=-d/E,I=f*v+y*T,A=v*I,x=T*I;return A*A+x*x>=n*n+a*a?p||d*(y-a)-m*(f-n)<.5:(e.pos.x=t+n-A,e.pos.y=s+a-x,e.collision.slope={x:d,y:m,nx:v,ny:T},!0)}return!1}});var e=.5,i=1/3,t=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,t,!0],6:[0,t,1,i,!0],7:[0,i,1,0,!0],3:[0,1,1,e,!0],4:[0,e,1,0,!0],2:[0,1,1,0,!0],10:[e,1,1,0,!0],21:[0,1,e,0,!0],32:[t,1,1,0,!0],43:[i,1,t,0,!0],54:[0,1,i,0,!0],27:[0,0,1,i,!0],28:[0,i,1,t,!0],29:[0,t,1,1,!0],25:[0,0,1,e,!0],26:[0,e,1,1,!0],24:[0,0,1,1,!0],11:[0,0,e,1,!0],22:[e,0,1,1,!0],33:[0,0,i,1,!0],44:[i,0,t,1,!0],55:[t,0,1,1,!0],16:[1,i,0,0,!0],17:[1,t,0,i,!0],18:[1,1,0,t,!0],14:[1,e,0,0,!0],15:[1,1,0,e,!0],13:[1,1,0,0,!0],8:[e,1,0,0,!0],19:[1,1,e,0,!0],30:[i,1,0,0,!0],41:[t,1,i,0,!0],52:[1,1,t,0,!0],38:[1,t,0,1,!0],39:[1,i,0,t,!0],40:[1,0,0,i,!0],36:[1,e,0,1,!0],37:[1,0,0,e,!0],35:[1,0,0,1,!0],9:[1,0,e,1,!0],20:[e,0,0,1,!0],31:[1,0,t,1,!0],42:[t,0,i,1,!0],53:[i,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]},ig.CollisionMap.staticNoCollision={trace:function(e,i,t,s){return{collision:{x:!1,y:!1,slope:!1},pos:{x:e+t,y:i+s},tile:{x:0,y:0}}}}}),ig.baked=!0,ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){"use strict";ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(e,i,t){this.parent(e,i),this.setTileset(t)},setTileset:function(e){this.tilesetName=e instanceof ig.Image?e.path:e,this.tiles=new ig.Image(this.tilesetName),this.preRenderedChunks=null},setScreenPos:function(e,i){this.scroll.x=e/this.distance,this.scroll.y=i/this.distance},preRenderMapToChunks:function(){var e=this.width*this.tilesize*ig.system.scale,i=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(e,i),this.chunkSize);var t=Math.ceil(e/this.chunkSize),s=Math.ceil(i/this.chunkSize);this.preRenderedChunks=[];for(var n=0;n<s;n++){this.preRenderedChunks[n]=[];for(var a=0;a<t;a++){var o=a==t-1?e-a*this.chunkSize:this.chunkSize,r=n==s-1?i-n*this.chunkSize:this.chunkSize;this.preRenderedChunks[n][a]=this.preRenderChunk(a,n,o,r)}}},preRenderChunk:function(e,i,t,s){var n=t/this.tilesize/ig.system.scale+1,a=s/this.tilesize/ig.system.scale+1,o=e*this.chunkSize/ig.system.scale%this.tilesize,r=i*this.chunkSize/ig.system.scale%this.tilesize,h=Math.floor(e*this.chunkSize/this.tilesize/ig.system.scale),l=Math.floor(i*this.chunkSize/this.tilesize/ig.system.scale),g=ig.$new("canvas");g.width=t,g.height=s,g.retinaResolutionEnabled=!1;var c=g.getContext("2d");ig.System.scaleMode(g,c);var u=ig.system.context;ig.system.context=c;for(var d=0;d<n;d++)for(var m=0;m<a;m++)if(d+h<this.width&&m+l<this.height){var p=this.data[m+l][d+h];p&&this.tiles.drawTile(d*this.tilesize-o,m*this.tilesize-r,p-1,this.tilesize)}return ig.system.context=u,g},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var e=ig.system.getDrawPos(this.scroll.x),i=ig.system.getDrawPos(this.scroll.y);if(this.repeat){var t=this.width*this.tilesize*ig.system.scale;e=(e%t+t)%t;var s=this.height*this.tilesize*ig.system.scale;i=(i%s+s)%s}var n=Math.max(Math.floor(e/this.chunkSize),0),a=Math.max(Math.floor(i/this.chunkSize),0),o=Math.ceil((e+ig.system.realWidth)/this.chunkSize),r=Math.ceil((i+ig.system.realHeight)/this.chunkSize),h=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(o=Math.min(o,h),r=Math.min(r,l));for(var g=0,c=a;c<r;c++){for(var u=0,d=n;d<o;d++){var m=this.preRenderedChunks[c%l][d%h],p=-e+d*this.chunkSize-u,f=-i+c*this.chunkSize-g;ig.system.context.drawImage(m,p,f),ig.Image.drawCount++,this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(p,f,this.chunkSize,this.chunkSize)),this.repeat&&m.width<this.chunkSize&&p+m.width<ig.system.realWidth&&(u+=this.chunkSize-m.width,o++)}this.repeat&&m.height<this.chunkSize&&f+m.height<ig.system.realHeight&&(g+=this.chunkSize-m.height,r++)}},drawTiled:function(){for(var e=0,i=null,t=(this.scroll.x/this.tilesize).toInt(),s=(this.scroll.y/this.tilesize).toInt(),n=this.scroll.x%this.tilesize,a=this.scroll.y%this.tilesize,o=-n-this.tilesize,r=-a-this.tilesize,h=ig.system.width+this.tilesize-n,l=ig.system.height+this.tilesize-a,g=-1,c=r;c<l;g++,c+=this.tilesize){var u=g+s;if(u>=this.height||u<0){if(!this.repeat)continue;u=(u%this.height+this.height)%this.height}for(var d=-1,m=o;m<h;d++,m+=this.tilesize){var p=d+t;if(p>=this.width||p<0){if(!this.repeat)continue;p=(p%this.width+this.width)%this.width}(e=this.data[u][p])&&((i=this.anims[e-1])?i.draw(m,c):this.tiles.drawTile(m,c,e-1,this.tilesize))}}}})}),ig.baked=!0,
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){"use strict";ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){return this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX,ig.game=this,null},loadLevel:function(e){this.screen={x:0,y:0},this.entities=[],this.namedEntities={};for(var i=0;i<e.entities.length;i++){var t=e.entities[i];this.spawnEntity(t.type,t.x,t.y,t.settings)}this.sortEntities(),this.collisionMap=ig.CollisionMap.staticNoCollision,this.backgroundMaps=[];for(var i=0;i<e.layer.length;i++){var s=e.layer[i];if("collision"==s.name)this.collisionMap=new ig.CollisionMap(s.tilesize,s.data);else{var n=new ig.BackgroundMap(s.tilesize,s.data,s.tilesetName);n.anims=this.backgroundAnims[s.tilesetName]||{},n.repeat=s.repeat,n.distance=s.distance,n.foreground=!!s.foreground,n.preRender=!!s.preRender,n.name=s.name,this.backgroundMaps.push(n)}}for(var i=0;i<this.entities.length;i++)this.entities[i].ready()},loadLevelDeferred:function(e){this._levelToLoad=e},getMapByName:function(e){if("collision"==e)return this.collisionMap;for(var i=0;i<this.backgroundMaps.length;i++)if(this.backgroundMaps[i].name==e)return this.backgroundMaps[i];return null},getEntityByName:function(e){return this.namedEntities[e]},getEntitiesByType:function(e){for(var i="string"==typeof e?ig.global[e]:e,t=[],s=0;s<this.entities.length;s++){var n=this.entities[s];n instanceof i&&!n._killed&&t.push(n)}return t},spawnEntity:function(e,i,t,s){var n="string"==typeof e?ig.global[e]:e;if(!n)throw"Can't spawn entity of type "+e;var a=new n(i,t,s||{});return this.entities.push(a),a.name&&(this.namedEntities[a.name]=a),a},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(e){e.name&&delete this.namedEntities[e.name],e._killed=!0,e.type=ig.Entity.TYPE.NONE,e.checkAgainst=ig.Entity.TYPE.NONE,e.collides=ig.Entity.COLLIDES.NEVER,this._deferredKill.push(e)},run:function(){this.update(),this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null),this.updateEntities(),this.checkEntities();for(var e=0;e<this._deferredKill.length;e++)this._deferredKill[e].erase(),this.entities.erase(this._deferredKill[e]);this._deferredKill=[],(this._doSortEntities||this.autoSort)&&(this.sortEntities(),this._doSortEntities=!1);for(var i in this.backgroundAnims){var t=this.backgroundAnims[i];for(var s in t)t[s].update()}},updateEntities:function(){for(var e=0;e<this.entities.length;e++){var i=this.entities[e];i._killed||i.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor),this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale,this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var e;for(e=0;e<this.backgroundMaps.length;e++){var i=this.backgroundMaps[e];if(i.foreground)break;i.setScreenPos(this.screen.x,this.screen.y),i.draw()}for(this.drawEntities(),e;e<this.backgroundMaps.length;e++){var i=this.backgroundMaps[e];i.setScreenPos(this.screen.x,this.screen.y),i.draw()}},drawEntities:function(){for(var e=0;e<this.entities.length;e++)this.entities[e].draw()},checkEntities:function(){for(var e={},i=0;i<this.entities.length;i++){var t=this.entities[i];if(t.type!=ig.Entity.TYPE.NONE||t.checkAgainst!=ig.Entity.TYPE.NONE||t.collides!=ig.Entity.COLLIDES.NEVER)for(var s={},n=Math.floor(t.pos.x/this.cellSize),a=Math.floor(t.pos.y/this.cellSize),o=Math.floor((t.pos.x+t.size.x)/this.cellSize)+1,r=Math.floor((t.pos.y+t.size.y)/this.cellSize)+1,h=n;h<o;h++)for(var l=a;l<r;l++)if(e[h])if(e[h][l]){for(var g=e[h][l],c=0;c<g.length;c++)t.touches(g[c])&&!s[g[c].id]&&(s[g[c].id]=!0,ig.Entity.checkPair(t,g[c]));g.push(t)}else e[h][l]=[t];else e[h]={},e[h][l]=[t]}}}),ig.Game.SORT={Z_INDEX:function(e,i){return e.zIndex-i.zIndex},POS_X:function(e,i){return e.pos.x+e.size.x-(i.pos.x+i.size.x)},POS_Y:function(e,i){return e.pos.y+e.size.y-(i.pos.y+i.size.y)}}}),ig.baked=!0,ig.module("plusplus.core.timer").requires("impact.timer","plusplus.core.config").defines(function(){"use strict";var e=ig.CONFIG;ig.Timer.minStep=e.MIN_TIME_STEP,ig.Timer.overflow=0,ig.Timer.stepped=!1,ig.Timer.step=function(){var e=Date.now();ig.Timer.overflow+=Math.min((e-ig.Timer._last)/1e3,ig.Timer.maxStep),ig.Timer.overflow>=ig.Timer.minStep?(ig.Timer.overflow-=ig.Timer.minStep,ig.Timer.time+=ig.Timer.minStep*ig.Timer.timeScale,ig.Timer.stepped=!0):ig.Timer.stepped=!1,ig.Timer._last=e}}),ig.baked=!0,ig.module("plusplus.helpers.signals").defines(function(){"use strict";function e(e,i,t,s,n){this._listener=i,this._isOnce=t,this.context=s,this._signal=e,this._priority=n||0}function i(e,i){if("function"!=typeof e)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",i))}e.prototype={active:!0,params:null,execute:function(e){var i,t;return this.active&&this._listener&&(t=this.params?this.params.concat(e):e,i=this._listener.apply(this.context,t),this._isOnce&&this.detach()),i},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},ig.Signal=function(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){ig.Signal.prototype.dispatch.apply(e,arguments)}},ig.Signal.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,t,s,n){var a,o=this._indexOfListener(i,s);if(-1!==o){if(a=this._bindings[o],a.isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else a=new e(this,i,t,s,n),this._addBinding(a);return this.memorize&&this._prevParams&&a.execute(this._prevParams),a},_addBinding:function(e){var i=this._bindings.length;do{--i}while(this._bindings[i]&&e._priority<=this._bindings[i]._priority);this._bindings.splice(i+1,0,e)},_indexOfListener:function(e,i){for(var t,s=this._bindings.length;s--;)if(t=this._bindings[s],t._listener===e&&t.context===i)return s;return-1},has:function(e,i){return-1!==this._indexOfListener(e,i)},add:function(e,t,s){return i(e,"add"),this._registerListener(e,!1,t,s)},addOnce:function(e,t,s){return i(e,"addOnce"),this._registerListener(e,!0,t,s)},remove:function(e,t){i(e,"remove");var s=this._indexOfListener(e,t);return-1!==s&&(this._bindings[s]._destroy(),this._bindings.splice(s,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var i,t=Array.prototype.slice.call(arguments),s=this._bindings.length;if(this.memorize&&(this._prevParams=t),s){i=this._bindings.slice(),this._shouldPropagate=!0;do{s--}while(i[s]&&this._shouldPropagate&&!1!==i[s].execute(t))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}}}),ig.baked=!0,ig.module("plusplus.core.image").requires("impact.image","plusplus.helpers.signals").defines(function(){"use strict";ig.Image.inject({width:1,height:1,data:null,dataContext:null,dataWidth:1,dataHeight:1,scale:1,scaleOfSystemScale:1,scaleMin:1,scaleMax:1/0,ignoreSystemScale:!1,retainScaledData:!0,scaleCache:null,onLoaded:null,_scale:0,init:function(e,i){ig.merge(this,i),this.onLoaded=new ig.Signal,this.scaleCache={},this.parent(e)},onload:function(e){this.width=this.data.width,this.height=this.data.height,this.loaded=!0;var i=ig.$new("canvas");i.width=this.width,i.height=this.height,i.style.width=this.width+"px",i.style.height=this.height+"px",i.retinaResolutionEnabled=!1;var t=i.getContext("2d");ig.System.scaleMode(i,t),t.drawImage(this.data,0,0),this.data=i,this.dataContext=this.data.getContext("2d"),this.dataWidth=this.data.width,this.dataHeight=this.data.height,this.scaleCache||(this.scaleCache={}),this.scaleCache.x1=this.data,this.loadCallback&&this.loadCallback(this.path,!0),this.onLoaded&&(this.onLoaded.dispatch(this),this.onLoaded.removeAll(),this.onLoaded.forget()),ig.global.wm||!ig.game||ig.game._gameNeedsSetup||ig.game.resizeDeferred(!0)},resize:function(e){var i=this.scaleCache.x1;if(i&&e&&(e=Math.min(Math.max(Math.round(e*this.scaleOfSystemScale),this.scaleMin),this.scaleMax),this._scale!==e))if(this.scale=this._scale=e,this.scaleCache||(this.scaleCache={}),this.data=this.scaleCache["x"+e],this.data)this.dataContext=this.data.getContext("2d"),this.dataWidth=this.data.width,this.dataHeight=this.data.height;else{var t=ig.getImagePixels(i,0,0,this.width,this.height),s=this.width*e|0,n=this.height*e|0,a=this.data=ig.$new("canvas");a.width=s,a.height=n,a.style.width=s+"px",a.style.height=n+"px",a.retinaResolutionEnabled=!1,this.dataWidth=s,this.dataHeight=n;var o=this.dataContext=this.data.getContext("2d");ig.System.scaleMode(a,o);for(var r=o.getImageData(0,0,s,n),h=0;h<n;h++)for(var l=0;l<s;l++){var g=4*(Math.floor(h/e)*this.width+Math.floor(l/e)),c=4*(h*s+l);r.data[c]=t.data[g],r.data[c+1]=t.data[g+1],r.data[c+2]=t.data[g+2],r.data[c+3]=t.data[g+3]}o.putImageData(r,0,0),this.retainScaledData&&(this.scaleCache["x"+e]=this.data)}},draw:function(e,i,t,s,n,a,o){this.loaded&&(o?this.resize(o):(this.ignoreSystemScale||this._scale===ig.system.scale?this._scale!==this.scale&&this.resize(this.scale):this.resize(ig.system.scale),o=this._scale),n=(void 0!==n?n:this.width)*o|0,a=(void 0!==a?a:this.height)*o|0,0!==n&&0!==a&&(t=t?t*o|0:0,s=s?s*o|0:0,ig.system.context.drawImage(this.data,t,s,n,a,ig.system.getDrawPos(e),ig.system.getDrawPos(i),n,a),ig.Image.drawCount++))},drawTile:function(e,i,t,s,n,a,o,r){if(n=n||s,!(!this.loaded||s>this.width||n>this.height)){r?this.resize(r):(this.ignoreSystemScale||this._scale===ig.system.scale?this._scale!==this.scale&&this.resize(this.scale):this.resize(ig.system.scale),r=this._scale);var h,l,g,c,u=Math.floor(s*r),d=Math.floor(n*r);a?(h=-1,g=u):(h=1,g=0),o?(l=-1,c=d):(l=1,c=0),a||o?(ig.system.context.save(),ig.system.context.scale(h,l),ig.system.context.drawImage(this.data,Math.floor(t*s)%this.width*r,Math.floor(t*s/this.width)*n*r,u,d,ig.system.getDrawPos(e)*h-g,ig.system.getDrawPos(i)*l-c,u,d),ig.system.context.restore()):ig.system.context.drawImage(this.data,Math.floor(t*s)%this.width*r,Math.floor(t*s/this.width)*n*r,u,d,ig.system.getDrawPos(e)*h-g,ig.system.getDrawPos(i)*l-c,u,d),ig.Image.drawCount++}}}),ig.global.wm&&ig.Image.inject({resize:function(e){e&&this._scale!==e&&(this.scaleCache.x1||(this.scaleCache.x1=this.data),this.parent(e))},draw:function(e,i,t,s,n,a,o){o||(o=ig.system.scale),this.parent(e,i,t,s,n,a,o)},drawTile:function(e,i,t,s,n,a,o,r){r||(r=ig.system.scale),this.parent(e,i,t,s,n,a,o,r)}})}),ig.baked=!0,ig.module("plusplus.core.font").requires("impact.font","plusplus.core.config","plusplus.core.image").defines(function(){"use strict";var e=ig.CONFIG;ig.Font.inject({scale:e.FONT.SCALE,scaleOfSystemScale:e.FONT.SCALE_OF_SYSTEM_SCALE,scaleMin:e.FONT.SCALE_MIN,scaleMax:e.FONT.SCALE_MAX,ignoreSystemScale:e.FONT.IGNORE_SYSTEM_SCALE,multilineForWidth:function(e,i){e=""+e;var t="",s=0,n=e.split(" ");e.replace("\n","");for(var a=0,o=n.length;a<o;a++){var r=n[a]+(a!==o-1?" ":""),h=this._widthForLine(r);0!==s&&s+h>i&&(t+="\n",s=0),t+=r,s+=h}return t},overflowForHeight:function(e,i){e=""+e;var t=e,s="",n=e.split("\n"),a=n.length*(this.height+this.lineSpacing);if(a>i){var o=Math.floor(n.length*i/a);t="";for(var r=0,h=n.length;r<h;r++){var l=n[r];r<o?(t+=l,r<o-1&&(t+="\n")):(s+=l,r<h-1&&(s+="\n"))}}return{display:t,overflow:s}},draw:function(e,i,t,s,n,a,o,r){if(this.loaded){if(e=""+e,!r){if(n=n||ig.system.context,a){var h=this.scale;this.resize(a),this.scale=h}else this.ignoreSystemScale||this._scale===ig.system.scale?this._scale!==this.scale&&this.resize(this.scale):this.resize(ig.system.scale),a=this._scale;if(o=n===ig.system.context?a/ig.system.scale:1,-1!==e.indexOf("\n")){for(var l=e.split("\n"),g=(this.height+this.lineSpacing)*o,c=0,u=l.length;c<u;c++)this.draw(l[c],i,t+c*g,s,n,a,o,!0);return}}s===ig.Font.ALIGN.CENTER?i-=.5*this._widthForLine(e):s===ig.Font.ALIGN.RIGHT&&(i-=this._widthForLine(e)),1!==this.alpha&&(n.globalAlpha=this.alpha);for(var c=0;c<e.length;c++){var d=e.charCodeAt(c)-this.firstChar;i+=this._drawChar(d,i,t,n,a)*o}1!==this.alpha&&(n.globalAlpha=1),ig.Image.drawCount+=e.length}},_drawChar:function(e,i,t,s,n){var a=this.widthMap[e],o=this.height-2;return s===ig.system.context?s.drawImage(this.data,this.indices[e]*n,0,a*n,o*n,ig.system.getDrawPos(i),ig.system.getDrawPos(t),a*n,o*n):s.drawImage(this.data,this.indices[e]*n,0,a*n,o*n,i*n,t*n,a*n,o*n),a+this.letterSpacing}}),ig.Font.FONTS={},ig.Font.FONTS.MAIN=e.FONT.MAIN_PATH?new ig.Font(e.FONT.MAIN_PATH):null,ig.Font.FONTS.ALT=e.FONT.ALT_PATH?new ig.Font(e.FONT.ALT_PATH):ig.Font.FONTS.MAIN,ig.Font.FONTS.CHAT=e.FONT.CHAT_PATH?new ig.Font(e.FONT.CHAT_PATH):ig.Font.FONTS.MAIN}),ig.baked=!0,ig.module("plusplus.core.image-drawing").requires("plusplus.core.image").defines(function(){"use strict";ig.ImageDrawing=ig.Image.extend({loaded:!0,init:function(e){ig.merge(this,e),this.data=ig.$new("canvas"),this.dataContext=this.data.getContext("2d"),this.dataWidth=this.width*this.scale|0,this.dataHeight=this.height*this.scale|0,this.data.width=this.dataWidth,this.data.height=this.dataHeight,this.data.style.width=this.dataWidth+"px",this.data.style.height=this.dataHeight+"px",this.data.retinaResolutionEnabled=!1,ig.System.scaleMode(this.data,this.dataContext),this.scaleCache={},this.scaleCache.x1=this.data},load:function(){},reload:function(){},onload:function(){},setWidth:function(e){this.setDimensions(e,this.height)},setHeight:function(e){this.setDimensions(this.width,e)},setDimensions:function(e,i){this.width=0|e,this.height=0|i,this.data&&(this.dataWidth=this.data.width=this.width,this.dataHeight=this.data.height=this.height,ig.System.scaleMode(this.data,this.dataContext))},finalize:function(e){e?this.scale=this._scale=Math.min(Math.max(Math.round(e*this.scaleOfSystemScale),this.scaleMin),this.scaleMax):this._scale=e=1,this.scaleCache={},this.scaleCache["x"+e]=this.data,this.dataContext=this.data.getContext("2d"),this.dataWidth=this.data.width,this.dataHeight=this.data.height,this.width=this.dataWidth/e,this.height=this.dataHeight/e}})}),ig.baked=!0,ig.module("plusplus.helpers.shims").defines(function(){"use strict";"function"!=typeof Date.now&&(Date.now=function(){return+new Date})}),ig.baked=!0,ig.module("plusplus.helpers.utils").requires("plusplus.helpers.shims","plusplus.core.config").defines(function(){"use strict";var e=ig.global,i=ig.CONFIG;ig.utils={},ig.utils.type=function(e){return null==e?e+"":Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},ig.utils.isNumber=function(e){return!isNaN(e)&&isFinite(e)&&"boolean"!=typeof e},ig.utils.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},ig.utils.toArray=function(e){return e?!0!==ig.utils.isArray(e)?[e]:e:[]},ig.utils.toNotArray=function(e,i){return!0===ig.utils.isArray(e)?e[i||0]:e},ig.utils.arrayCautiousAdd=function(e,i){return-1===ig.utils.indexOfValue(e,i)&&e.push(i),e},ig.utils.arrayCautiousAddMulti=function(e,i){var t;i=ig.utils.toArray(i);for(var s=0,n=i.length;s<n;s++)(t=i[s])!==e&&-1===ig.utils.indexOfValue(e,t)&&e.push(t);return e},ig.utils.arrayCautiousRemove=function(e,i){var t=ig.utils.indexOfValue(e,i);return-1!==t&&e.splice(t,1),e},ig.utils.arrayCautiousRemoveMulti=function(e,i){var t,s;i=ig.utils.toArray(i);for(var n=0,a=i.length;n<a;n++)(t=i[n])!==e&&-1!==(s=ig.utils.indexOfValue(e,t))&&e.splice(s,1);return e},ig.utils.forEach=function(e,i,t){for(var s=0,n=e.length;s<n;s++)i.apply(e[s],t)},ig.utils.indexOfValue=function(e,i){for(var t=0,s=e.length;t<s;t++)if(i===e[t])return t;return-1},ig.utils.indexOfProperty=function(e,i,t){for(var s=0,n=e.length;s<n;s++)if(t===e[s][i])return s;return-1},ig.utils.indexOfProperties=function(e,i,t){for(var s=0,n=e.length;s<n;s++){for(var a=e[s],o=!1,r=0,h=i.length;r<h;r++)if(t[r]!==a[i[r]]){o=!0;break}if(!0!==o)return s}return-1},ig.utils.throttle=function(t,s,n){function a(){function i(){r=Date.now(),t.apply(a,l)}var a=this,h=Date.now()-r,l=arguments;h>s?(o&&e.clearTimeout(o),i()):!1!==n&&(o&&e.clearTimeout(o),o=e.setTimeout(i,s-h))}var o,r=0;return!0!==ig.utils.isNumber(s)&&(s=i.DURATION_THROTTLE),a},ig.utils.debounce=function(t,s){function n(){var i=this,n=arguments;a&&e.clearTimeout(a),a=e.setTimeout(function(){t.apply(i,n)},s)}var a;return!0!==ig.utils.isNumber(s)&&(s=i.DURATION_THROTTLE),n};var t=Math.pow(2,32);ig.utils.getType=function(e,i,s){s=s||"TYPE";var n,a=e[s],o=s+"_LAST";if(e[o]&&a||(e[o]=1,a=e[s]={}),i=i.toUpperCase(),!(n=a[i])){n=0;for(var r=e[o],h=i.split(" "),l=0,g=h.length;l<g;l++){var c=h[l],u=a[c];if(!u){if(r>=t)throw new TypeError("Bitwise flag out of range / above 32 bits!");u=a[c]=r,e[o]=2*r}n|=u}a[i]=n}return n},ig.utils.addType=function(e,i,t,s,n){i[t]|=ig.utils.getType(e,s,n)}}),ig.baked=!0,ig.module("plusplus.core.background-map").requires("impact.background-map","plusplus.core.image-drawing","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.utils;ig.BackgroundMapExtended=ig.BackgroundMap.extend({preRenderedScale:0,mergedMaps:[],setTileset:function(e){e instanceof ig.ImageDrawing?this.tiles=e:(this.tilesetName=e instanceof ig.Image?e.path:e,this.tiles=new ig.Image(this.tilesetName)),this.preRenderedChunks=null},merge:function(i){this.preRender&&!this.repeat&&i instanceof ig.BackgroundMap&&i.preRender&&!i.repeat&&(e.arrayCautiousAdd(this.mergedMaps,i),this.preRenderedChunks=null)},preRenderMapToChunks:function(){if(this.preRenderedScale=ig.system.scale,this.mergedMaps.length>0){this.preRenderedChunks=[];for(var e=[this].concat(this.mergedMaps),i=0,t=0,s=0,n=0,a=0,o=e.length;a<o;a++){var r=e[a];i=Math.max(i,r.width*r.tilesize*ig.system.scale),t=Math.max(t,r.height*r.tilesize*ig.system.scale),s=Math.max(i,t),n=Math.max(n,Math.min(s,r.chunkSize))}for(var h=Math.ceil(i/n),l=Math.ceil(t/n),g=0;g<l;g++)for(var c=this.preRenderedChunks[g]=this.preRenderedChunks[g]||[],u=0;u<h;u++){var d=u===h-1?i-u*n:n,m=g===l-1?t-g*n:n;c[u]=this.preRenderMergedChunk(e,n,u,g,d,m)}}else this.parent()},preRenderMergedChunk:function(e,i,t,s,n,a){var o=ig.$new("canvas");o.width=n,o.height=a,o.style.width=n+"px",o.style.height=a+"px",o.retinaResolutionEnabled=!1;var r=ig.system.context,h=o.getContext("2d");ig.System.scaleMode(o,h),ig.system.context=h;for(var l=0,g=e.length;l<g;l++)this.preRenderChunk(t,s,n,a,e[l],i,o);return ig.system.context=r,o},preRenderChunk:function(e,i,t,s,n,a,o){n=n||this,a=a||this.chunkSize;var r;if(!o){o=ig.$new("canvas"),o.width=t,o.height=s,o.style.width=t+"px",o.style.height=s+"px",o.retinaResolutionEnabled=!1;var h=o.getContext("2d");ig.System.scaleMode(o,h),r=ig.system.context,ig.system.context=h}for(var l=t/n.tilesize/ig.system.scale+1,g=s/n.tilesize/ig.system.scale+1,c=e*a/ig.system.scale%n.tilesize,u=i*a/ig.system.scale%n.tilesize,d=Math.floor(e*a/n.tilesize/ig.system.scale),m=Math.floor(i*a/n.tilesize/ig.system.scale),p=0;p<l;p++)for(var f=0;f<g;f++)if(p+d<n.width&&f+m<n.height){var y=n.data[f+m][p+d];y&&n.tiles.drawTile(p*n.tilesize-c,f*n.tilesize-u,y-1,n.tilesize)}return r&&(ig.system.context=r),o},draw:function(){this.setScreenPos(ig.game.screen.x,ig.game.screen.y),this.tiles.loaded&&this.enabled&&(this.preRender?(this.preRenderedScale!==ig.system.scale&&(this.preRenderedChunks=null),this.drawPreRendered()):this.drawTiled())}})}),ig.baked=!0,ig.module("plusplus.core.collision-map").requires("impact.collision-map","plusplus.core.config").defines(function(){"use strict";var e=ig.CONFIG;ig.CollisionMap.inject({trace:function(e,i,t,s,n,a,o){o.collision.x=o.collision.y=o.collision.slope=!1,o.pos.x=e,o.pos.y=i,o.tile.x=o.tile.y=0;var r=Math.ceil(Math.max(Math.abs(t),Math.abs(s))/this.tilesize);if(r>1)for(var h=t/r,l=s/r,g=0;g<r&&(h||l)&&(this._traceStep(o,e,i,h,l,n,a,t,s,g),e=o.pos.x,i=o.pos.y,o.collision.x&&(h=0,t=0),o.collision.y&&(l=0,s=0),!o.collision.slope);g++);else this._traceStep(o,e,i,t,s,n,a,t,s,0);return o},_traceStep:function(e,i,t,s,n,a,o,r,h,l){e.pos.x+=s,e.pos.y+=n;var g,c,u,d,m,p=0;if(s){var f=s>0?a:0,y=s<0?this.tilesize:0,E=Math.max(Math.floor(t/this.tilesize),0),v=Math.min(Math.ceil((t+o)/this.tilesize),this.height),T=Math.floor((e.pos.x+f)/this.tilesize),I=Math.floor((i+f)/this.tilesize);if((l>0||T==I||I<0||I>=this.width)&&(I=-1),T>=0&&T<this.width)for(var A=E;A<v&&!(-1!=I&&(p=this.data[A][I])>1&&p<=this.lastSlope&&this._checkTileDef(e,p,i,t,r,h,a,o,I,A)&&0!==e.slope.ny);A++)if(1==(p=this.data[A][T])||p>this.lastSlope||p>1&&this._checkTileDef(e,p,i,t,r,h,a,o,T,A)){if(e.tile.x=p,e.tile.xPos.x=T,e.tile.xPos.y=A,p>1&&p<=this.lastSlope&&e.collision.slope){g=!0,c=e.slope.x,u=e.slope.y,d=e.slope.nx,m=e.slope.ny;break}e.collision.x=!0,i=e.pos.x=T*this.tilesize-f+y,r=0;break}}if(n){var x=n>0?o:0,_=n<0?this.tilesize:0,C=Math.max(Math.floor(e.pos.x/this.tilesize),0),S=Math.min(Math.ceil((e.pos.x+a)/this.tilesize),this.width),A=Math.floor((e.pos.y+x)/this.tilesize),w=Math.floor((t+x)/this.tilesize);if((l>0||A==w||w<0||w>=this.height)&&(w=-1),A>=0&&A<this.height)for(var T=C;T<S&&!(-1!=w&&(p=this.data[w][T])>1&&p<=this.lastSlope&&this._checkTileDef(e,p,i,t,r,h,a,o,T,w)&&0!==e.slope.nx);T++)if(1==(p=this.data[A][T])||p>this.lastSlope||p>1&&this._checkTileDef(e,p,i,t,r,h,a,o,T,A)){if(e.tile.y=p,e.tile.yPos.x=T,e.tile.yPos.y=A,p>1&&p<=this.lastSlope&&e.collision.slope)break;e.collision.y=!0,e.pos.y=A*this.tilesize-x+_;break}}g&&(e.slope.x=c,e.slope.y=u,e.slope.nx=d,e.slope.ny=m)},_checkTileDef:function(e,i,t,s,n,a,o,r,h,l){var g=this.tiledef[i];if(!g)return!1;var c=(h+g[0])*this.tilesize,u=(l+g[1])*this.tilesize,d=(g[2]-g[0])*this.tilesize,m=(g[3]-g[1])*this.tilesize,p=g[4],f=t+n+(m<0?o:0)-c,y=s+a+(d>0?r:0)-u;if(d*y-m*f>0){if(n*-m+a*d<0)return p;var E=Math.sqrt(d*d+m*m),v=m/E,T=-d/E,I=f*v+y*T,A=v*I,x=T*I;return A*A+x*x>=n*n+a*a?p||d*(y-a)-m*(f-n)<.5:(e.pos.x=t+n-A,e.pos.y=s+a-x,e.collision.slope=!0,e.slope.x=d,e.slope.y=m,e.slope.nx=v,e.slope.ny=T,!0)}}});var i=ig.CollisionMap.defaultTileDef;for(var t in e.COLLISION.TILES_HASH_WALKABLE_STRICT)i[t]=null;i[e.COLLISION.TILE_SOLID]=[0,0,1,0,!0],i[e.COLLISION.TILE_CLIMBABLE_WITH_TOP]=[0,0,1,0,!1],i[e.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=[0,0,1,0,!1]}),ig.baked=!0,ig.module("plusplus.core.pathfinding-map").requires("impact.map","plusplus.core.config","plusplus.core.image").defines(function(){"use strict";var e=ig.CONFIG;ig.PathfindingMap=ig.Map.extend({tiledef:null,init:function(i,t,s){this.parent(i,t),this.tiledef=s||e.PATHFINDING.TILE_DEF}})}),ig.baked=!0,ig.module("plusplus.core.animation").requires("impact.animation","plusplus.core.config","plusplus.core.image","plusplus.core.image-drawing","plusplus.helpers.signals").defines(function(){"use strict";ig.CONFIG,ig.AnimationSheet.inject({init:function(e,i,t){(!i||i<0)&&(i=this.width),(!t||t<0)&&(t=this.height),this.parent(e,i,t)}}),ig.AnimationExtended=ig.Animation.extend({frameTime:1,sequence:[],pivot:null,stop:!1,changed:!1,once:!1,reverse:!1,texturing:null,textureWidth:0,textureHeight:0,opaqueOffset:null,onCompleted:null,_texturingDeferred:!1,init:function(e,i){this.sheet=e,this.pivot={x:.5*e.width,y:.5*e.height},ig.merge(this,i),this.tile=this.sequence[0],this.timer=new ig.Timer,this.onCompleted=new ig.Signal},getDuration:function(){return this.frameTime*this.sequence.length},texturize:function(e){if(this.sheet.image.loaded){var i=this.sheet.image.scaleCache&&this.sheet.image.scaleCache.x1||this.sheet.image.data,t=e.getSizeDrawX(),s=e.getSizeDrawY(),n=this.sheet.width,a=this.sheet.height,o=this.textureWidth!==t||this.textureHeight!==s;if(n<t||a<s){this.texturing=e,this.texturing.textures=this.texturing.textures||{},this.texturing.texturedAnimsCount=(this.texturing.texturedAnimsCount||0)+1;for(var r=0,h=this.sequence.length;r<h;r++){var l,g=this.sequence[r],c=this.texturing.textures[g];if(c?o&&(c.setDimensions(t,s),l=!0):(c=this.texturing.textures[g]=new ig.ImageDrawing({width:t,height:s}),l=!0),l){var u=ig.$new("canvas");u.width=n,u.height=a,u.style.width=n+"px",u.style.height=a+"px",u.retinaResolutionEnabled=!1;var d=u.getContext("2d");ig.System.scaleMode(u,d),d.drawImage(i,-Math.floor(g*n)%i.width,-Math.floor(g*a/i.width)*a),c.dataContext.fillStyle=c.dataContext.createPattern(u,"repeat"),c.dataContext.fillRect(0,0,t,s),c.finalize()}}this.textureWidth=t,this.textureHeight=s}}else this._texturingDeferred=e,this.sheet.image.onLoaded.remove(this._texturizeDeferred,this),this.sheet.image.onLoaded.addOnce(this._texturizeDeferred,this)},_texturizeDeferred:function(){this.texturize(this._texturingDeferred),this._texturingDeferred=void 0},detexturize:function(){this.texturing&&(this.texturing.texturedAnimsCount=Math.max(0,this.texturing.texturedAnimsCount-1),this.texturing.texturedAnimsCount||(this.texturing.textures=void 0),this.sheet.image.onLoaded.remove(this._texturizeDeferred,this),this.texturing=this.textureWidth=this.textureHeight=this._texturingDeferred=void 0)},playFromStart:function(e,i){this.stop=!1,this.rewind(e,i)},rewind:function(e,i){return this.once=void 0!==e?e:this.once,this.reverse=void 0!==i?i:this.reverse,this.parent()},gotoFrame:function(e){var i=this.stop;this.stop=!1,this.parent(e),this.stop=i},update:function(){if(!this.stop){var e=this.loopCount,i=this.sequence.length,t=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(t/i),this.reverse?this.frame=this.sequence.length-1-t%i:this.frame=t%i,this.loopCount>e&&(this.once&&(this.once=!1,this.stop=!0,this.frame=i-1),this.onCompleted.dispatch());var s=this.tile;this.tile=this.sequence[this.frame],i>1&&this.tile!==s?this.changed=!0:this.changed=!1}},draw:function(e,i,t,s){if(1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha),s=s||this.texturing){this.texturing===s&&this.textureWidth===this.texturing.sizeDraw.x&&this.textureHeight===this.texturing.sizeDraw.y||this.texturize(s);var n=this.texturing&&this.texturing.textures&&this.texturing.textures[this.tile];if(!n)return this.draw(e,i,t);n.draw(e,i,void 0,void 0,void 0,void 0,t)}else 0===this.angle?this.sheet.image.drawTile(e,i,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y,t):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(e+this.pivot.x),ig.system.getDrawPos(i+this.pivot.y)),ig.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y,t),ig.system.context.restore());1!==this.alpha&&(ig.system.context.globalAlpha=1)}}),ig.global.wm&&ig.AnimationExtended.inject({computeDrawCount:5,computeDrawCountMax:5,draw:function(e,i){this.texturing&&(this.computeDrawCount>=this.computeDrawCountMax?(this.computeDrawCount=0,this.texturing.recordChanges(!0),this.textureWidth*ig.system.scale==this.texturing.getSizeDrawX()*ig.system.scale&&this.textureHeight*ig.system.scale==this.texturing.getSizeDrawY()*ig.system.scale||this.texturize(this.texturing)):this.computeDrawCount++),this.parent(e,i)}})}),ig.baked=!0,ig.module("plusplus.helpers.tweens").requires("plusplus.core.config").defines(function(){"use strict";var e=ig.CONFIG,i=i||function(){var e=[],i=!1;return{REVISION:"9",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){i?t.pause():t.unpause(),e.push(t)},remove:function(i){var t=e.indexOf(i);-1!==t&&e.splice(t,1)},pause:function(){if(!i){i=!0;for(var t=0,s=e.length;t<s;t++)e[t].pause()}},unpause:function(){if(i){i=!1;for(var t=0,s=e.length;t<s;t++)e[t].unpause()}},update:function(t){if(0===e.length||i)return!1;var s=0,n=e.length;for(t=void 0!==t?t:void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now();s<n;)e[s].update(t)?s++:(e.splice(s,1),n--);return!0}}}();i.Tween=function(t){var s=t,n={},a={},o={},r=e.DURATION_TWEEN,h=0,l=0,g=null,c=!1,u=0,d=i.Easing.Linear.None,m=i.Interpolation.Linear,p=[],f=null,y=!1,E=null,v=null;this.to=function(e,i){return void 0!==i&&(r=i),a=e,this},this.start=function(e){i.add(this),y=!1,g=void 0!==e?e:void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now(),g+=l;for(var t in a)if(t in s!=0&&null!==s[t]){if(a[t]instanceof Array){if(0===a[t].length)continue;a[t]=[s[t]].concat(a[t])}n[t]=s[t],n[t]instanceof Array==0&&(n[t]*=1),o[t]=n[t]}return this},this.stop=function(){return i.remove(this),this},this.pause=function(){return c||(c=!0,u=void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now()),this},this.unpause=function(){return c&&(c=!1,g+=(void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now())-u,u=0),this},this.delay=function(e){return l=e,this},this.repeat=function(e){return h=e,this},this.easing=function(e){return"function"==typeof e&&(d=e),this},this.interpolation=function(e){return"function"==typeof easing&&(m=e),this},this.chain=function(){return p=arguments,this},this.onStart=function(e){return f=e,this},this.onUpdate=function(e){return E=e,this},this.onComplete=function(e){return v=e,this},this.update=function(e){if(c||e<g)return!0;!1===y&&(f&&f.call(s),y=!0);var i=(e-g)/r;i=i>1?1:i;var t=d(i);for(var u in n){var T=n[u],I=a[u];I instanceof Array?s[u]=m(I,t):s[u]=T+(I-T)*t}if(E&&E.call(s,t),1==i){if(h>0){isFinite(h)&&h--;for(var u in o)n[u]=o[u];return g=e+l,!0}v&&v.call(s);for(var A=0,x=p.length;A<x;A++)p[A].start(e);return!1}return!0}},i.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var i,t=.1;return 0===e?0:1===e?1:(!t||t<1?(t=1,i=.1):i=.4*Math.asin(1/t)/(2*Math.PI),-t*Math.pow(2,10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/.4))},Out:function(e){var i,t=.1;return 0===e?0:1===e?1:(!t||t<1?(t=1,i=.1):i=.4*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-i)*(2*Math.PI)/.4)+1)},InOut:function(e){var i,t=.1;return 0===e?0:1===e?1:(!t||t<1?(t=1,i=.1):i=.4*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?t*Math.pow(2,10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/.4)*-.5:t*Math.pow(2,-10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/.4)*.5+1)}},Back:{
In:function(e){var i=1.70158;return e*e*((i+1)*e-i)},Out:function(e){var i=1.70158;return--e*e*((i+1)*e+i)+1},InOut:function(e){var i=2.5949095;return(e*=2)<1?e*e*((i+1)*e-i)*.5:.5*((e-=2)*e*((i+1)*e+i)+2)}},Bounce:{In:function(e){return 1-i.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*i.Easing.Bounce.In(2*e):.5*i.Easing.Bounce.Out(2*e-1)+.5}}},i.Interpolation={Linear:function(e,t){var s=e.length-1,n=s*t,a=Math.floor(n),o=i.Interpolation.Utils.Linear;return t<0?o(e[0],e[1],n):t>1?o(e[s],e[s-1],s-n):o(e[a],e[a+1>s?s:a+1],n-a)},Bezier:function(e,t){var s,n=0,a=e.length-1,o=Math.pow,r=i.Interpolation.Utils.Bernstein;for(s=0;s<=a;s++)n+=o(1-t,a-s)*o(t,s)*e[s]*r(a,s);return n},CatmullRom:function(e,t){var s=e.length-1,n=s*t,a=Math.floor(n),o=i.Interpolation.Utils.CatmullRom;return e[0]===e[s]?(t<0&&(a=Math.floor(n=s*(1+t))),o(e[(a-1+s)%s],e[a],e[(a+1)%s],e[(a+2)%s],n-a)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[s]-(o(e[s],e[s],e[s-1],e[s-1],n-s)-e[s]):o(e[a?a-1:0],e[a],e[s<a+1?s:a+1],e[s<a+2?s:a+2],n-a)},Utils:{Linear:function(e,i,t){return(i-e)*t+e},Bernstein:function(e,t){var s=i.Interpolation.Utils.Factorial;return s(e)/s(t)/s(e-t)},Factorial:function(){var e=[1];return function(i){var t,s=1;if(e[i])return e[i];for(t=i;t>1;t--)s*=t;return e[i]=s}}(),CatmullRom:function(e,i,t,s,n){var a=.5*(t-e),o=.5*(s-i),r=n*n;return(2*i-2*t+a+o)*(n*r)+(-3*i+3*t-2*a-o)*r+a*n+i}}},ig.TWEEN=i,ig.TWEEN.Tween,ig.TWEEN.tween=function(e,i,t){t=t||{},t.tween&&t.tween.stop();var s=new ig.TWEEN.Tween(e).to(i,t.duration).easing(t.easing).onStart(t.onStart).onUpdate(t.onUpdate).onComplete(t.onComplete);return t.stopped||s.start(),s}}),ig.baked=!0,ig.module("plusplus.helpers.utilsvector2").requires("plusplus.core.config","plusplus.helpers.utilsmath").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utilsmath;ig.utilsvector2={},ig.utilsvector2.vector=function(e,i,t){return t=t||{},ig.utilsvector2.set(t,e||0,i||0),t},ig.utilsvector2.set=function(e,i,t){return e.x=i,e.y=t,e},ig.utilsvector2.setScalar=function(e,i){return e.x=i,e.y=i,e},ig.utilsvector2.clone=function(e){return ig.utilsvector2.vector(e.x,e.y)},ig.utilsvector2.copy=function(e,i){return e.x=i.x,e.y=i.y,e},ig.utilsvector2.zero=function(e){return e.x=0,e.y=0,e},ig.utilsvector2.isZero=function(e){return 0===e.x&&0===e.y},ig.utilsvector2.isAlmostZero=function(t){return i.almostEqual(t.x,0,e.PRECISION_ZERO)&&i.almostEqual(t.y,0,e.PRECISION_ZERO)},ig.utilsvector2.equal=function(e,i){return e.x===i.x&&e.y===i.y},ig.utilsvector2.inverse=function(e){return e.x=-e.x,e.y=-e.y,e},ig.utilsvector2.add=function(e,i){return e.x+=i.x,e.y+=i.y,e},ig.utilsvector2.addVectors=function(e,i){return{x:e.x+i.x,y:e.y+i.y}},ig.utilsvector2.addScalar=function(e,i){return e.x+=i,e.y+=i,e},ig.utilsvector2.subtract=function(e,i){return e.x-=i.x,e.y-=i.y,e},ig.utilsvector2.subtractVectors=function(e,i){return{x:e.x-i.x,y:e.y-i.y}},ig.utilsvector2.subtractScalar=function(e,i){return e.x-=i,e.y-=i,e},ig.utilsvector2.multiply=function(e,i){return e.x*=i.x,e.y*=i.y,e},ig.utilsvector2.multiplyVectors=function(e,i){return{x:e.x*i.x,y:e.y*i.y}},ig.utilsvector2.multiplyScalar=function(e,i){return e.x*=i,e.y*=i,e},ig.utilsvector2.divide=function(e,i){return e.x/=i.x,e.y/=i.y,e},ig.utilsvector2.divideVectors=function(e,i){return{x:e.x/i.x,y:e.y/i.y}},ig.utilsvector2.divideScalar=function(e,i){return e.x/=i,e.y/=i,e},ig.utilsvector2.min=function(e,i){return{x:e.x<i.x?e.x:i.x,y:e.y<i.y?e.y:i.y}},ig.utilsvector2.max=function(e,i){return{x:e.x>i.x?e.x:i.x,y:e.y>i.y?e.y:i.y}},ig.utilsvector2.abs=function(e){return e.x<0&&(e.x=-e.x),e.y<0&&(e.y=-e.y),e},ig.utilsvector2.length=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},ig.utilsvector2.lengthSquared=function(e){return e.x*e.x+e.y*e.y},ig.utilsvector2.normalize=function(e){var i=ig.utilsvector2.length(e);if(i>=Number.MIN_VALUE){var t=1/i;e.x*=t,e.y*=t}return e},ig.utilsvector2.dot=function(e,i){return e.x*i.x+e.y*i.y},ig.utilsvector2.cross=function(e,i){return e.x*i.y-e.y*i.x},ig.utilsvector2.crossVF=function(e,i){var t=e.x;return e.x=i*e.y,e.y=-i*t,e},ig.utilsvector2.crossFV=function(e,i){var t=e.x;return e.x=-i*e.y,e.y=i*t,e},ig.utilsvector2.rotate=function(e,i,t,s){var n=Math.sin(i),a=Math.cos(i),o=e.x-t,r=e.y-s;return e.x=t+o*a-r*n,e.y=s+o*n+r*a,e},ig.utilsvector2.projectPoints=function(e,i,t,s,n,a,o,r){i=i||0,t=t||0,s=s||1,n=n||1,a=a||0;var h,l,g,c,u=[];if(0!==a)for(o=o||0,r=r||0,h=0,l=e.length;h<l;h++)g=e[h],c=ig.utilsvector2.rotate(g,a,o,r),u[h]={x:c.x*s+i,y:c.y*n+t};else for(h=0,l=e.length;h<l;h++)g=e[h],u[h]={x:g.x*s+i,y:g.y*n+t};return u},ig.utilsvector2.centerOfPoints=function(e){for(var i,t=0,s=0,n=0,a=e.length;n<a;n++)i=e[n],t+=i.x,s+=i.y;return{x:t/a,y:s/a}},ig.utilsvector2.pointsCW=function(e,i,t){return(i.x-e.x)*(t.y-e.y)-(i.y-e.y)*(t.x-e.x)},ig.utilsvector2.radianBetweenPoints=function(e,i,t){var s=i.x-e.x,n=i.y-e.y,a=i.x-t.x,o=i.y-t.y,r=s*a+n*o,h=s*o-n*a;return Math.atan2(h,r)},ig.utilsvector2.pointsToConvexHull=function(e){if(e.length<3)return e;var i,t,s,n=0,a=e[n];for(i=1,t=e.length;i<t;i++)s=e[i],s.y===a.y?s.x<a.x&&(n=i,a=s):s.y<a.y&&(n=i,a=s);var o,r=[];for(i=0,t=e.length;i<t;i++)i!==n&&(s=e[i],o={x:s.x,y:s.y},o.angle=Math.atan((s.y-a.y)/(s.x-a.x)),o.angle<0&&(o.angle+=Math.PI),o.distance=(s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y),o.index=i,r.push(o));r.sort(function(e,i){return e.angle<i.angle?-1:e.angle>i.angle?1:e.distance<i.distance?-1:e.distance>i.distance?1:0}),r.unshift(r[r.length-1],{x:a.x,y:a.y,index:n});var h,l=2;for(i=3,t=e.length;i<=t;i++){for(;ig.utilsvector2.pointsCW(r[l-1],r[l],r[i])<=0;)l--;l++,h=r[i],r[i]=r[l],r[l]=h}var g=[];for(i=0;i<=l;i++)g[i]=e[r[i].index];return g},ig.utilsvector2.Q_1=1,ig.utilsvector2.Q_2=4,ig.utilsvector2.Q_3=8,ig.utilsvector2.Q_4=16,ig.utilsvector2.pointQuadrant=function(e,i,t,s){var n,a=t-e,o=s-i;return 0===a&&0===o?n=ig.utilsvector2.Q_1|ig.utilsvector2.Q_2|ig.utilsvector2.Q_3|ig.utilsvector2.Q_4:0===a?n=o<0?ig.utilsvector2.Q_3|ig.utilsvector2.Q_4:ig.utilsvector2.Q_1|ig.utilsvector2.Q_2:0===o?n=a<0?ig.utilsvector2.Q_2|ig.utilsvector2.Q_4:ig.utilsvector2.Q_1|ig.utilsvector2.Q_3:(n=1,a<0&&(n=2),o<0&&(n+=2),n=1<<n),n},ig.utilsvector2.directionThreshold=function(e,t,s){return t=t||0,s=s||0,s<t?(0!==e.y&&i.almostEqual(e.x,0,t)&&(e.x=0),0!==e.x&&i.almostEqual(e.y,0,s)&&(e.y=0)):(0!==e.x&&i.almostEqual(e.y,0,s)&&(e.y=0),0!==e.y&&i.almostEqual(e.x,0,t)&&(e.x=0)),e},ig.utilsvector2.directionToString=function(e){var t=i.direction(e.x),s=i.direction(e.y);for(var n in ig.utilsvector2.DIRECTION){var a=ig.utilsvector2.DIRECTION[n];if(a.x===t&&a.y===s)return n}return"NONE"},ig.utilsvector2.DIRECTION={NONE:ig.utilsvector2.vector(),LEFT:ig.utilsvector2.vector(-1,0),RIGHT:ig.utilsvector2.vector(1,0),UP:ig.utilsvector2.vector(0,-1),DOWN:ig.utilsvector2.vector(0,1),UPLEFT:ig.utilsvector2.vector(-1,-1),UPRIGHT:ig.utilsvector2.vector(1,-1),DOWNLEFT:ig.utilsvector2.vector(-1,1),DOWNRIGHT:ig.utilsvector2.vector(1,1)}}),ig.baked=!0,ig.module("plusplus.helpers.utilsintersection").requires("plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2").defines(function(){"use strict";var e=ig.utilsmath,i=ig.utilsvector2;ig.utilsintersection={},ig.utilsintersection.bounds=function(e,i,t,s,n){return n=n||{},n.minX=e,n.minY=i,n.maxX=e+t,n.maxY=i+s,n.width=t,n.height=s,n},ig.utilsintersection.boundsMinMax=function(e,i,t,s,n){return n=n||{},n.minX=e,n.minY=i,n.maxX=t,n.maxY=s,n.width=t-e,n.height=s-i,n},ig.utilsintersection.boundsOfPoints=function(e,i){var t,s,n=e[0],a=n.x,o=n.y,r=n.x,h=n.y;for(t=1,s=e.length;t<s;t++)n=e[t],n.x<a?a=n.x:n.x>r&&(r=n.x),n.y<o?o=n.y:n.y>h&&(h=n.y);return i=i||{},i.minX=a,i.minY=o,i.maxX=r,i.maxY=h,i.width=r-a,i.height=h-o,i},ig.utilsintersection.boundsClone=function(e,i,t,s){i=i||0,t=t||0;var n=e.minX+i,a=e.minY+t,o=e.maxX+i,r=e.maxY+t;return s=s||{},s.minX=n,s.minY=a,s.maxX=o,s.maxY=r,s.width=o-n,s.height=r-a,s},ig.utilsintersection.boundsCopy=function(e,i,t,s,n,a){return t=t||0,s=s||0,n=n||1,a=a||1,e.minX=i.minX*n+t,e.maxX=i.maxX*n+t,e.minY=i.minY*a+s,e.maxY=i.maxY*a+s,e.width=e.maxX-e.minX,e.height=e.maxY-e.minY,e},ig.utilsintersection.boundsCopyX=function(e,i,t,s){return t=t||0,s=s||1,e.minX=i.minX*s+t,e.maxX=i.maxX*s+t,e.width=e.maxX-e.minX,e},ig.utilsintersection.boundsCopyY=function(e,i,t,s){return t=t||0,s=s||1,e.minY=i.minY*s+t,e.maxY=i.maxY*s+t,e.height=e.maxY-e.minY,e},ig.utilsintersection.boundsCopyRotated=function(i,t,s){s%=e.TWOPI,s>Math.PI?s-=e.TWOPI:s<-Math.PI&&(s+=e.TWOPI);var n=Math.cos(s),a=Math.sin(s),o=t.width,r=t.height,h=r*n,l=o*n,g=r*a,c=o*a,u=t.minX,d=t.minY,m=u+.5*t.width,p=d+.5*t.height,f=u-m,y=d-p,E=m+f*n-y*a,v=p+f*a+y*n;return s>0?s<e.HALFPI?(i.minY=v,i.maxY=v+h+c,i.minX=E-g,i.maxX=E+l):(i.minY=v+h,i.maxY=v+c,i.minX=E-g+l,i.maxX=E):s<-e.HALFPI?(i.minY=v+c,i.maxY=v+h,i.minX=E,i.maxX=E+l-g):(i.minY=v+c+h,i.maxY=v,i.minX=E+l,i.maxX=E-g),i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i},ig.utilsintersection.AABBContains=function(e,i,t,s,n,a,o,r){return e>=n&&t<=o&&i>=a&&s<=r},ig.utilsintersection.AABBIntersect=function(e,i,t,s,n,a,o,r){return!(t<n||e>o||s<a||i>r)},ig.utilsintersection.boundsIntersect=function(e,i){return!(e.maxX<i.minX||e.minX>i.maxX||e.maxY<i.minY||e.minY>i.maxY)},ig.utilsintersection.boundsAABBIntersect=function(e,i,t,s,n){return!(e.maxX<i||e.minX>s||e.maxY<t||e.minY>n)},ig.utilsintersection.pointInAABB=function(e,i,t,s,n,a){return!(e<t||e>n||i<s||i>a)},ig.utilsintersection.pointInBounds=function(e,i,t){return!(e<t.minX||e>t.maxX||i<t.minY||i>t.maxY)},ig.utilsintersection.pointInCircle=function(e,i,t,s,n){var a=t-e,o=s-i;return a*a+o*o<n*n},ig.utilsintersection.pointInPolygon=function(e,i,t){var s,n=t.length-1,a=!1;for(s=0;s<t.length;s++){var o=t[n],r=t[s];if(o.x===e&&o.y===i||r.x===e&&r.y===i){a=!0;break}(r.y<i&&o.y>=i||o.y<i&&r.y>=i)&&(r.x<=e||o.x<=e)&&r.x+(i-r.y)/(o.y-r.y)*(o.x-r.x)<e&&(a=!a),n=s}return a},ig.utilsintersection.entitiesInAABB=function(e,i,t,s,n,a,o){var r,h,l,g=[];if(a){r=ig.game.layersMap[a];var c=n?r.itemsTargetable:r.items;for(h=0,l=c.length;h<l;h++){var u,d=c[h];if(d.fixed){var m=ig.game.screen.x,p=ig.game.screen.y;u=ig.utilsintersection.AABBIntersect(d.pos.x+m,d.pos.y+p,d.pos.x+d.size.x+m,d.pos.y+d.size.y+p,e,i,t,s)}else u=ig.utilsintersection.AABBIntersect(d.pos.x,d.pos.y,d.pos.x+d.size.x,d.pos.y+d.size.y,e,i,t,s);u&&g.push(d)}}else for(h=0,l=ig.game.layers.length;h<l;h++)r=ig.game.layers[h],r.name&&r.numEntities&&(!n||r.itemsTargetable.length)&&(g=g.concat(ig.utilsintersection.entitiesInAABB(e,i,t,s,n,r.name,!0)));return g.length>1&&!o&&ig.utilsintersection.sortByDistance(e+.5*(t-e),i+.5*(s-i),g),g},ig.utilsintersection.getIsAABBInScreen=function(e,i,t,s){var n=e-ig.game.screen.x,a=i-ig.game.screen.y;return ig.utilsintersection.AABBIntersect(n,a,n+t,a+s,0,0,ig.system.width,ig.system.height)},ig.utilsintersection.sortByDistance=function(e,t,s){var n=i.set(ig.utilsintersection._utilVec2Sort,e,t);return s.sort(function(e,i){return e.distanceSquaredEdgeTo(n)-i.distanceSquaredEdgeTo(n)||e.distanceSquaredTo(n)-i.distanceSquaredTo(n)}),s},ig.utilsintersection._utilVec2Sort={x:.1,y:.1}}),ig.baked=!0,ig.module("plusplus.helpers.utilsdraw").requires("plusplus.helpers.utilsintersection").defines(function(){"use strict";var e=ig.utilsintersection;ig.utilsdraw={},ig.utilsdraw.pixelFillPolygon=function(i,t,s,n,a,o,r,h,l,g,c,u,d){t|=0,s|=0;var m,p,f,y;u?(m=0|u.minX,p=0|u.minY,f=Math.ceil(u.maxX),y=Math.ceil(u.maxY)):(m=t,p=s,f=Math.ceil(n),y=Math.ceil(a));var E,v,T,I;!1!==d?(E=m-t-1,v=p-s-1,T=f-m+1,I=y-p+1):(E=m-t,v=p-s,T=f-m,I=y-p);var A=255*r|0,x=255*h|0,_=255*l|0,C=255*g|0,S=i.getImageData(E,v,T,I);if(!0===c){for(var w=0;w<T;w++)for(var b=0;b<I;b++)if(e.pointInPolygon(w+m,b+p,o)){var N=4*(w+b*T);S.data[N]+=A,S.data[N+1]+=x,S.data[N+2]+=_,S.data[N+3]+=C}}else for(var w=0;w<T;w++)for(var b=0;b<I;b++)if(e.pointInPolygon(w+m,b+p,o)){var N=4*(w+b*T);S.data[N]=A,S.data[N+1]=x,S.data[N+2]=_,S.data[N+3]=C}i.putImageData(S,E,v)},ig.utilsdraw.fillPolygon=function(e,i,t,s,n){t=t||0,s=s||0,n=n||1;var a=i[0];e.beginPath(),e.moveTo((a.x+t)*n,(a.y+s)*n);for(var o=1,r=i.length;o<r;o++)a=i[o],e.lineTo((a.x+t)*n,(a.y+s)*n);e.fill()},ig.utilsdraw.fillRoundedRect=function(e,i,t,s,n,a){e.beginPath(),e.moveTo(i+a,t),e.lineTo(i+s-a,t),e.quadraticCurveTo(i+s,t,i+s,t+a),e.lineTo(i+s,t+n-a),e.quadraticCurveTo(i+s,t+n,i+s-a,t+n),e.lineTo(i+a,t+n),e.quadraticCurveTo(i,t+n,i,t+n-a),e.lineTo(i,t+a),e.quadraticCurveTo(i,t,i+a,t),e.closePath(),e.fill()},ig.utilsdraw.pixelFillRoundedRect=function(e,i,t,s,n,a,o,r,h,l,g,c,u,d,m,p,f){void 0===m&&(m=Math.round(.25*l));var y=.5*Math.PI/(m+1),E=function(e,i,t){for(var s=0;s<m;s++)t+=y,v.push({x:e+l*Math.cos(t),y:i+l*Math.sin(t)})},v=[];v.push({x:a+l,y:o}),v.push({x:a+r-l,y:o}),m>0&&E(a+r-l,o+l,1.5*Math.PI),v.push({x:a+r,y:o+l}),v.push({x:a+r,y:o+h-l}),m>0&&E(a+r-l,o+h-l,0),v.push({x:a+r-l,y:o+h}),v.push({x:a+l,y:o+h}),m>0&&E(a+l,o+h-l,.5*Math.PI),v.push({x:a,y:o+h-l}),v.push({x:a,y:o+l}),m>0&&E(a+l,o+l,Math.PI),ig.utilsdraw.pixelFillPolygon(e,i,t,s,n,v,g,c,u,d,p,ig.utilsintersection.bounds(a,o,r,h),f)}}),ig.baked=!0,ig.module("plusplus.helpers.utilscolor").defines(function(){"use strict";ig.utilscolor={},ig.utilscolor.hexToRGBA=function(e){e=Math.floor(e);var i={};return i.r=(e>>24&255)/255,i.g=(e>>16&255)/255,i.b=(e>>8&255)/255,i.a=(255&e)/255,i},ig.utilscolor.RGBAToHex=function(e,i,t,s){return 255*e<<24^255*i<<16^255*t<<8^255*s<<0},ig.utilscolor.RGBToHex=function(e,i,t){return 255*e<<16^255*i<<8^255*t<<0},ig.utilscolor.CSSToRGBA=function(){var e=ig.$new("canvas");e.width=e.height=1;var i=e.getContext("2d");return function(e,t){i.clearRect(0,0,1,1),i.fillStyle=e,i.fillRect(0,0,1,1);var s=i.getImageData(0,0,1,1).data,n={};return n.r=s[0]/255,n.g=s[1]/255,n.b=s[2]/255,n.a=t,n}}(),ig.utilscolor.RGBAToCSS=function(e,i,t,s){return"rgba("+(255*e|0)+","+(255*i|0)+","+(255*t|0)+","+s+")"},ig.utilscolor.RGBToCSS=function(e,i,t){return"rgb("+(255*e|0)+","+(255*i|0)+","+(255*t|0)+")"},ig.utilscolor.linearGradient=function(e,i,t,s,n){for(var a=ig.system.context.createLinearGradient(e,i,t,s),o=1/(n.length-1),r=0,h=n.length;r<h;r++){var l,g=n[r];l="object"==typeof g?void 0!==g.a?ig.utilscolor.RGBAToCSS(g.r,g.g,g.b,g.a):ig.utilscolor.RGBToCSS(g.r,g.g,g.b):g,a.addColorStop(r*o,l)}return a},ig.utilscolor.radialGradient=function(e,i){for(var t=ig.system.context.createRadialGradient(e,e,0,e,e,e),s=1/(i.length-1),n=0,a=i.length;n<a;n++){var o,r=i[n];o="object"==typeof r?void 0!==r.a?ig.utilscolor.RGBAToCSS(r.r,r.g,r.b,r.a):ig.utilscolor.RGBToCSS(r.r,r.g,r.b):r,t.addColorStop(n*s,o)}return t}}),ig.baked=!0,ig.module("plusplus.helpers.utilstile").requires("plusplus.core.config","plusplus.core.collision-map","plusplus.helpers.utils","plusplus.helpers.utilsintersection","plusplus.helpers.utilsvector2").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils,t=ig.utilsintersection,s=ig.utilsvector2,n=(e.COLLISION.TILE_ONE_WAY_UP,e.COLLISION.TILE_ONE_WAY_DOWN),a=e.COLLISION.TILE_ONE_WAY_RIGHT,o=e.COLLISION.TILE_ONE_WAY_LEFT,r=(e.COLLISION.TILE_CLIMBABLE_WITH_TOP,e.COLLISION.TILE_CLIMBABLE,e.COLLISION.TILE_STAIRS_WITH_TOP,e.COLLISION.TILE_STAIRS,e.COLLISION.TILES_HASH_WALKABLE),h=e.COLLISION.TILES_HASH_WALKABLE_STRICT,l=e.COLLISION.TILES_HASH_ONE_WAY,g=e.COLLISION.TILES_HASH_CLIMBABLE,c=e.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY,u=e.COLLISION.TILES_HASH_CLIMBABLE_STAIRS;ig.utilstile={},ig.utilstile.defaultTileVerticesDef={},ig.utilstile.defaultTileSegmentsDef={};var d=null,m=null;ig.utilstile.rebuild=function(e){if(e instanceof ig.CollisionMap&&e.tiledef!==m){ig.utilstile.unload(),d=e,m=d.tiledef||ig.CollisionMap.defaultTileDef;for(var i in m)ig.utilstile.shapeFromTile(i,m);ig.utilstile.shapeFromTile(1,m)}else d=e},ig.utilstile.unload=function(){d=null,m=ig.CollisionMap.defaultTileDef,ig.utilstile.defaultTileVerticesDef={},ig.utilstile.defaultTileSegmentsDef={}},ig.utilstile.isTileWalkable=function(e){return r[e]},ig.utilstile.isTileWalkableStrict=function(e){return h[e]},ig.utilstile.isTileOneWay=function(e){return l[e]},ig.utilstile.isTileClimbable=function(e){return g[e]},ig.utilstile.isTileClimbableStairs=function(e){return u[e]},ig.utilstile.isTileClimbableOneWay=function(e){return c[e]},ig.utilstile.shapesFromCollisionMap=function(e,i){var t={oneWays:[],solids:[],climbables:[]};if(e instanceof ig.CollisionMap){i=i||{};var s,r,h,d,m,p,f,y,E,v,T=ig.copy(e.data),I=e.tilesize,A=e.width,x=e.height,_=[],C=[],S=[];for(p=0;p<x;p++)for(m=0;m<A;m++){if(v=ig.utilstile.shapeFromTile(e.data[p][m],e.tiledef),E={id:e.data[p][m],ix:m,iy:p,x:m*I,y:p*I,width:I,height:I,shape:v},v.vertices.length>0){for(r=[],s=v.vertices,h=v.segments,f=0,y=h.length;f<y;f++){d=h[f];var w=s[d.a];r[d.a]={x:E.x+w.x*I,y:E.y+w.y*I}}v.vertices=r,g[E.id]?i.ignoreClimbables||C.push(E):l[E.id]?i.ignoreOneWays||S.push(E):i.ignoreSolids||_.push(E)}T[p][m]=E}var b=i.rectangles;for(t.solids=t.solids.concat(ig.utilstile.shapedTilesToShapes(_,T,i)),void 0===i.groupByTileId&&(i.groupByTileId=!0),i.rectangles=void 0!==b?b:!i.contourClimbables,t.climbables=t.climbables.concat(ig.utilstile.shapedTilesToShapes(C,T,i)),f=0,y=t.climbables.length;f<y;f++)v=t.climbables[f],c[v.id]?v.settings.oneWay=!0:v.settings.sensor=!0,u[v.id]&&(v.settings.climbableStairs=!0);for(i.rectangles=void 0!==b?b:!i.contourOneWays,t.oneWays=t.oneWays.concat(ig.utilstile.shapedTilesToShapes(S,T,i)),f=0,y=t.oneWays.length;f<y;f++)v=t.oneWays[f],l[v.id]&&(v.settings.oneWay=!0,v.id===n?v.settings.oneWayFacing={x:0,y:1}:v.id===a?v.settings.oneWayFacing={x:1,y:0}:v.id===o&&(v.settings.oneWayFacing={x:-1,y:0}))}return t},ig.utilstile.shapedTilesToShapes=function(e,t,s){s=s||{};var n,a,o,r,h,l=[],g=[],c=[];if(s.groupByTileId){delete s.groupByTileId;var u,d,m=[],p={};for(n=0,a=e.length;n<a;n++){var f=e[n];p[f.id]?p[f.id].push(f):(m.push(f.id),p[f.id]=[f])}for(n=0,a=m.length;n<a;n++)u=m[n],d=p[u],s.id=u,l=l.concat(ig.utilstile.shapedTilesToShapes(d,t,s))}else{if(s.rectangles){for(var y,E,v,T,I=e.slice(0),A=[];I.length>0;){for(y=ig.utilstile.findShapedTileLine(I),i.arrayCautiousRemoveMulti(I,y),E=y.length,T=y,v=!0;v;){v=!1;var x=y[0],_=t[x.iy][x.ix+1];_&&-1!==(h=i.indexOfValue(I,_))&&(y=ig.utilstile.findShapedTileLine(I,!1,h,E),y.length===E&&(i.arrayCautiousRemoveMulti(I,y),T=T.concat(y),v=!0))}T.length>0&&A.push(T)}for(o=0,r=A.length;o<r;o++){for(T=A[o],g=[],n=0,a=T.length;n<a;n++)g=g.concat(ig.utilstile.getNonDuplicateSegmentVertices(T[n],t,T));c=c.concat(ig.utilstile.verticesToContours(g,s))}}else{for(n=0,a=e.length;n<a;n++)g=g.concat(ig.utilstile.getNonDuplicateSegmentVertices(e[n],t,e));c=ig.utilstile.verticesToContours(g,s)}for(n=0,a=c.length;n<a;n++){var C=c[n];l.push({id:s.id,x:C.minX,y:C.minY,settings:{size:{x:C.width,y:C.height},vertices:C.vertices}})}}return l},ig.utilstile.findShapedTileLine=function(e,i,t,s){t=t||0,s=s||0;for(var n=e[t],a=[],o=!0;o&&(o=!1,a.push(n),a.length!==s);){var r=i?ig.utilstile.stepShapedTileHorizontally(e,n):ig.utilstile.stepShapedTileVertically(e,n);n!==r&&(o=!0,n=r)}return a},ig.utilstile.stepShapedTileHorizontally=function(e,i){for(var t=0,s=e.length;t<s;t++){var n=e[t];if(i.iy===n.iy&&i.ix+1===n.ix)return n}return i},ig.utilstile.stepShapedTileVertically=function(e,i){for(var t=0,s=e.length;t<s;t++){var n=e[t];if(i.ix===n.ix&&i.iy+1===n.iy)return n}return i},ig.utilstile.verticesToContours=function(e,n){var a=[];if(e.length>1){n=n||{};for(var o,r,h,l,g,c,u,d=e.slice(0),m={vertices:[],minX:Number.MAX_VALUE,minY:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,maxY:-Number.MAX_VALUE},p=m.vertices,f=d.pop(),y=d.pop();d.length>-2;){var E=!1;if(h=p[0],p[1],p.length<=2||f.x!==h.x||f.y!==h.y)for(l=0,g=d.length;l<g;l+=2)if(o=d[l],r=d[l+1],f.x===o.x&&f.y===o.y){E=!0;break}if(p.push(f),f.x<m.minX&&(m.minX=f.x),f.x>m.maxX&&(m.maxX=f.x),f.y<m.minY&&(m.minY=f.y),f.y>m.maxY&&(m.maxY=f.y),!0===E)d.splice(l,2),y=o,f=r;else{if(m.vertices.length>=3&&a.push(m),!(d.length>0))break;m={vertices:[]},m.minX=m.minY=Number.MAX_VALUE,m.maxX=m.maxY=-Number.MAX_VALUE,p=m.vertices,f=d.pop(),y=d.pop()}}for(l=0,g=a.length;l<g;l++)m=a[l],m.width=m.maxX-m.minX,m.height=m.maxY-m.minY;a.sort(function(e,i){return i.width*i.width+i.height*i.height-(e.width*e.width+e.height*e.height)});var v,T,I=a.slice(0),A=[],x=[];for(m=I.pop();I.length>-1;){if(T=!1,m){for(l=a.length-1;l>-1;l--)if(v=a[l],m!==v&&t.AABBContains(m.minX,m.minY,m.maxX,m.maxY,v.minX,v.minY,v.maxX,v.maxY)){T=!0;break}x.push(m)}if(T)i.arrayCautiousRemove(I,v),m=v;else{if(x.length>1&&A.push(x),!(I.length>0))break;x=[],m=I.pop()}}var _=[],C=[];for(l=0,g=A.length;l<g;l++){x=A[l];var S=x[x.length-1],w=x[x.length-2];for(c=x.length%2==0?0:1,u=x.length;c<u;c+=2)m=x[c],-1===i.indexOfValue(_,m)&&(m.vertices.reverse(),_.push(m));if(n.retainBoundaryOuter||-1!==i.indexOfValue(C,S)||(C.push(S),i.arrayCautiousRemove(a,S)),n.discardBoundaryInner&&-1===i.indexOfValue(C,w)&&(C.push(w),i.arrayCautiousRemove(a,w)),n.discardEdgesInner&&x.length>2){var b=x.slice(0,x.length-2);C=C.concat(b),i.arrayCautiousRemoveMulti(a,b)}}for(l=0,g=a.length;l<g;l++){if(m=a[l],p=m.vertices,!n.discardCollinear){for(h=p[0],c=p.length-1;c>0;c--)y=p[c],f=p[c-1],0===s.pointsCW(h,y,f)?p.splice(c,1):h=y,y=f;0===s.pointsCW(p[c+1],p[c],p[p.length-1])&&p.splice(0,1)}n.reverse&&p.reverse();var N=m.minX,O=m.minY,L=m.width,D=m.height;for(c=0,u=p.length;c<u;c++)y=p[c],y.x-=N+.5*L,y.y-=O+.5*D}}return a},ig.utilstile.shapeFromTile=function(e,i){var t,s,n,a=ig.utilstile.verticesFromTile(e,i);if(a)if(ig.utilstile.defaultTileSegmentsDef[e])n=ig.utilstile.defaultTileSegmentsDef[e];else for(ig.utilstile.defaultTileSegmentsDef[e]=n=[],t=0,s=a.length;t<s;t++){var o,r,h=a[t],l=t===s-1?0:t+1,g=a[l],c=g.x-h.x,u=g.y-h.y,d=Math.sqrt(c*c+u*u);d>0?(o=u/d,r=-c/d):o=r=0,n.push({a:t,b:l,normal:{x:o,y:r}})}return{vertices:a,segments:n||[]}},ig.utilstile.verticesFromTile=function(e,i){"undefined"===i&&(i=m);var t;if(ig.utilstile.defaultTileVerticesDef[e])t=ig.utilstile.defaultTileVerticesDef[e];else{if(1===parseInt(e)||g[e])t=[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1}];else{t=[];var n=i[e];if(n){var a,o,r,h,l=t[0]={x:n[0],y:n[1]},c=t[1]={x:n[2],y:n[3]},u=l.x,d=l.y,p=c.x,f=c.y,y=p-u,E=f-d,v=t[2]={x:E<0?1:0,y:y>0?1:0},T=v.x,I=v.y,A=!1;if(Math.abs(y)<1&&Math.abs(E)<1){var x=s.pointQuadrant(u,d,.5,.5),_=s.pointQuadrant(p,f,.5,.5),C=s.pointQuadrant(T,I,.5,.5);x&C||_&C||(A=!0)}!0===A?(T!==I?(a=T,h=I,1==T?(o=1,r=0):(o=0,r=1)):(o=I,r=T,1==T?(a=0,h=0):(a=1,h=1)),t[3]={x:a,y:o},t[4]={x:r,y:h}):(T!==I?(a=T,h=I,1==T?(o=Math.max(d,f),r=Math.min(u,p)):(o=Math.min(d,f),r=Math.max(u,p))):(o=I,r=T,1==T?(a=Math.min(u,p),h=Math.min(d,f)):(a=Math.max(u,p),h=Math.max(d,f))),a===u&&o===d||a===p&&o===f?r===u&&h===d||r===p&&h===f||(t[3]={x:r,y:h}):t[3]={x:a,y:o}),t=s.pointsToConvexHull(t)}}ig.utilstile.defaultTileVerticesDef[e]=t}return t},ig.utilstile.getNonDuplicateSegmentVertices=function(e,i,t){var s,n,a,o,r=(e.ix,e.iy,e.shape),h=r.vertices,l=r.segments,g=[];for(s=0,n=l.length;s<n;s++){var c=l[s],u=h[c.a],d=h[c.b],m=c.normal,p=!1;if(0===m.x&&0!==m.y||0!==m.x&&0===m.y){var f=ig.utilstile.getTouchingTilesByDirection(e,m,i,t);for(a=0,o=f.length;a<o;a++){var y=f[a];if(y.shape.vertices.length>0&&(p=ig.utilstile.getSegmentOverlapWithTile(u,d,m,y)))break}}!1===p?g.push(u,d):p.segmentA&&g.push(p.segmentA.va,p.segmentA.vb)}return g},ig.utilstile.getTouchingTilesByDirection=function(e,t,s,n){var a,o,r=e.ix,h=e.iy,l=t.x,g=t.y,c=[];return 0!==l&&(o=s[h],l>0?r<o.length-1&&(a=o[r+1],n&&-1===i.indexOfValue(n,a)||c.push(a)):r>0&&(a=o[r-1],n&&-1===i.indexOfValue(n,a)||c.push(a))),0!==g&&(g>0?h<s.length-1&&(a=s[h+1][r],n&&-1===i.indexOfValue(n,a)||c.push(a)):h>0&&(a=s[h-1][r],n&&-1===i.indexOfValue(n,a)||c.push(a))),c},ig.utilstile.getSegmentOverlapWithTile=function(e,i,t,s){var n,a,o,r,h,l=!1,g=s.shape,c=g.vertices,u=g.segments;for(n=0,a=u.length;n<a;n++)if(o=u[n],r=o.normal,t.x===-r.x&&t.y===-r.y){h=o;break}if(h){var d=c[h.a],m=c[h.b],p=e.x,f=e.y,y=i.x,E=i.y,v=d.x,T=d.y,I=m.x,A=m.y,x=y-p,_=E-f,C=Math.sqrt(x*x+_*_),S=x/C,w=_/C,b=v-I,N=T-A,O=Math.sqrt(b*b+N*N);if(0==S*(N/O)-w*(b/O)){var L,D,R,k,r,P,M,F;if(0!==S?(L=Math.min(p,I),D=Math.max(p,I),R=Math.min(y,v),k=Math.max(y,v),r=S,P=p,M=y,F="x"):(L=Math.min(f,A),D=Math.max(f,A),R=Math.min(E,T),k=Math.max(E,T),r=w,P=f,M=E,F="y"),L===D&&R===k)l=!0;else{var G=r<0?L-k:R-D;if(G>0){l={segmentA:{va:{x:e.x,y:e.y},vb:{x:i.x,y:i.y}},segmentB:{va:{x:d.x,y:d.y},vb:{x:m.x,y:m.y}}};var z,B,Y=!0;r<0?(z=L===D?0:L===P?2:1,B=R===k?0:k===M?2:1,1===z?(l.segmentA.vb[F]+=G,Y=!1):2===z&&(l.segmentB.va[F]+=G),1===B?(l.segmentA.va[F]-=G,Y=!1):2===B&&(l.segmentB.vb[F]-=G),!0===Y&&(l=!0)):(z=L===D?0:L===P?1:2,B=R===k?0:k===M?1:2,1===z?(l.segmentA.vb[F]-=G,Y=!1):2===z&&(l.segmentB.va[F]-=G),1===B?(l.segmentA.va[F]+=G,Y=!1):2===B&&(l.segmentB.vb[F]+=G),!0===Y&&(l=!0))}}}}return l}}),ig.baked=!0,ig.module("plusplus.core.entity").requires("impact.entity","plusplus.core.config","plusplus.core.image","plusplus.core.background-map","plusplus.core.animation","plusplus.helpers.signals","plusplus.helpers.tweens","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.utilsdraw","plusplus.helpers.utilscolor","plusplus.helpers.utilstile").defines(function(){"use strict";var e=ig.CONFIG,i=ig.TWEEN,t=ig.utils,s=ig.utilsmath,n=ig.utilsvector2,a=ig.utilsintersection,o=ig.utilsdraw,r=ig.utilscolor,h=ig.utilstile;ig.EntityExtended=ig.Entity.extend({layerName:"entities",pos:{x:.01,y:.01},size:{x:e.ENTITY.SIZE_EFFECTIVE_X,y:e.ENTITY.SIZE_EFFECTIVE_Y},offset:{x:e.ENTITY.SIZE_OFFSET_X,y:e.ENTITY.SIZE_OFFSET_Y},posDraw:{x:.01,y:.01},sizeDraw:{x:0,y:0},scale:e.ENTITY.SCALE,scaleOfSystemScale:e.ENTITY.SCALE_OF_SYSTEM_SCALE,scaleMin:e.ENTITY.SCALE_MIN,scaleMax:e.ENTITY.SCALE_MAX,scaleMod:1,ignoreSystemScale:e.ENTITY.IGNORE_SYSTEM_SCALE,collides:0,collidesChanges:!1,collisionMapResult:null,checkAgainst:0,type:0,group:0,frozen:!1,controllable:!0,performance:e.STATIC,highPerformance:!1,fixed:!1,facing:{x:1,y:0},canFlipX:e.ENTITY.CAN_FLIP_X,canFlipY:e.ENTITY.CAN_FLIP_Y,friction:{x:e.ENTITY.FRICTION_X,y:e.ENTITY.FRICTION_Y},maxVel:{x:e.ENTITY.MAX_VEL_X,y:e.ENTITY.MAX_VEL_Y},angle:0,bounciness:e.ENTITY.BOUNCINESS,minBounceVelocity:e.ENTITY.MIN_BOUNCE_VEL,currentAnim:null,overridingAnim:null,animSheetPath:"",animSheetWidth:0,animSheetHeight:0,animSettings:null,animationType:0,animationTypes:null,animSequenceCount:1,animTileOffset:0,animFrameTime:1,animInit:"",textured:!1,persistent:!1,targetable:!1,climbable:!1,climbableStairs:!1,oneWay:!1,oneWayFacing:null,opaque:e.ENTITY.OPAQUE,opaqueOffset:e.ENTITY.OPAQUE_OFFSET,opaqueVertices:null,opaqueFromVertices:e.ENTITY.OPAQUE_FROM_VERTICES,diffuse:e.ENTITY.DIFFUSE,hollow:!0,activated:!1,alwaysToggleActivate:!1,activateCallback:null,activateContext:null,deactivateCallback:!1,deactivateContext:!1,alpha:1,hidden:!1,health:e.ENTITY.HEALTH,healthMax:e.ENTITY.HEALTH,invulnerable:!1,rangeInteractableX:0,rangeInteractableY:0,paused:!1,visible:!1,changed:!1,checking:!1,wasChecking:!1,intersecting:!1,added:!1,dieing:!1,dieingSilently:!1,canDieInstantly:!0,flip:{x:!1,y:!1},grounded:e.TOP_DOWN,standing:e.TOP_DOWN,gravityFactor:e.TOP_DOWN?0:1,hasGravity:!e.TOP_DOWN,collidingWithMap:!1,collidingWithEntitiesBelow:!1,slope:null,slopeSticking:e.ENTITY.SLOPE_STICKING,slopeSpeedMod:e.ENTITY.SLOPE_SPEED_MOD,slopeStanding:{min:s.degreesToRadians(e.ENTITY.SLOPE_STANDING_MIN),max:s.degreesToRadians(e.ENTITY.SLOPE_STANDING_MAX)},moving:!1,movingX:!1,movingY:!1,movingTo:null,movedTo:!0,movingToOnce:!1,movingToTweening:!1,movingToTweenPct:0,linkedTo:null,managed:!1,tweens:{},resetState:{},needsVertices:e.ENTITY.NEEDS_VERTICES,vertices:null,verticesWorld:null,onAdded:null,onRemoved:null,onMovedTo:null,onRefreshed:null,needsRebuild:!0,_posLast:{x:0,y:0},_angleLast:0,_changedAdd:!1,_verticesFound:!1,_overridedAnim:!1,_cleanupPersistent:!1,init:function(e,i,t){this.id=++ig.Entity._lastId,this.initTypes(),this.initProperties(),this.reset(e,i,t)},initTypes:function(){},initProperties:function(){this.collisionMapResult={collision:{x:!1,y:!1,slope:!1},pos:{x:0,y:0},slope:{x:0,y:0,nx:0,ny:0},tile:{x:0,y:0,xPos:{x:0,y:0},yPos:{x:0,y:0}}},this.onAdded=new ig.Signal,this.onRemoved=new ig.Signal,this.onMovedTo=new ig.Signal,this.onRefreshed=new ig.Signal},reset:function(e,i,t){this.resetCore(e,i,t),this.resetExtras()},resetCore:function(e,i,s){ig.merge(this,this.resetState),e&&(this.pos.x=e),i&&(this.pos.y=i),s&&!ig.global.wm&&("string"==typeof s.type&&(t.addType(ig.EntityExtended,this,"type",s.type),delete s.type),"string"==typeof s.checkAgainst&&(t.addType(ig.EntityExtended,this,"checkAgainst",s.checkAgainst),delete s.checkAgainst),"string"==typeof s.group&&(t.addType(ig.EntityExtended,this,"group",s.group,"GROUP"),delete s.group)),ig.merge(this,s),this._killed=this.dieing=this.dieingSilently=!1},resetExtras:function(){if(this.healthMax=this.health,this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.fixed=!1),this.fixed&&(this.collides=ig.EntityExtended.COLLIDES.NEVER),this.hasGravity||this.setGrounded(!0),this.animSheetPath&&(this.animSheet=new ig.AnimationSheet(e.PATH_TO_MEDIA+this.animSheetPath,this.animSheetWidth,this.animSheetHeight),this.animSheetPath=""),this.animSettings){if(this.anims={},this.resetState.currentAnim=null,!0===this.animSettings)this.createAnim();else for(var i in this.animSettings)this.createAnim(i,this.animSettings[i]);delete this.animSettings}this.recordResetState(),ig.global.wm||ig.system.onResized.add(this.refresh,this),this.refresh(),this.frozen?this.changed=this._changedAdd=!1:this.changed=this._changedAdd=!0,this.activated&&(this.activated=!1,this.activate())},recordResetState:function(){var e=this.resetState;e.pos||(e.pos={x:0,y:0}),n.copy(e.pos,this.pos),e.vel||(e.vel={x:0,y:0}),n.copy(e.vel,this.vel),e.accel||(e.accel={x:0,y:0}),n.copy(e.accel,this.accel),e.layerName=this.layerName,e.frozen=this.frozen,e.alpha=this.alpha,e.type=this.type,e.checkAgainst=this.checkAgainst,e.collides=this.collides,e.performance=this.performance,e.health=this.health},createAnim:function(e,i){i=i||{};var s,n,a=i.sequence,o=i.tileOffset||this.animTileOffset;if(!a||!a.length){a=i.sequence=[];var r=i.sequenceCount||this.animSequenceCount,h=0,l=i.type||this.animationType;if(l&&this.animationTypes){var g=t.indexOfValue(this.animationTypes,l);-1!==g&&(h+=r*g)}for(s=0;s<r;s++)a[s]=h+s}if(o)for(s=0,n=a.length;s<n;s++)a[s]+=o;if(i.frameTime=i.frameTime||this.animFrameTime,e)this.addAnim(e,i);else{var c=this.addAnim("idle",i);this.anims.idleX=c,this.anims.idleY=c,this.anims.idleLeft=c,this.anims.idleRight=c,this.anims.idleUp=c,this.anims.idleDown=c}},addAnim:function(e,i){if(!this.animSheet)throw"No animSheet to add the animation "+e+" to.";var t=new ig.AnimationExtended(this.animSheet,i);return this.anims[e]=t,this.currentAnim||(this.currentAnim=t),t},getDirectionalAnimName:function(e){return 0!==this.facing.y?this.canFlipY?e+"Y":this.facing.y<0?e+"Up":e+"Down":this.canFlipX?e+"X":this.facing.x<0?e+"Left":e+"Right"},refresh:function(e){if(!this.ignoreSystemScale){var i=Math.min(Math.max(Math.round(ig.system.scale*this.scaleOfSystemScale),this.scaleMin),this.scaleMax);this.scale!==i&&(this.scale=i,e=!0)}this.needsRebuild&&(e=!0),this.scaleMod=this.scale/ig.system.scale,e=this.resize(e)||e,(e||this.needsRebuild)&&(this.sizeDraw.x=this.getSizeDrawX(),this.sizeDraw.y=this.getSizeDrawY()),e=this.reposition(e)||e,this.recordChanges(e),this.recordLast(),n.copy(this.last,this.pos),(e||this.needsRebuild)&&this.rebuild(),this.movingTo&&this.moveToUpdate(),this.onRefreshed.dispatch(this),this.frozen?(this.changed=this.moving=this.movingX=this.movingY=!1,this.facing.x=this.facing.y=0):this.performance===ig.EntityExtended.PERFORMANCE.STATIC&&this.changed&&(this.moving=this.movingX=this.movingY=!1,this._changedAdd=!0)},resize:function(e){return e},reposition:function(e){return this.movingTo&&(this.movedTo=!1),e},rebuild:function(){
this.needsRebuild=!1},adding:function(){this.ready(),this.onAdded.dispatch(this)},ready:function(){if(this.changePerformance(),this.linkedTo){var e=this.linkedTo;this.linkedTo=null,this.link(e,e.added)}var i=this.getDirectionalAnimName("spawn");this.anims[i]?this.animOverride(i,{callback:this.spawn}):this.spawn()},spawn:function(){this.resetToInitAnim()},resetToInitAnim:function(){if(this.animInit instanceof ig.Animation?this.currentAnim=this.animInit:this.animInit?this.currentAnim=this.anims[this.animInit]:this.currentAnim=this.anims.idle||this.currentAnim,this.currentAnim){this.resetState.currentAnim=this.currentAnim;var e=this.currentAnim.stop;this.currentAnim.playFromStart(),this.currentAnim.stop=e}},setPerformance:function(e){this.performance=e,this.performance!==this.performanceLast&&this.changePerformance()},changePerformance:function(){this.performanceLast=this.performance,this.performance===ig.EntityExtended.PERFORMANCE.MOVABLE?this.changePerformanceMovable():this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC?this.changePerformanceDynamic():this.changePerformanceStatic()},changePerformanceStatic:function(){},changePerformanceMovable:function(){},changePerformanceDynamic:function(){},setControllable:function(e){void 0===e&&(e=!0),e?this.addControl():this.removeControl()},addControl:function(){this.controllable=!0},removeControl:function(){this.controllable=!1,this.applyAntiVelocity()},getLayer:function(){return ig.game.layersMap[this.layerName]},getVertices:function(){var e=.5*this.size.x,i=.5*this.size.y;return[{x:-e,y:-i},{x:e,y:-i},{x:e,y:i},{x:-e,y:i}]},getVerticesWorld:function(){return this.vertices||(this.vertices=this.getVertices()),n.projectPoints(this.vertices,this.pos.x+.5*this.size.x,this.pos.y+.5*this.size.y,1,1,this.angle)},getSizeDrawX:function(){return this.size.x+2*this.offset.x},getSizeDrawY:function(){return this.size.y+2*this.offset.y},getPosDrawX:function(){return this.pos.x-this.offset.x},getPosDrawY:function(){return this.pos.y-this.offset.y},getCenterX:function(){return this.pos.x+.5*this.size.x},getCenterY:function(){return this.pos.y+.5*this.size.y},getIsVisible:function(){if(this.alpha<=0)return!1;if(this.fixed)return a.AABBIntersect(this.posDraw.x,this.posDraw.y,this.posDraw.x+this.sizeDraw.x,this.posDraw.y+this.sizeDraw.y,0,0,ig.system.width,ig.system.height);var e=this.posDraw.x-ig.game.screen.x,i=this.posDraw.y-ig.game.screen.y;return a.AABBIntersect(e,i,e+this.sizeDraw.x,i+this.sizeDraw.y,0,0,ig.system.width,ig.system.height)},getNewVelocity:function(e,i,t,n){if(i)return s.clamp(e+i*ig.system.tick,-n,n);if(t){var a=t*ig.system.tick;return e-a>0?Math.min(e-a,n):e+a<0?Math.max(e+a,-n):0}return s.clamp(e,-n,n)},getIsMovingSelf:function(){return this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC||this.movingTo},getIsCollidingWithOneWay:function(i){if(0!==i.oneWayFacing.x)if(i.oneWayFacing.x<0){if(this.pos.x+this.size.x-i.pos.x<=Math.max(i.size.x,this.size.x)*e.PRECISION_PCT_ONE_SIDED+Math.max(this.vel.x*ig.system.tick,0)-Math.min(i.vel.x*ig.system.tick,0))return!0}else if(i.pos.x+i.size.x-this.pos.x<=Math.max(i.size.x,this.size.x)*e.PRECISION_PCT_ONE_SIDED-Math.min(this.vel.x*ig.system.tick,0)+Math.max(i.vel.x*ig.system.tick,0))return!0;if(0!==i.oneWayFacing.y)if(i.oneWayFacing.y<0){if(this.pos.y+this.size.y-i.pos.y<=i.size.y*e.PRECISION_PCT_ONE_SIDED+Math.max(this.vel.y*ig.system.tick,0)-Math.min(i.vel.y*ig.system.tick,0)+(i.slope&&0!==i.accel.x&&i.slope.nx*i.vel.x<=0?i.vel.x*ig.system.tick:0))return!0}else if(i.pos.y+i.size.y-this.pos.y<=Math.max(i.size.y,this.size.y)*e.PRECISION_PCT_ONE_SIDED-Math.min(this.vel.y*ig.system.tick,0)+Math.max(i.vel.y*ig.system.tick,0))return!0},touches:function(e){return a.AABBIntersect(this.pos.x,this.pos.y,this.pos.x+this.size.x,this.pos.y+this.size.y,e.pos.x,e.pos.y,e.pos.x+e.size.x,e.pos.y+e.size.y)},distanceTo:function(e){var i=this.pos.x+.5*this.size.x,t=this.pos.y+.5*this.size.y;this.fixed&&(i+=ig.game.screen.x,t+=ig.game.screen.y);var s,n;if(e instanceof ig.EntityExtended){var a=e.pos.x+.5*e.size.x,o=e.pos.y+.5*e.size.y;e.fixed&&(a+=ig.game.screen.x,o+=ig.game.screen.y),s=i-a,n=t-o}else s=i-e.x,n=t-e.y;return Math.sqrt(s*s+n*n)},distanceSquaredTo:function(e){var i=this.pos.x+.5*this.size.x,t=this.pos.y+.5*this.size.y;this.fixed&&(i+=ig.game.screen.x,t+=ig.game.screen.y);var s,n;if(e instanceof ig.EntityExtended){var a=e.pos.x+.5*e.size.x,o=e.pos.y+.5*e.size.y;e.fixed&&(a+=ig.game.screen.x,o+=ig.game.screen.y),s=i-a,n=t-o}else s=i-e.x,n=t-e.y;return s*s+n*n},distanceEdgeTo:function(e){var i,t,s,n;this.fixed?(i=this.pos.x+ig.game.screen.x,t=i+this.size.x,s=this.pos.y+ig.game.screen.y,n=s+this.size.y):(i=this.pos.x,t=i+this.size.x,s=this.pos.y,n=s+this.size.y);var a,o,r,h;e instanceof ig.EntityExtended?e.fixed?(a=e.pos.x+ig.game.screen.x,o=a+e.size.x,r=e.pos.y+ig.game.screen.y,h=r+e.size.y):(a=e.pos.x,o=a+e.size.x,r=e.pos.y,h=r+e.size.y):(a=o=e.x,r=h=e.y);var l,g;return l=t<a?a-t:i>o?i-o:0,g=n<r?r-n:s>h?s-h:0,Math.sqrt(l*l+g*g)},distanceSquaredEdgeTo:function(e){var i,t,s,n;this.fixed?(i=this.pos.x+ig.game.screen.x,t=i+this.size.x,s=this.pos.y+ig.game.screen.y,n=s+this.size.y):(i=this.pos.x,t=i+this.size.x,s=this.pos.y,n=s+this.size.y);var a,o,r,h;e instanceof ig.EntityExtended?e.fixed?(a=e.pos.x+ig.game.screen.x,o=a+e.size.x,r=e.pos.y+ig.game.screen.y,h=r+e.size.y):(a=e.pos.x,o=a+e.size.x,r=e.pos.y,h=r+e.size.y):(a=o=e.x,r=h=e.y);var l,g;return l=t<a?a-t:i>o?i-o:0,g=n<r?r-n:s>h?s-h:0,l*l+g*g},angleTo:function(e){return e instanceof ig.EntityExtended?Math.atan2(this.pos.x+.5*this.size.x-(e.pos.x+.5*e.size.x),this.pos.y+.5*this.size.y-(e.pos.y+.5*e.size.y)):Math.atan2(this.pos.x+.5*this.size.x-e.x,this.pos.y+.5*this.size.y-e.y)},applyAntiVelocity:function(){this.applyAntiVelocityX(),this.applyAntiVelocityY()},applyAntiVelocityX:function(){this.vel.x=0,this.movingX=!1,this.moving=this.movingY},applyAntiVelocityY:function(){this.vel.y=0,this.movingY=!1,this.moving=this.movingX},applyAntiGravity:function(){0!==this.gravityFactor&&(this.vel.y-=ig.game.gravity*ig.system.tick*this.gravityFactor)},setGrounded:function(i){e.TOP_DOWN?this.standing=this.grounded=!0:(this.standing=this.grounded=this.hasGravity,i||(this.slopeSticking&&this.hasGravity?this.vel.y=this.maxVel.y:this.vel.y=0))},setUngrounded:function(){e.TOP_DOWN||(this.grounded=this.standing=!1)},animOverride:function(e,i){if(this.overridingAnimName!==e&&(i&&i.entity||this).anims[e]){i=i||{};var t=i.entity||this;this.animRelease(),this.overridingAnimName=e,this.overridingAnimCallback=i.callback,this.overridingAnimContext=i.context,this.overridingAnimFrozen=this.frozen,this._overridedAnim=this.currentAnim,this.currentAnim=this.overridingAnim=t.anims[e],i.loop||i.lock||i.stop||this.overridingAnim.onCompleted.addOnce(this.animRelease,this),this.frozen&&(this.frozen=!1),i.frame?(this.overridingAnim.gotoFrame(i.frame),"boolean"==typeof i.reverse&&(this.overridingAnim.reverse=i.reverse)):this.overridingAnim.playFromStart(!i.loop,i.reverse),"boolean"==typeof i.stop&&(this.overridingAnim.stop=i.stop)}else i&&"function"==typeof i.callback&&(this.animRelease(e,!0),i.callback.call(i.context||this))},animRelease:function(e,i){if(!e||this.overridingAnimName===e){var t=this.overridingAnimCallback,s=this.overridingAnimContext;this.overridingAnimFrozen&&(this.frozen=this.overridingAnimFrozen),this.overridingAnim&&(this.overridingAnim.onCompleted.remove(this.animRelease,this),this.currentAnim=this._overridedAnim,this.overridingAnimName=this.overridingAnim=this._overridedAnim=this.overridingAnimCallback=this.overridingAnimContext=void 0),!i&&t&&t.call(s||this)}},initOpaqueVertices:function(){this.opaqueVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},getOpaqueVertices:function(){var e=this.size.x,i=this.size.y,t=this.pos.x,s=this.pos.y,n=this.opaqueOffset;this.currentAnim&&this.currentAnim.opaqueOffset&&(n=this.currentAnim.opaqueOffset.tiles&&this.currentAnim.opaqueOffset.tiles[this.currentAnim.tile]||this.currentAnim.opaqueOffset);var a=t+n.left,o=s+n.top,r=t+e+n.right,h=s+i+n.bottom,l=t+.5*e,g=s+.5*i,c=this.opaqueVertices[0],u=this.opaqueVertices[1],d=this.opaqueVertices[2],m=this.opaqueVertices[3];if(0!==this.angle){var p=Math.cos(this.angle),f=Math.sin(this.angle),y=a-l,E=o-g,v=r-l,T=h-g;c.x=l+y*p-E*f,c.y=g+y*f+E*p,u.x=l+v*p-E*f,u.y=g+v*f+E*p,d.x=l+v*p-T*f,d.y=g+v*f+T*p,m.x=l+y*p-T*f,m.y=g+y*f+T*p}else c.x=a,c.y=o,u.x=r,u.y=o,d.x=r,d.y=h,m.x=a,m.y=h;return this.opaqueVertices},castShadow:function(e,i,t,s,h,l){if(this._contours||(this._utilVec2Cast1={x:0,y:0},this._utilVec2Cast2={x:0,y:0},this._utilVec2Cast3={x:0,y:0},this._utilVec2Cast4={x:0,y:0},this._utilVec2Project1={x:0,y:0},this._utilVec2Project2={x:0,y:0},this._utilVec2Project3={x:0,y:0},this._utilVec2Project4={x:0,y:0},this._contourPool=[],this._contours=[]),this.opaqueFromVertices?this._verticesFound||(this.opaqueVertices=this.verticesWorld=this.getVerticesWorld()):(this.opaqueVertices||this.initOpaqueVertices(),this._verticesFound||this.getOpaqueVertices()),this._verticesFound=!0,this.hollow||!a.pointInPolygon(t.x,t.y,this.opaqueVertices)){var g,c,u,d,m,p,f,y,E,v,T,I,A,x,_,C,S,w,b=this.diffuse>=1||e.diffuse>=1?1:this.diffuse*e.diffuse,N=this.opaqueVertices,O=s+2*l,L=h+2*l,D=!1,R=this._contourPool,k=this._contours,P=N[N.length-1];for(A=0,x=N.length;A<x;A++){v=N[A];var M,F,G,z;if(P.x<v.x?(M=P.x,G=v.x):(M=v.x,G=P.x),P.y<v.y?(F=P.y,z=v.y):(F=v.y,z=P.y),a.AABBIntersect(M,F,G,z,s,h,O,L)){D=!0;var B=n.copy(this._utilVec2Cast1,v);n.subtract(B,P);var Y=n.set(this._utilVec2Cast2,B.y,-B.x),H=n.copy(this._utilVec2Cast3,P);if(n.subtract(H,t),n.dot(Y,H)>0){var U=n.copy(this._utilVec2Cast4,v);n.subtract(U,t),R.push({vertices:this.projectShadow(t,l,P,v,H,U,B),verticesActual:[P,v],verticesHollow:[]})}}P=v}if(D){for(A=0,x=R.length;A<x;A++){for(g=R[A],c=g.vertices,E=!1,P=c[0],v=c[1],T=c[c.length-2],I=c[c.length-1],_=A+1;_<x;_++){if(u=R[_],d=u.vertices,m=d[0],p=d[1],f=d[d.length-2],y=d[d.length-1],n.equal(P,y)&&n.equal(v,f)){E=!0,R[_]={vertices:d.slice(0,-1).concat(c.slice(2)),verticesActual:u.verticesActual.slice(0,-1).concat(g.verticesActual),verticesHollow:g.verticesHollow.concat(P,u.verticesHollow)};break}if(n.equal(T,p)&&n.equal(I,m)){E=!0,R[_]={vertices:c.slice(0,-1).concat(d.slice(2)),verticesActual:g.verticesActual.slice(0,-1).concat(u.verticesActual),verticesHollow:u.verticesHollow.concat(I,g.verticesHollow)};break}}!0!==E&&k.push(g)}if(this.hollow)for(A=0,x=k.length;A<x;A++)g=k[A],g.vertices=g.vertices.concat(g.verticesHollow);else{var W=N.slice(0),X={},V=[],q=!1;for(A=0,x=W.length;A<x;A++){var K=W[A],j=!1;for(_=0,C=k.length;_<C;_++){g=k[_];var Z=g.verticesActual;for(S=0,w=Z.length;S<w;S++){var Q=Z[S];if(K.x===Q.x&&K.y===Q.y){j=!0,V&&(X[0===_?C-1:_-1]=V,V=void 0,q=!0);break}}if(!0===j)break}!1===j&&(V||(V=[]),V.push(K))}if(V&&(X[C-1]=V!==X[C-1]?V.concat(X[C-1]||[]):V),q){var J={vertices:[]};for(A=0,x=k.length;A<x;A++)g=k[A],J.vertices=J.vertices.concat(g.vertices,X[A]||[]);k=[J]}else k.push({vertices:W})}if(e.pixelPerfect)for(A=0,x=k.length;A<x;A++)g=k[A],o.pixelFillPolygon(i,s,h,O,L,g.vertices,1,1,1,b,!0,a.boundsOfPoints(g.vertices));else for(i.fillStyle=r.RGBAToCSS(1,1,1,b),A=0,x=k.length;A<x;A++)g=k[A],o.fillPolygon(i,g.vertices,-s,-h,e.scale);R.length=k.length=0}}},projectShadow:function(e,i,t,s,a,o,r){var h=this._utilVec2Project1,l=n.copy(this._utilVec2Project2,a);n.inverse(l);var g=n.dot(r,l)/n.lengthSquared(r);if(g<0)n.copy(h,t);else if(g>1)n.copy(h,s);else{n.copy(h,t);var c=n.copy(this._utilVec2Project3,r);n.multiplyScalar(c,g),n.add(h,c)}var u=n.copy(this._utilVec2Project4,h);n.subtract(u,e),n.normalize(u),n.multiplyScalar(u,i),n.normalize(a),n.multiplyScalar(a,i),n.normalize(o),n.multiplyScalar(o,i);var d=n.clone(t);n.add(d,a);var m=n.clone(s);n.add(m,o);var p,f;return g<0?(f=n.clone(s),n.add(f,u),[t,d,f,m,s]):g>1?(p=n.clone(t),n.add(p,u),[t,d,p,m,s]):(p=n.clone(t),n.add(p,u),f=n.clone(s),n.add(f,u),[t,d,p,f,m,s])},activate:function(e){this.activated=!0,this.activateCallback&&this.activateCallback.call(this.activateContext||this,e)},deactivate:function(e){this.activated=!1,this.deactivateCallback&&this.deactivateCallback.call(this.deactivateContext||this,e)},toggleActivate:function(e){!this.alwaysToggleActivate&&this.activated?this.deactivate(e):this.activate(e)},setHidden:function(e){e?this.hide():this.unhide()},hide:function(){this.hidden=!0},unhide:function(){this.hidden=!1},fadeTo:function(i,t){if(this.alpha!==i)return t=ig.merge({name:"fade",duration:e.DURATION_FADE},t),this.tween({alpha:i||0},t);t&&(t.onUpdate&&t.onUpdate(),t.onComplete&&t.onComplete())},fadeIn:function(e){return this.fadeTo(1,e)},fadeOut:function(e){return this.fadeTo(0,e)},fadeToDeath:function(e){e=e||{};var i=this,t=e.onComplete;return e.onComplete=function(){ig.game.removeEntity(i),t&&t()},this.fadeTo(0,e)},tween:function(e,t){var s=this;t=t||{};var n=t.name||"tween",a=this.tweens[n];if(a&&a.stop(),!t.noComplete){var o=t.onComplete;t.onComplete=function(){delete s.tweens[n],"function"==typeof o&&o()}}return this.tweens[n]=i.tween(this,e,t)},tweenEnd:function(e){if("string"==typeof e){var i=this.tweens[e];i&&(i.stop(),delete this.tweens[e])}else for(e in this.tweens)this.tweenEnd(e)},moveTo:function(e,i){if(e&&this.movingTo!==e){if(this.moveToStop(),i=i||{},t.isArray(e)){if(0===e.length)return;if(this.movingToSequence=e.slice(0),e=this.movingToSequence.shift(),this.movingTo===e)return;this.movingToOnce=!0}void 0!==i.once&&(this.movingToOnce=i.once);var s=!this.fixed&&this.performance===ig.EntityExtended.PERFORMANCE.STATIC;if(e instanceof ig.EntityExtended&&(i.matchPerformance||this.ignoreSystemScale||this.scale!==ig.system.scale)&&this.performance!==ig.EntityExtended.PERFORMANCE.MOVABLE&&(this.setPerformance(ig.EntityExtended.PERFORMANCE.MOVABLE),s=!1),i.randomOffsetPct){i.baseOffsetPct=i.baseOffsetPct||i.offsetPct||{x:0,y:0};var n=i.randomOffsetPct;n.x=n.x||0,n.y=n.y||0,i.offsetPct={x:i.baseOffsetPct.x+(2*Math.random()*n.x-n.x),y:i.baseOffsetPct.y+(2*Math.random()*n.y-n.y)}}if(!s||i.lerp||i.tween){if(this.frozen=!1,this.movingTo=e,this.movedTo=!1,this.movingToSettings=i,i.tween&&this.performance!==ig.EntityExtended.PERFORMANCE.DYNAMIC){this.movingToTweening=!0,this.movingToTweenPct=0,this.movingToTweenX=this.pos.x,this.movingToTweenY=this.pos.y;var a=i.tweenSettings=i.tweenSettings||{};a.name="movingTo",a.onComplete=function(){this.moveToUpdate(),this.moveToComplete()}.bind(this),this.tween({movingToTweenPct:1},a)}return!0}this.moveToPosition(e,i),this.recordChanges()}return!1},moveToSequenceNext:function(){this.movingToSequence&&(this.movingToSequence.length>0?(this.movingTo=null,this.moveTo(this.movingToSequence.shift(),this.movingToSettings)):(this.movingToSequence=void 0,this.moveToComplete(),this.moveToStop()))},moveToUpdate:function(){!this.movingTo||this.movedTo&&!this.movingTo.changed||this.moveToPosition(this.movingTo,this.movingToSettings)},moveToPosition:function(i,t){var n=0,a=0,o=.5,r=.5;if(i instanceof ig.EntityExtended){if(t){var h=t.align;h&&(void 0!==h.x&&(o=h.x),void 0!==h.y&&(r=h.y));var l=t.offset;l&&(n+=l.x*i.scaleMod||0,a+=l.y*i.scaleMod||0);var g=t.offsetPct;if(g){var c=g.x||0,u=g.y||0;n+=c*(.5*i.size.x*i.scaleMod+.5*this.size.x*this.scaleMod)*(i.flip.x?-1:1),a+=u*(.5*i.size.y*i.scaleMod+.5*this.size.y*this.scaleMod)}t.flipWith&&(this.flip.x=i.flip.x,this.flip.y=i.flip.y)}n+=i.pos.x+o*(i.size.x*i.scaleMod-this.size.x*this.scaleMod),a+=i.pos.y+r*(i.size.y*i.scaleMod-this.size.y*this.scaleMod),this.fixed?i.fixed||(n-=ig.game.screen.x,a-=ig.game.screen.y):i.fixed&&(n+=ig.game.screen.x,a+=ig.game.screen.y)}else{if(t){var h=t.align;h&&(void 0!==h.x&&(o=h.x),void 0!==h.y&&(r=h.y));var l=t.offset;l&&(n+=l.x||0,a+=l.y||0);var g=t.offsetPct;if(g){var c=g.x||0,u=g.y||0;n+=c*this.size.x*.5,a+=u*this.size.y*.5}}n+=i.x+o*this.size.x,a+=i.y+r*this.size.y,this.fixed&&(n-=ig.game.screen.x,a-=ig.game.screen.y)}var d=n-this.pos.x,m=a-this.pos.y;this.movingToTweening?(this.pos.x=this.movingToTweenX+(n-this.movingToTweenX)*this.movingToTweenPct,this.pos.y=this.movingToTweenY+(a-this.movingToTweenY)*this.movingToTweenPct):t&&t.lerp?(this.pos.x+=d*t.lerp,this.pos.y+=m*t.lerp):(this.pos.x=n,this.pos.y=a),s.almostEqual(d,0,e.PRECISION_ZERO)&&s.almostEqual(m,0,e.PRECISION_ZERO)&&this.moveToComplete()},moveToComplete:function(){if(!this.movingToSequence)return this.movingToOnce&&this.moveToStop(),this.movedTo=!0,this.onMovedTo.dispatch(this),!0;this.moveToSequenceNext()},moveToStop:function(){this.movingTo&&(this.movingToTweening&&(this.tweenEnd("movingTo"),this.movingToTweenPct=this.movingToTweenX=this.movingToTweenY=0),this.movedTo=this.movingToTweening=this.movingToOnce=!1,this.movingTo=this.movingToSettings=this.movingToSequence=null)},moveAllStop:function(){this.moveToStop(),this.applyAntiVelocity()},lookAt:function(i){if(i&&this!==i&&!i.fixed){var t,s,n,a=this.pos.x+.5*this.size.x;if(e.TOP_DOWN){t=this.pos.y+.5*this.size.y,i instanceof ig.EntityExtended?(s=i.pos.x+.5*i.size.x,n=i.pos.y+.5*i.size.y):(s=i.x,n=i.y);var o=a-s,r=t-n;Math.abs(o)>Math.abs(r)?(this.facing.y=0,o>0?(this.flip.x=this.canFlipX,this.facing.x=-1):(this.flip.x=!1,this.facing.x=1)):(this.facing.x=0,r>0?(this.flip.y=this.canFlipY,this.facing.y=-1):(this.flip.y=!1,this.facing.y=1))}else s=i instanceof ig.EntityExtended?i.pos.x+.5*i.size.x:i.x,a>s?(this.flip.x=this.canFlipX,this.facing.x=-1):(this.flip.x=!1,this.facing.x=1)}},lineOfSight:function(e){if(e.hidden)return!1;var i=ig.game.collisionMap,t=i.tilesize,s=(this.pos.x+.5*this.size.x)/t|0,n=(this.pos.y+.5*this.size.y)/t|0,a=(e.pos.x+.5*e.size.x)/t|0,o=(e.pos.y+.5*e.size.y)/t|0,r=a-s,l=o-n,g=Math.sqrt(r*r+l*l),c=r/g,u=l/g;s=Math.round(s+c),n=Math.round(n+u);for(var d=0,m=(0|g)-2;d<m;d++){var p=0|s,f=0|n,y=i.data[f][p];if(!h.isTileWalkableStrict(y))return!1;s+=c,n+=u}return!0},receiveDamage:function(e,i,t){return!(this.invulnerable&&!t||!e||(this.health-=e,this.health<=0&&this.kill(),0))},manageStart:function(){this.managed=!0},manageStop:function(){this.managed=!1},pause:function(){this.paused=!0;var e,i,t;for(e in this.anims)(i=this.anims[e])&&i.timer.pause();for(var e in this.tweens)(t=this.tweens[e])&&t.pause()},unpause:function(){this.paused=!1;var e,i,t;for(e in this.anims)(i=this.anims[e])&&i.timer.unpause();for(var e in this.tweens)(t=this.tweens[e])&&t.unpause()},link:function(e,i){e!==this&&(this.unlink(!1),this.linkedTo=e,this.linkedTo&&(ig.system.onResized.remove(this.refresh,this),this._killed||(this.linkedTo.onRefreshed.add(this.refresh,this),this.linkedTo.onRemoved.add(this.unlink,this))),!1===i||this._killed||this.refresh(!0))},unlink:function(e){this.linkedTo&&(this.linkedTo.onRefreshed.remove(this.refresh,this),this.linkedTo.onRemoved.remove(this.unlink,this),this._killed||ig.system.onResized.add(this.refresh,this),this.linkedTo=null),!1===e||this._killed||this.refresh(!0)},kill:function(e){this.dieing||(this.dieing=!0,this.dieingSilently=e||!1,e?this.die():this.death())},death:function(e){e&&this.anims[e]||(e=this.getDirectionalAnimName("death")),this.anims[e]?(ig.game.flagAsKilled(this),this.applyAntiVelocity(),this.animOverride(e,{callback:this.die})):this.die()},die:function(){ig.game.removeEntity(this)},cleanup:function(){if(this._cleanupPersistent&&(this._cleanupPersistent=!1,this.cleanupPersistent()),this.unhide(),this.tweenEnd(),this.moveAllStop(),this.unlink(!1),this.animRelease(),this.currentAnim=null,this.onRemoved.dispatch(this),ig.system.onResized.remove(this.refresh,this),!ig.game.hasLevel){this.onAdded.removeAll(),this.onAdded.forget(),this.onRemoved.removeAll(),this.onRemoved.forget(),this.onMovedTo.removeAll(),this.onMovedTo.forget(),this.onRefreshed.removeAll(),this.onRefreshed.forget();for(var e in this.anims){var i=this.anims[e];i.onCompleted.removeAll(),i.onCompleted.forget()}}},cleanupPersistent:function(){},cleanupCollision:function(){this.wasChecking=this.checking,this.checking=this.intersecting=this.collidingWithEntitiesBelow=!1},intersectWith:function(e){this.intersecting=!0},check:function(e){this.checking=!0},collideWith:function(e,i,t,n,a,o){var r,h;if(o)this===o&&(0!==i?(s.oppositeSidesOfZero(this.vel.x,i)?this.vel.x+=e.vel.x:this.vel.x=-this.vel.x*this.bounciness+e.vel.x,r=ig.game.collisionMap.trace(this.pos.x,this.pos.y,n,0,this.size.x,this.size.y,this.collisionMapResult)):(this.vel.y=-this.vel.y*this.bounciness+e.vel.y,h=0,t>0&&(this.collidingWithEntitiesBelow=!0,(e.collides>=ig.EntityExtended.COLLIDES.FIXED||this.collides===ig.EntityExtended.COLLIDES.LITE)&&Math.abs(this.vel.y-e.vel.y)<this.minBounceVelocity&&(this.setGrounded(),e.moving&&(h=e.pos.x-e.last.x))),r=ig.game.collisionMap.trace(this.pos.x,this.pos.y,h,n,this.size.x,this.size.y,this.collisionMapResult)),r.pos.x===this.pos.x&&r.pos.y===this.pos.y||(this.pos.x=r.pos.x,this.pos.y=r.pos.y,this.recordChanges(!0)));else{if(0!==i)this.vel.x=a,r=ig.game.collisionMap.trace(this.pos.x,this.pos.y,.5*n,0,this.size.x,this.size.y,this.collisionMapResult);else{var l;if(t>0)this.collidingWithEntitiesBelow=!0,h=e.collides>=ig.EntityExtended.COLLIDES.FIXED||this.collides===ig.EntityExtended.COLLIDES.LITE?e.vel.x*ig.system.tick:0,l=e.grounded&&e.collidingWithMap;else{if(this.grounded&&this.collidingWithMap)return;h=0}l?(r=ig.game.collisionMap.trace(this.pos.x,this.pos.y,h,n,this.size.x,this.size.y,this.collisionMapResult),this.bounciness>0&&this.vel.y>this.minBounceVelocity?this.vel.y*=-this.bounciness:this.setGrounded()):(this.vel.y=a,r=ig.game.collisionMap.trace(this.pos.x,this.pos.y,h,.5*n,this.size.x,this.size.y,this.collisionMapResult))}!r||r.pos.x===this.pos.x&&r.pos.y===this.pos.y||(this.pos.x=r.pos.x,this.pos.y=r.pos.y,this.recordChanges(!0))}},handleMovementTrace:function(e){var i,t,n=this.grounded;if(this.hasGravity&&(this.standing=!1,0===this.vel.y||this.collidingWithEntitiesBelow||(this.grounded=!1)),this.collidingWithMap=!1,e.tile.x&&h.isTileClimbable(e.tile.x)?e.pos.x=this.pos.x+this.vel.x*ig.system.tick:e.collision.x&&(this.collidingWithMap=!0,this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*=-this.bounciness:this.vel.x=0),e.tile.y&&h.isTileClimbable(e.tile.y))if(this.climbing||!this.hasGravity||this._climbingIntentUp)e.pos.y=this.pos.y+this.vel.y*ig.system.tick,e.collision.y=e.collision.slope=!1;else if(this._climbingIntentDown){i=ig.game.collisionMap;var a=Math.floor((this.pos.y+this.size.y+.5*i.tilesize)/i.tilesize);t=i.data[a];var o=t&&t[Math.floor(this.pos.x/i.tilesize)],r=t&&t[Math.floor((this.pos.x+this.size.x)/i.tilesize)];void 0!==o&&!h.isTileWalkable(o)||void 0!==r&&!h.isTileWalkable(r)||(e.pos.y=this.pos.y+this.vel.y*ig.system.tick,e.collision.y=e.collision.slope=!1)}if(e.collision.y&&(this.collidingWithMap=!0,this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:this.vel.y<0?this.vel.y=0:this.setGrounded()),e.collision.slope){var l=this.slope=e.slope;this.collidingWithMap=!0,l.angle=Math.atan2(l.ny,l.nx),l.angle>this.slopeStanding.min&&l.angle<this.slopeStanding.max?(this.setGrounded(),0!==this.accel.x&&!s.oppositeSidesOfZero(this.accel.x,this.vel.x)&&l.nx*this.vel.x<=0&&(this.vel.y=0,e.pos.y+=-Math.abs((l.angle+s.HALFPI)*this.vel.x)*this.slopeSpeedMod*ig.system.tick)):this.vel.y<0&&(this.vel.y=0)}else this.slope&&(this.jumping||this.setGrounded(),this.slope=null);if(n&&n!==this.grounded&&!this.jumping){i=ig.game.collisionMap,t=i.data[Math.floor((this.pos.y+this.size.y+1)/i.tilesize)];var g=t&&t[Math.floor((this.pos.x+.5*this.size.x)/i.tilesize)];(void 0===g||h.isTileWalkableStrict(g))&&(this.vel.y=0,e.pos.y=this.pos.y)}this.slopeSticking&&this.slope&&0===this.vel.x||(this.pos.x=e.pos.x,this.pos.y=e.pos.y)},update:function(){this.paused?ig.game.camera&&!ig.game.camera.paused&&(this.visible=this.getIsVisible()):this.frozen||(this.performance===ig.EntityExtended.PERFORMANCE.STATIC?this._changedAdd&&this.changed&&(this.updateBounds(),this.changed=!1):(this.controllable&&!this._killed&&(this.updateChanges(),this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&this.updateDynamics()),this.recordChanges(),this.recordLast()),this.visible=this.getIsVisible(),this.visible?this.updateVisible():this.dieing&&this.canDieInstantly&&this.die(),this.currentAnim&&this.currentAnim.update())},recordLast:function(){n.copy(this.last,this._posLast),n.copy(this._posLast,this.pos),this._angleLast=this.angle},recordChanges:function(i){!0===i||this.pos.x!==this.last.x||this.pos.y!==this.last.y||this.angle!==this._angleLast?(this.changed=!0,0!==this.vel.x?(this.movingX=!0,this.vel.x<0?this.flip.x=this.canFlipX:this.flip.x=!1):this.movingX=!1,0!==this.vel.y?(this.movingY=!this.hasGravity||this.vel.y<0||!this.grounded||!!this.slope&&this.movingX,(e.TOP_DOWN||this.canFlipY)&&(this.vel.y<0?this.flip.y=this.canFlipY:this.flip.y=!1)):this.movingY=!1,this.moving=this.movingX||this.movingY,this.updateBounds()):this.changed=this.moving=this.movingX=this.movingY=!1},updateBounds:function(){this.posDraw.x=this.getPosDrawX(),this.posDraw.y=this.getPosDrawY(),this.needsVertices?(this._verticesFound=!0,this.verticesWorld=this.getVerticesWorld()):this._verticesFound=!1},updateChanges:function(){this.moveToUpdate()},updateDynamics:function(){0===this.gravityFactor||0===ig.game.gravity?this.hasGravity=!1:(this.hasGravity=!0,this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor),this.updateVelocity();var e=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*ig.system.tick,this.size.x,this.size.y,this.collisionMapResult);this.handleMovementTrace(e)},updateVelocity:function(){this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x),this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y)},updateVisible:function(){this.overridingAnim&&this.currentAnim!==this.overridingAnim&&(this._overridedAnim=this.currentAnim,this.currentAnim=this.overridingAnim),this._changedAdd&&(this._changedAdd=!1,this.updateBounds())},draw:function(){if(this.currentAnim&&this.visible){var e=this.posDraw.x,i=this.posDraw.y,t=this.currentAnim.alpha,s=this.currentAnim.flip;this.currentAnim.alpha*=this.alpha,this.currentAnim.flip=this.flip;var n;0!==this.angle&&(n=this.currentAnim.angle,this.currentAnim.angle=this.angle,e+=.5*(this.sizeDraw.x-this.currentAnim.sheet.width),i+=.5*(this.sizeDraw.y-this.currentAnim.sheet.height)),this.fixed?this.currentAnim.draw(e,i,this.scale,this.textured?this:void 0):this.currentAnim.draw(e-ig.game.screen.x,i-ig.game.screen.y,this.scale,this.textured?this:void 0),this.currentAnim.alpha=t,this.currentAnim.flip=s,0!==this.angle&&(this.currentAnim.angle=n)}}}),ig.EntityExtended.PERFORMANCE={},ig.EntityExtended.PERFORMANCE.STATIC=e.STATIC||"static",ig.EntityExtended.PERFORMANCE.MOVABLE=e.MOVABLE||"movable",ig.EntityExtended.PERFORMANCE.DYNAMIC=e.DYNAMIC||"dynamic",ig.EntityExtended.TYPE=function(){var e,i,s=[],n=[];for(e in ig.Entity.TYPE)s.push({name:e,flag:ig.Entity.TYPE[e]});s.sort(function(e,i){return e.flag-i.flag});for(var a=0,o=s.length;a<o;a++){var r=s[a];e=r.name,i=r.flag,0===i||0!=(i&i-1)?n.push(r):t.getType(ig.EntityExtended,e)}for(var a=0,o=n.length;a<o;a++){var r=n[a];e=r.name,i=r.flag,ig.EntityExtended.TYPE[e]=i}return ig.EntityExtended.TYPE}(),ig.EntityExtended.TYPE.NONE,ig.EntityExtended.TYPE.A,ig.EntityExtended.TYPE.B,ig.EntityExtended.TYPE.BOTH,t.getType(ig.EntityExtended,"INTERACTIVE"),ig.EntityExtended.TYPE.INTERACTIVE,t.getType(ig.EntityExtended,"DAMAGEABLE"),ig.EntityExtended.TYPE.DAMAGEABLE,t.getType(ig.EntityExtended,"DANGEROUS"),ig.EntityExtended.TYPE.DANGEROUS,ig.EntityExtended.GROUP={},ig.EntityExtended.GROUP.NONE=0,t.getType(ig.EntityExtended,"FRIEND","GROUP"),ig.EntityExtended.GROUP.FRIEND,t.getType(ig.EntityExtended,"ENEMY","GROUP"),ig.EntityExtended.GROUP.ENEMY,ig.EntityExtended.COLLIDES=ig.merge({},ig.Entity.COLLIDES),ig.EntityExtended.COLLIDES.DOUBLEFIXED=ig.EntityExtended.COLLIDES.FIXED+ig.EntityExtended.COLLIDES.FIXED;var l=ig.EntityExtended.COLLIDES.ACTIVE,g=ig.EntityExtended.COLLIDES.DOUBLEFIXED;ig.EntityExtended.checkPair=function(i,t){i.intersectWith(t),t.intersectWith(i),0==(i.group&t.group)&&(i.checkAgainst&t.type&&i.check(t),t.checkAgainst&i.type&&t.check(i),!(i.collides&&t.collides&&i.collides+t.collides>l&&(e.COLLISION.ALLOW_FIXED||i.collides+t.collides<g))||i.oneWay&&!t.getIsCollidingWithOneWay(i)||t.oneWay&&!i.getIsCollidingWithOneWay(t)||ig.EntityExtended.solveCollision(i,t))},ig.EntityExtended.solveCollision=function(e,i){var t=null;e.collides===ig.EntityExtended.COLLIDES.LITE||i.collides===ig.EntityExtended.COLLIDES.FIXED?t=e:i.collides!==ig.EntityExtended.COLLIDES.LITE&&e.collides!==ig.EntityExtended.COLLIDES.FIXED||(t=i);var s,n,a,o,r,h;e.pos.x<i.pos.x?(a=e,o=i,r=e.pos.x+e.size.x-i.pos.x):(a=i,o=e,r=i.pos.x+i.size.x-e.pos.x),e.pos.y<i.pos.y?(s=e,n=i,h=e.pos.y+e.size.y-i.pos.y):(s=i,n=e,h=i.pos.y+i.size.y-e.pos.y);var l;h>r||n.grounded&&s.collides===ig.EntityExtended.COLLIDES.FIXED?a.collides+o.collides>=g?(a.collideWith(o,1,0,-r,0),o.collideWith(a,-1,0,r,0)):(l=.5*(a.vel.x-o.vel.x),a.collideWith(o,1,0,-r,-l,t),o.collideWith(a,-1,0,r,l,t)):s.collides+n.collides>=g?(s.collideWith(n,0,1,-h,0),n.collideWith(s,0,-1,h,0)):(l=.5*(s.vel.y-n.vel.y),s.collideWith(n,0,1,-h,-l,t),n.collideWith(s,0,-1,h,l,t))},ig.global.wm&&ig.EntityExtended.inject({visible:!0,touches:function(e){return a.pointInAABB(e.pos.x,e.pos.y,this.pos.x,this.pos.y,this.pos.x+this.size.x,this.pos.y+this.size.y)},activate:function(){},draw:function(){if(this.refresh(!0),this.updateVisible(),this.textured)for(var e in this.anims)this.anims[e].texturize(this);this.parent()}})}),ig.baked=!0,ig.module("plusplus.entities.light").requires("plusplus.core.entity","plusplus.core.config","plusplus.core.image-drawing","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.utilscolor").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils,t=ig.utilsmath,s=ig.utilsvector2,n=ig.utilsintersection,a=ig.utilscolor;ig.EntityLight=ig.global.EntityLight=ig.EntityExtended.extend({_wmScalable:!0,_wmScalableLinked:!0,layerName:"lights",size:{x:10,y:10},radius:10,r:e.LIGHT.R,g:e.LIGHT.G,b:e.LIGHT.B,alpha:e.LIGHT.ALPHA,dynamicColor:!1,pixelPerfect:e.LIGHT.PIXEL_PERFECT,gradient:e.LIGHT.GRADIENT,castsShadows:e.LIGHT.CASTS_SHADOWS,castsShadowsMovable:e.LIGHT.CASTS_SHADOWS_MOVABLE,items:[],diffuse:e.LIGHT.DIFFUSE,samples:e.LIGHT.SAMPLES,image:null,imageBase:null,imageCast:null,imageColor:null,_shadowCastingInitialized:!1,_dirtySize:!1,_dirtyColor:!1,_scaleComputedAt:0,_rLast:0,_gLast:0,_bLast:0,_alphaLast:0,_sizeLast:{x:0,y:0},_radiusLast:0,initTypes:function(){this.parent(),i.addType(ig.EntityExtended,this,"type","LIGHT")},initProperties:function(){this.image=new ig.ImageDrawing,this.imageBase=new ig.ImageDrawing,this.imageCast=new ig.ImageDrawing,this.imageColor=new ig.ImageDrawing,this.parent()},resetCore:function(e,i,t){t&&t.radius&&(this.size.x=this.size.y=2*t.radius),this.parent(e,i,t),this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE)},resize:function(e){return this.recordChanges(),this.changed&&(e=this.needsRebuild=!0),e},rebuild:function(){this.compute(),this.parent()},ready:function(){ig.system.onResized.add(this.resize,this),this.parent()},getRadius:function(){return.5*Math.max(this.size.x,this.size.y)},getSizeDrawX:function(){return 2*this.radius},getSizeDrawY:function(){return 2*this.radius},compute:function(){this.castsShadows&&(this.performance===ig.EntityExtended.PERFORMANCE.MOVABLE||this._changedAdd)&&this.findItems(),(this.changed||this._changedAdd)&&(this.performance===ig.EntityExtended.PERFORMANCE.STATIC&&(this.changed=!1),(this._dirtySize||this.castsShadows&&!this.imageCast)&&(this._dirtySize=!1,this._scaleComputedAt=this.scale,this.resizeCache(),this.drawLight()),this.castsShadows&&this.drawShadows())},resizeCache:function(){var e=2*this.radius;this.pixelPerfect||(e*=this.scale),
this.castsShadows?(this.image.setDimensions(e,e),this.imageBase.setDimensions(e,e),this.imageCast.setDimensions(e,e)):(this.image.setDimensions(e,e),0===this.imageBase.width&&0===this.imageBase.height||this.imageBase.setDimensions(0,0),0===this.imageCast.width&&0===this.imageCast.height||this.imageCast.setDimensions(0,0)),this.dynamicColor&&(this.imageColor.setDimensions(e,e),this._dirtyColor=!0)},drawLight:function(){var e,i,s,o,r,h=this.castsShadows?this.imageBase:this.image;if(this.dynamicColor?(s=1,o=1,r=1):(s=this.r,o=this.g,r=this.b),e=h.dataContext,this.pixelPerfect){var l=2*this.radius;i=e.createImageData(l,l);for(var g=0;g<l;g++)for(var c=0;c<l;c++)if(n.pointInCircle(g,c,this.radius,this.radius,this.radius)){var u=4*(g+c*l);if(i.data[u]=255*s|0,i.data[u+1]=255*o|0,i.data[u+2]=255*r|0,this.gradient){var d=this.radius-g,m=this.radius-c,p=1-Math.sqrt(d*d+m*m)/this.radius;i.data[u+3]=255*p|0}else i.data[u+3]=255}e.putImageData(i,0,0),h.finalize(1)}else{var f=this.radius*this.scale;if(this.gradient){var y=2*f,E=a.radialGradient(f,[{r:s,g:o,b:r},{r:s,g:o,b:r,a:0}]);e.fillStyle=E,e.fillRect(0,0,y,y)}else e.fillStyle=a.RGBToCSS(s,o,r),e.arc(f,f,f,0,t.TWOPI,!1),e.fill();h.finalize(this.scale)}},findItems:function(){var e=this.pos.x,i=this.pos.y,t=e+this.size.x,s=i+this.size.y,a=this.items.length;this.items.length=0;for(var o=0,r=ig.game.layers.length;o<r;o++){var h=ig.game.layers[o];if(h.numEntities)for(var l=h.itemsOpaque,g=0,c=l.length;g<c;g++){var u=l[g];if(!0!==u._killed&&(u.performance===ig.EntityExtended.PERFORMANCE.STATIC||this.castsShadowsMovable)&&n.AABBIntersect(e,i,t,s,u.pos.x,u.pos.y,u.pos.x+u.size.x,u.pos.y+u.size.y)){this.items.push(u);var d=u.currentAnim;u.changed?this.changed=!0:d&&(d!==u._animCastShadow&&(d.opaqueOffset||u._animCastShadow&&u._animCastShadow.opaqueOffset)||d.changed&&d.opaqueOffset&&d.opaqueOffset.tiles)&&(this.changed=!0,u.opaqueFromVertices||(u._verticesFound=!1)),u._animCastShadow=d}}}a!==this.items.length&&(this.changed=!0)},_initShadowCasting:function(){this._shadowCastingInitialized||(this._utilVec2Samples1={x:0,y:0},this._utilVec2Samples2={x:0,y:0},this._utilVec2Samples3={x:0,y:0})},drawShadows:function(){this._initShadowCasting();var e=this.imageCast.dataContext,i=2*this.radius;this.pixelPerfect?(e.clearRect(0,0,i,i),this.castShadows(),this.imageCast.finalize(1)):(i*=this.scale,e.clearRect(0,0,i,i),this.castShadows(),this.imageCast.finalize(this.scale));var t=this.image.dataContext,s=t.globalCompositeOperation;t.clearRect(0,0,i,i),t.drawImage(this.imageBase.data,0,0),t.globalCompositeOperation="destination-out",t.drawImage(this.imageCast.data,0,0),t.globalCompositeOperation=s,this.image.finalize(this.pixelPerfect?1:this.scale)},castShadows:function(){var e,i,n=this.imageCast.dataContext,a=this.pos.x,o=this.pos.y,r=this.radius,h=s.set(this._utilVec2Samples1,a+r,o+r);if(1===this.samples)for(e=0,i=this.items.length;e<i;e++)this.items[e].castShadow(this,n,h,a,o,r);else for(var l=0;l<this.samples;++l){var g=l*t.GOLDEN_ANGLE,c=Math.sqrt(l/this.samples)*this.radius,u=s.set(this._utilVec2Samples2,Math.cos(g)*c,Math.sin(g)*c);for(s.copy(this._utilVec2Samples3,h),s.add(this._utilVec2Samples3,u),e=0,i=this.items.length;e<i;e++)this.items[e].castShadow(this,n,this._utilVec2Samples3,a,o,r)}},cleanup:function(){ig.system.onResized.remove(this.resize,this),this.parent()},recordChanges:function(e){if(0===this.alpha)this.visible=!1;else{if(this._dirtySize=this._scaleComputedAt!==this.scale||this.radius-this._radiusLast!=0||this.size.x-this._sizeLast.x!=0|this.size.y-this._sizeLast.y!=0,(this.alpha-this._alphaLast!=0||this._dirtySize)&&(e=!0),this.dynamicColor){var i=this.r-this._rLast,t=this.g-this._gLast,n=this.b-this._bLast;0===i&&0===t&&0===n||(e=this._dirtyColor=!0),this._rLast=this.r,this._gLast=this.g,this._bLast=this.b}s.copy(this._sizeLast,this.size),this._radiusLast=this.radius,this._alphaLast=this.alpha}this.parent(e)},updateBounds:function(){this.radius=this.getRadius(),this.posDraw.x=this.pos.x,this.posDraw.y=this.pos.y},updateVisible:function(){this.compute(),this.parent()},draw:function(){var e=this.image;if(this.visible&&e){if(this.dynamicColor){if(this._dirtyColor){this._dirtyColor=!1;var i=2*this.radius;this.pixelPerfect||(i*=this.scale);var t=this.imageColor.dataContext;t.fillStyle=a.RGBToCSS(this.r,this.g,this.b),t.fillRect(0,0,i,i),t.globalCompositeOperation="destination-atop",t.drawImage(this.image.data,0,0),this.imageColor.finalize(this.pixelPerfect?1:this.scale)}e=this.imageColor}var s=ig.system.context;1!==this.alpha&&(s.globalAlpha=this.alpha),this.fixed?e.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):e.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale),1!==this.alpha&&(s.globalAlpha=1)}}}),ig.global.wm&&ig.EntityLight.inject({dynamicColor:!0,init:function(e,i,t){this.parent(e,i,t),this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE},findItems:function(){},resizeCache:function(){var e=2*this.radius;this.pixelPerfect||(e*=this.scale),this.imageBase=this.imageCast=this.image,this.image.setDimensions(e,e),this.imageColor.setDimensions(e,e),this._dirtyColor=!0},drawShadows:function(){},draw:function(){this.refresh(),this.parent()}})}),ig.baked=!0,ig.module("plusplus.core.layer").requires("plusplus.core.config","plusplus.core.entity","plusplus.core.background-map","plusplus.entities.light","plusplus.helpers.utils").defines(function(){var e=ig.CONFIG,i=ig.utils;ig.Layer=ig.Class.extend({name:"",zIndex:0,clearOnLoad:!0,noUpdate:!1,noDraw:!1,preRender:e.PRERENDER_MAPS,items:[],itemsTargetable:[],itemsInteractive:[],itemsOpaque:[],itemsLight:[],itemsChecking:[],spatialHash:{},spatialHashCellSize:64,autoSort:e.AUTO_SORT_LAYERS,sortBy:!1,numEntities:0,numBackgroundMaps:0,changed:!0,paused:!1,ignorePause:!1,_dirtySort:!1,_dirtyItems:!1,_itemsToAdd:[],init:function(e,i){this.name=e,ig.merge(this,i),this.reset()},reset:function(){if(this.changed=!0,this.paused=!1,this._dirtySort=!1,this.sortBy=this.sortBy||ig.game.sortBy,this.items.length>0){var e,i,t,s=this.items;if(!this.clearOnLoad)for(this._itemsToAdd=this.items.slice(0),i=0,t=this._itemsToAdd.length;i<t;i++)e=this._itemsToAdd[i],e.linkedTo&&(e._wasLinkedTo=e.linkedTo);for(this.items=[],this.itemsTargetable.length=this.itemsInteractive.length=this.itemsOpaque.length=this.itemsLight.length=this.itemsChecking.length=this.numBackgroundMaps=this.numEntities=0,i=0,t=s.length;i<t;i++)e=s[i],e instanceof ig.EntityExtended?ig.game.removeEntity(e):ig.game.removeItem(e)}},ready:function(){var e,i,t;if(this._itemsToAdd.length>0){for(e=0,i=this._itemsToAdd.length;e<i;e++)t=this._itemsToAdd[e],t._wasLinkedTo?(ig.game.spawnEntity(t,t.pos.x,t.pos.y,{linkedTo:t._wasLinkedTo}),delete t._wasLinkedTo):ig.game.spawnEntity(t,t.pos.x,t.pos.y,t._wasLinkedTo?{linkedTo:t._wasLinkedTo}:void 0);this._itemsToAdd.length=0}if(this.items.length>0){if(this.items.sort(this.sortBy),this.preRender&&this.numBackgroundMaps>1){var s,n=[];for(e=0,i=this.items.length;e<i;e++)(t=this.items[e])instanceof ig.BackgroundMap&&(t.preRender&&!t.repeat?(s||(s=[]),s.push(t)):s&&s.length>1&&(n.push(s),s=void 0));for(s&&s.length>1&&n.push(s),e=0,i=n.length;e<i;e++){s=n[e];var a=s[0];a instanceof ig.BackgroundMapExtended||(a=s[0]=new ig.BackgroundMapExtended(a.tilesize,a.data,a.tilesetName));for(var o=1,r=s.length;o<r;o++)t=s[o],a.merge(t),this.removeItem(t)}}for(e=0,i=this.items.length;e<i;e++)t=this.items[e],t.adding&&t.adding()}},addItem:function(e){this._dirtyItems=!0,this.items.push(e),e.highPerformance?this._addEntity(e):(e.targetable&&this.itemsTargetable.push(e),e.type&ig.EntityExtended.TYPE.INTERACTIVE&&this.itemsInteractive.push(e),e instanceof ig.EntityLight?this.itemsLight.push(e):e.opaque&&this.itemsOpaque.push(e),e instanceof ig.EntityExtended?this._addEntity(e):e instanceof ig.BackgroundMap&&(this.numBackgroundMaps++,this.preRender&&(e.preRender=!0)),this.autoSort&&this.sort())},removeItem:function(e){var t=this.items.length;t>0&&(this._dirtyItems=!0,i.arrayCautiousRemove(this.items,e),t!==this.items.length&&(e.highPerformance?this._removeEntity(e):(i.arrayCautiousRemove(this.itemsInteractive,e),i.arrayCautiousRemove(this.itemsTargetable,e),i.arrayCautiousRemove(this.itemsOpaque,e),e instanceof ig.EntityLight&&i.arrayCautiousRemove(this.itemsLight,e),e instanceof ig.EntityExtended?this._removeEntity(e):e instanceof ig.BackgroundMap&&(this.numBackgroundMaps=Math.max(0,this.numBackgroundMaps-1)),this.autoSort&&this.sort())))},_addEntity:function(e){this.numEntities++,(e.type!==ig.Entity.TYPE.NONE||e.checkAgainst!==ig.EntityExtended.TYPE.NONE||e.collides!==ig.EntityExtended.COLLIDES.NEVER||e.collidesChanges)&&this.itemsChecking.push(e)},_removeEntity:function(e){this.numEntities=Math.max(0,this.numEntities-1);var t=this.itemsChecking.length;i.arrayCautiousRemove(this.itemsChecking,e),this.itemsChecking.length!==t&&0===this.itemsChecking.length&&(this.spatialHash={})},pause:function(){if(!this.ignorePause){this.paused=!0;for(var e=this.items,i=0,t=e.length;i<t;i++){var s=e[i];s.pause&&s.pause()}}},unpause:function(){this.paused=!1;for(var e=this.items,i=0,t=e.length;i<t;i++){var s=e[i];s.unpause&&s.unpause()}},sort:function(){this._dirtySort=!0},update:function(){var e,i,t;if(this.changed=this.changedLights=!1,this._dirtySort&&(this.items.sort(this.sortBy),this._dirtySort=!1),!this.noUpdate&&this.items.length>0){for(this._dirtyItems&&(this.changed=!0,this._dirtyItems=!1),e=0,i=this.items.length;e<i;e++)t=this.items[e],t.update(),t.highPerformance||t.paused||!(t.changed||t.intersecting||t.checking)||(this.changed=!0,t instanceof ig.EntityLight&&(this.changedLights=!0));this.changed&&this.itemsChecking.length>0&&this.checkEntities()}},draw:function(){if(!this.noDraw&&this.items.length>0)for(var e=0,i=this.items.length;e<i;e++)this.items[e].draw()},checkEntities:function(){for(var e=this.spatialHash={},i=this.spatialHashCellSize,t=0,s=this.itemsChecking.length;t<s;t++){var n=this.itemsChecking[t];n.cleanupCollision();for(var a={},o=Math.floor(n.pos.x/i),r=Math.floor(n.pos.y/i),h=Math.floor((n.pos.x+n.size.x)/i)+1,l=Math.floor((n.pos.y+n.size.y)/i)+1,g=o;g<h;g++)for(var c=r;c<l;c++){var u=e[g];u||(u=e[g]={});var d=u[c];if(d){for(var m=0,p=d.length;m<p;m++){var f=d[m];a[f.id]||(a[f.id]=!0,n.touches(f)&&ig.EntityExtended.checkPair(n,f))}d.push(n)}else u[c]=[n]}}}})}),ig.baked=!0,ig.module("plusplus.core.input").requires("impact.input","plusplus.core.config","plusplus.helpers.utils","plusplus.helpers.utilsintersection").defines(function(){var e=ig.CONFIG,i=e.GESTURE,t=ig.utils,s=ig.utilsintersection;ig.Input.inject({inputPoints:[],initMouse:function(){this.parent(),ig.system.canvas.addEventListener("mouseout",this.keycancel.bind(this),!1),ig.system.canvas.addEventListener("mouseleave",this.keycancel.bind(this),!1),ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchcancel",this.keycancel.bind(this),!1),ig.system.canvas.addEventListener("MSPointerOut",this.keycancel.bind(this),!1),ig.system.canvas.addEventListener("MSPointerLeave",this.keycancel.bind(this),!1))},keydown:function(e){if("mousedown"==e.type||"touchstart"==e.type){var i;if(e.changedTouches)for(var t=0,s=e.changedTouches.length;t<s;t++)i=this.getInputPoint(e.changedTouches[t]),i.touch=!0,i.setDown();else i=this.getInputPoint(e),i.setDown()}this.parent(e)},keyup:function(e){if("mouseup"===e.type||"touchend"===e.type||"mouseout"===e.type||"mouseleave"===e.type||"touchcancel"===e.type){var i;if(e.changedTouches)for(var t=0,s=e.changedTouches.length;t<s;t++)i=this.getInputPoint(e.changedTouches[t]),i.setUp();else i=this.getInputPoint(e),i.setUp();this.mousemove(e,!0)}this.parent(e)},keycancel:function(e){var i=this.bindings[2===e.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1];i&&this.actions[i]&&this.keyup(e)},mousemove:function(e){var i,t=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,s=ig.system.scale*(t/ig.system.realWidth);if(ig.system.canvas.getBoundingClientRect&&(i=ig.system.canvas.getBoundingClientRect()),e.changedTouches)for(var n=0,a=e.changedTouches.length;n<a;n++)this.inputPointMove(e.changedTouches[n],s,i);else this.inputPointMove(e,s,i);var o=this.inputPoints[0];ig.input.mouse.x=o.x,ig.input.mouse.y=o.y},inputPointMove:function(e,i,t){var s=e.clientX,n=e.clientY;t&&(s-=t.left,n-=t.top),s/=i,n/=i,this.getInputPoint(e,s,n).reposition(s,n)},getInputPointId:function(e){if("string"==typeof e)return e;if(e){if("string"==typeof e.identifier)return e.identifier;if(e.properties&&e.values)return t.indexOfProperties(this.inputPoints,e.properties,e.values)}return 0},getInputPoint:function(e){var i=this.getInputPointId(e),t=this.inputPoints[i];return t||(t=this.inputPoints[i]=new ig.InputPoint(0,0,i)),t},getInputPoints:function(e,i){for(var t=[],s=0,n=this.inputPoints.length;s<n;s++){for(var a,o=this.inputPoints[s],r=0,h=e.length;r<h;r++)if(i[r]!==o[e[r]]){a=!0;break}!0!==a&&t.push(o)}return t},removeInputPoint:function(e){var i=this.getInputPointId(e),t=this.inputPoints[i];t&&(t.setUp(),this.inputPoints.splice(i,1))},inputPressed:function(e){var i=this.bindings[e];i&&(this.actions[i]=!0,this.locks[i]||(this.presses[i]=!0,this.locks[i]=!0))},inputReleased:function(e){var i=this.bindings[e];i&&(this.delayedKeyup[i]=!0)},update:function(){for(var e=0,i=this.inputPoints.length;e<i;e++)this.inputPoints[e].update()}}),ig.InputPoint=ig.Class.extend({id:0,x:0,y:0,lastX:0,lastY:0,worldX:0,worldY:0,deltaX:0,deltaY:0,directionX:0,directionY:0,downDeltaX:0,downDeltaY:0,swipeDistanceX:0,swipeDistanceY:0,swipeTotalDeltaX:0,swipeTotalDeltaY:0,duration:0,targets:null,targetsUp:null,targetsDown:null,targetsDownStart:null,down:!1,tapped:!1,holding:!1,holdingActivate:!1,moved:!1,swipingX:!1,swipingY:!1,swipingLeft:!1,swipingRight:!1,swipingUp:!1,swipingDown:!1,_taps:0,_downTotalDeltaX:0,_downTotalDeltaY:0,_directionDeltaTotalX:0,_directionDeltaTotalY:0,_durationReleased:0,_durationSwipeTry:0,_unpositioned:!0,_movedWithReposition:!1,_holdingActivatable:!0,_downLast:!1,_blockTap:!1,init:function(e,i,t){this.x=e||0,this.y=i||0,this.id=t||0,this.targets=[],this.targetsUp=[],this.targetsDown=[],this.targetsDownStart=[],this.lastX=this.x,this.lastY=this.y,this.worldX=this.x+ig.game.screen.x,this.worldY=this.y+ig.game.screen.y},reset:function(){this._unpositioned=!0,this.lastX=this.x,this.lastY=this.y,this.worldX=this.x+ig.game.screen.x,this.worldY=this.y+ig.game.screen.y,this._taps=this._durationReleased=this.deltaX=this.deltaY=this.directionX=this.directionY=this._directionDeltaTotalX=this._directionDeltaTotalY=0,this.moved=this._movedWithReposition=!1,this.resetTargets(),this.resetDown()},resetTargets:function(){this.targets.length=this.targetsUp.length=this.targetsDown.length=this.targetsDownStart.length=0},resetDown:function(){!1!==this.down&&(this.holding&&ig.input.inputReleased(ig.KEY.HOLD),this.duration=this.downDeltaX=this.downDeltaY=this._downTotalDeltaX=this._downTotalDeltaY=0,this.down=this._downLast=this.holding=this._blockTap=this.holdingActivate=!1,this._holdingActivatable=!0,this.resetSwipe())},resetSwipe:function(){!1!==this.swiping&&(ig.input.inputReleased(ig.KEY.SWIPE),this.releaseSwipeX(),this.releaseSwipeY(),this.swiping=!1,this.resetSwipeValues())},resetSwipeValues:function(){this._durationSwipeTry=this.swipeDistanceX=this.swipeDistanceY=this.swipeTotalDeltaX=this.swipeTotalDeltaY=0},releaseSwipeX:function(){this.swipingX&&(ig.input.inputReleased(ig.KEY.SWIPE_X),this.swipingLeft?(ig.input.inputReleased(ig.KEY.SWIPE_LEFT),this.swipingLeft=!1):this.swipingRight&&(ig.input.inputReleased(ig.KEY.SWIPE_RIGHT),this.swipingRight=!1),this.swipingX=!1)},releaseSwipeY:function(){this.swipingY&&(ig.input.inputReleased(ig.KEY.SWIPE_Y),this.swipingUp?(ig.input.inputReleased(ig.KEY.SWIPE_UP),this.swipingUp=!1):this.swipingDown&&(ig.input.inputReleased(ig.KEY.SWIPE_DOWN),this.swipingDown=!1),this.swipingY=!1)},setDown:function(){this.resetDown(),this.down=!0},setUp:function(){this.down&&(this._blockTap?(this._taps=0,this.tapped=!1):(this.tapped=!0,this._taps++,this._durationReleased=0,ig.input.inputReleased(ig.KEY.TAP),2===this._taps&&this._downTotalDeltaX*this._downTotalDeltaX+this._downTotalDeltaY*this._downTotalDeltaY<=this.screenSize*this.screenSize*i.TAP_MULTI_DISTANCE_PCT&&(this._taps=0,ig.input.inputReleased(ig.KEY.TAP_DOUBLE)),i.TARGET_TAP&&(i.TARGET_DOWN_START?this.targets=this.targetsDownStart:this.targets=this.getTargets())),this.resetDown())},getTargets:function(){var e=i.TARGET_SEARCH_RADIUS/ig.system.scale;return s.entitiesInAABB(this.worldX-e,this.worldY-e,this.worldX+e,this.worldY+e,!0)},reposition:function(e,t){var s,n;if(this.screenSize=Math.min(ig.system.width,ig.system.height),this._unpositioned)this.x=e,this.y=t,this._unpositioned=!1;else{if(this.deltaX=e-this.x,this.deltaY=t-this.y,0!==this.deltaX){var a=this.deltaX<0?-1:1;this.directionX!==a&&(this._directionDeltaTotalX+=this.deltaX*a,this._directionDeltaTotalX>=this.screenSize*i.DIRECTION_SWITCH_PCT&&(s=!0,this._directionDeltaTotalX=0,this.directionX=a))}if(0!==this.deltaY){var o=this.deltaY<0?-1:1;this.directionY!==o&&(this._directionDeltaTotalY+=this.deltaY*o,this._directionDeltaTotalY>=this.screenSize*i.DIRECTION_SWITCH_PCT&&(n=!0,this._directionDeltaTotalY=0,this.directionY=o))}this._movedWithReposition=0!==this.deltaX||0!==this.deltaY,this.x=e,this.y=t}this.worldX=this.x+ig.game.screen.x,this.worldY=this.y+ig.game.screen.y,i.TARGET_UP&&(this.targetsUp=this.getTargets()),this.down&&(i.TARGET_DOWN&&(i.TARGET_UP?this.targetsDown=this.targetsUp:this.targetsDown=this.getTargets()),this._downLast!==this.down&&(this._downLast=this.down,i.TARGET_DOWN_START&&(i.TARGET_DOWN?this.targetsDownStart=this.targetsDown:i.TARGET_UP?this.targetsDownStart=this.targetsUp:this.targetsDownStart=this.getTargets())),this.downDeltaX=this.deltaX,this.downDeltaY=this.deltaY,this._downTotalDeltaX+=this.downDeltaX,this._downTotalDeltaY+=this.downDeltaY,this._holdingActivatable&&this._downTotalDeltaX*this._downTotalDeltaX+this._downTotalDeltaY*this._downTotalDeltaY>=this.screenSize*this.screenSize*i.HOLD_ACTIVATE_DISTANCE_PCT&&(this._holdingActivatable=!1),this.swipeTotalDeltaX+=this.downDeltaX,this.swipeTotalDeltaY+=this.downDeltaY,this.swipeDistanceX=this.swipeTotalDeltaX<0?-this.swipeTotalDeltaX:this.swipeTotalDeltaX,this.swipeDistanceY=this.swipeTotalDeltaY<0?-this.swipeTotalDeltaY:this.swipeTotalDeltaY,!0!==this.swiping&&this._durationSwipeTry>i.SWIPE_DURATION_TRY?this.resetSwipeValues():(!0!==this.swipingX&&this.swipeDistanceX>=this.screenSize*i.SWIPE_DISTANCE_PCT&&(this.swiping=this._blockTap=!0,this._holdingActivatable=!1,ig.input.inputPressed(ig.KEY.SWIPE),this.swipingX=s=!0,ig.input.inputPressed(ig.KEY.SWIPE_X)),this.swipingX&&s&&(-1===this.directionX?(this.swipingRight&&(this.swipingRight=!1,ig.input.inputReleased(ig.KEY.SWIPE_RIGHT)),this.swipingLeft=!0,ig.input.inputPressed(ig.KEY.SWIPE_LEFT)):1===this.directionX&&(this.swipingLeft&&(this.swipingLeft=!1,ig.input.inputReleased(ig.KEY.SWIPE_LEFT)),this.swipingRight=!0,ig.input.inputPressed(ig.KEY.SWIPE_RIGHT))),!0!==this.swipingY&&this.swipeDistanceY>=this.screenSize*i.SWIPE_DISTANCE_PCT&&(this.swiping=this._blockTap=!0,this._holdingActivatable=!1,ig.input.inputPressed(ig.KEY.SWIPE),this.swipingY=n=!0,ig.input.inputPressed(ig.KEY.SWIPE_Y)),this.swipingY&&n&&(-1===this.directionY?(this.swipingDown&&(this.swipingDown=!1,ig.input.inputReleased(ig.KEY.SWIPE_DOWN)),this.swipingUp=!0,ig.input.inputPressed(ig.KEY.SWIPE_UP)):1===this.directionY&&(this.swipingUp&&(this.swipingUp=!1,ig.input.inputReleased(ig.KEY.SWIPE_UP)),this.swipingDown=!0,ig.input.inputPressed(ig.KEY.SWIPE_DOWN)))))},update:function(){this.moved=this.x-this.lastX!=0||this.y-this.lastY!=0,this.lastX=this.x,this.lastY=this.y,this.worldX=this.x+ig.game.screen.x,this.worldY=this.y+ig.game.screen.y,this.down?(this.duration+=ig.system.tick,this._durationSwipeTry+=ig.system.tick,!this.holding&&this.duration>=i.HOLD_DELAY&&(this.holding=!0,ig.input.inputPressed(ig.KEY.HOLD)),!this._blockTap&&this.duration>=i.HOLD_DELAY_BLOCK_TAP&&(this._blockTap=!0),this._holdingActivatable&&!this.holdingActivate&&this.duration>=i.HOLD_DELAY_ACTIVATE&&(this.holdingActivate=!0,ig.input.inputPressed(ig.KEY.HOLD_ACTIVATE)),!this.moved&&this._durationSwipeTry>i.SWIPE_DURATION_RESET&&this.resetSwipe()):this._taps>0&&(this._durationReleased+=ig.system.tick,this._durationReleased>=i.RELEASE_DELAY&&(this.touch?ig.input.removeInputPoint(this.id):this._taps=0))}}),ig.KEY.TAP=-6,ig.KEY.TAP_DOUBLE=-7,ig.KEY.HOLD=-9,ig.KEY.HOLD_ACTIVATE=-10,ig.KEY.SWIPE=-11,ig.KEY.SWIPE_X=-12,ig.KEY.SWIPE_Y=-13,ig.KEY.SWIPE_LEFT=-14,ig.KEY.SWIPE_RIGHT=-15,ig.KEY.SWIPE_UP=-16,ig.KEY.SWIPE_DOWN=-17}),ig.baked=!0,ig.module("plusplus.ui.ui-element").requires("plusplus.core.config","plusplus.core.entity","plusplus.helpers.signals","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils;ig.UIElement=ig.global.UIElement=ig.EntityExtended.extend({layerName:"ui",frozen:!0,visible:!0,fixed:!0,canFlipX:e.UI.CAN_FLIP_X,canFlipY:e.UI.CAN_FLIP_Y,posAsPct:e.UI.POS_AS_PCT,posPct:{x:0,y:0},align:{x:0,y:0},margin:{x:0,y:0},marginAsPct:!0,marginAsPctSmallest:e.UI.MARGIN_AS_PCT_SMALLEST,marginScaleless:e.UI.MARGIN_SCALELESS,totalMarginX:0,totalMarginY:0,scale:e.UI.SCALE,scaleOfSystemScale:e.UI.SCALE_OF_SYSTEM_SCALE,scaleMin:e.UI.SCALE_MIN,scaleMax:e.UI.SCALE_MAX,ignoreSystemScale:e.UI.IGNORE_SYSTEM_SCALE,linkAlign:{x:0,y:0},linkAlignInside:!1,autoDeactivate:!0,initTypes:function(){this.parent(),i.addType(ig.EntityExtended,this,"type","UI")},changePerformanceDynamic:function(){"ui"===this.layerName&&(ig.game.removeItem(this,{layerName:this.layerName}),this.layerName="entities",ig.game.addItem(this))},cleanup:function(){this.autoDeactivate&&this.deactivate(),this.parent()},reposition:function(e){var i=this.linkAlignInside?-1:1;if(!this.getIsMovingSelf()){if(this.linkedTo){var t=this.scale/ig.system.scale,s=this.sizeDraw.x*t,n=this.sizeDraw.y*t,a=this.linkedTo.scale/ig.system.scale,o=this.linkedTo.sizeDraw.x*a,r=this.linkedTo.sizeDraw.y*a,h=.5*(o-s),l=.5*(r-n);this.pos.x=this.linkedTo.posDraw.x+h,this.pos.y=this.linkedTo.posDraw.y+l;var g=.5*(o+s*i),c=.5*(r+n*i);this.pos.x+=this.linkAlign.x*g,this.pos.y+=this.linkAlign.y*c}else this.posAsPct?(this.pos.x=this.posPct.x*ig.system.width,this.pos.y=this.posPct.y*ig.system.height):(this.pos.x=this.resetState.pos.x,this.pos.y=this.resetState.pos.y);this.totalMarginX=Math.round(this.marginAsPct?this.margin.x*(this.marginAsPctSmallest?ig.system.size:ig.system.width):this.margin.x),this.totalMarginY=Math.round(this.marginAsPct?this.margin.y*(this.marginAsPctSmallest?ig.system.size:ig.system.height):this.margin.y),this.marginScaleless&&(this.totalMarginX/=this.scale,this.totalMarginY/=this.scale),this.linkedTo?(this.pos.x+=this.linkAlign.x*this.totalMarginX*i,this.pos.y+=this.linkAlign.y*this.totalMarginY*i):(this.pos.x=this.pos.x-this.align.x*this.sizeDraw.x*this.scaleMod+((1-this.align.x)*this.totalMarginX-this.align.x*this.totalMarginX),this.pos.y=this.pos.y-this.align.y*this.sizeDraw.y*this.scaleMod+((1-this.align.y)*this.totalMarginY-this.align.y*this.totalMarginY))}return this.parent(e)},moveTo:function(e,i){return this.align.x=this.align.y=this.margin.x=this.margin.y=0,this.unlink(!1),this.parent(e,i)},link:function(e,i){this.movingTo?this.unlink(!1):this.parent(e,i)},unlink:function(e){if(this.linkedTo&&!this._killed&&!1!==e){var i=this.pos.x,t=this.pos.y;i+=this.align.x*this.sizeDraw.x*this.scaleMod-((1-this.align.x)*this.totalMarginX-this.align.x*this.totalMarginX),t+=this.align.y*this.sizeDraw.y*this.scaleMod-((1-this.align.y)*this.totalMarginY-this.align.y*this.totalMarginY),this.posAsPct?(this.posPct.x=i/ig.system.width,this.posPct.y=t/ig.system.height):(this.resetState.pos.x=i,this.resetState.pos.y=t)}this.parent(e)}}),i.getType(ig.EntityExtended,"UI"),ig.EntityExtended.TYPE.UI}),ig.baked=!0,ig.module("plusplus.ui.ui-text").requires("plusplus.core.config","plusplus.core.font","plusplus.core.image-drawing","plusplus.ui.ui-element").defines(function(){"use strict";var e=ig.CONFIG;ig.UIText=ig.global.UIText=ig.UIElement.extend({align:{x:0,y:0},linkAlign:{x:0,y:0},font:null,scale:e.FONT.SCALE,scaleOfSystemScale:e.FONT.SCALE_OF_SYSTEM_SCALE,scaleMin:e.FONT.SCALE_MIN,scaleMax:e.FONT.SCALE_MAX,ignoreSystemScale:e.FONT.IGNORE_SYSTEM_SCALE,text:"",textDisplay:"",textOverflow:"",autoRefreshText:!0,changedText:!1,textImage:null,textAlign:ig.Font.ALIGN.CENTER,maxWidth:0,maxHeight:0,_text:"",refresh:function(e){this.font=this.font||ig.Font.FONTS.MAIN,this.text&&this.font?this.textImage||(this.textImage=new ig.ImageDrawing):this.textImage&&(this.textImage=null),this.parent(e)},resize:function(e){if(this._text!==this.text&&(this.changedText=!0,this._text=this.text),this._text&&this.font){var i=this._text,t="",s=this.font.widthForString(i),n=this.font.heightForString(i);if(this.maxWidth>0&&s>this.maxWidth&&(i=this.font.multilineForWidth(i,this.maxWidth),s=this.font.widthForString(i),n=this.font.heightForString(i)),this.maxHeight>0&&n>this.maxHeight){var a=this.font.overflowForHeight(i,this.maxHeight);i=a.display,t=a.overflow,s=this.font.widthForString(i),n=this.font.heightForString(i)}this.textDisplay===i&&this.textOverflow===t||(this.needsRebuild=this.changedText=!0,this.textDisplay=i,this.textOverflow=t),this.size.x!==s&&(this.size.x=s,e=this.needsRebuild=this.changedText=!0),this.size.y!==n&&(this.size.y=n,e=this.needsRebuild=this.changedText=!0)}return e},rebuild:function(){if(this.parent(),this.textDisplay&&this.font){this.textImage.setDimensions(this.size.x,this.size.y);var e;e=this.textAlign===ig.Font.ALIGN.CENTER?.5*this.size.x:this.textAlign===ig.Font.ALIGN.RIGHT?this.size.x:0,this.font.draw(this.textDisplay,e,0,this.textAlign,this.textImage.dataContext,1),this.textImage.finalize()}},update:function(){this.autoRefreshText&&this._text!==this.text?this.refresh(!0):this.changedText=!1,this.parent()},draw:function(){this.parent(),this.visible&&this.textImage&&(1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha),this.fixed?this.textImage.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):this.textImage.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale),1!==this.alpha&&(ig.system.context.globalAlpha=1))}})}),ig.baked=!0,ig.module("plusplus.ui.ui-overlay").requires("plusplus.core.font","plusplus.core.config","plusplus.core.image-drawing","plusplus.ui.ui-element","plusplus.ui.ui-text","plusplus.helpers.utilsdraw","plusplus.helpers.utilscolor").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utilsdraw,t=ig.utilscolor;ig.UIOverlay=ig.global.UIOverlay=ig.UIElement.extend({layerName:"overlay",zIndex:e.Z_INDEX_BELOW_ALL,scaleMin:e.ENTITY.SCALE_MIN,scaleMax:e.ENTITY.SCALE_MAX,scaleOfSystemScale:e.ENTITY.SCALE_OF_SYSTEM_SCALE,ignoreSystemScale:!1,sizeAsPct:!0,sizePct:{x:1,y:1},fill:null,filled:!0,r:e.OVERLAY.R,g:e.OVERLAY.G,b:e.OVERLAY.B,alpha:e.OVERLAY.ALPHA,fillStyle:"",fillColors:null,gradientRadial:!1,gradientHorizontal:!1,cover:!1,cornerRadius:0,cornerRadiusAsPct:!1,pixelPerfect:e.OVERLAY.PIXEL_PERFECT,message:null,messageEntity:ig.UIText,textSettings:null,textMoveToSettings:{matchPerformance:!0},resetExtras:function(){this.filled?this.fill=new ig.ImageDrawing:this.fill=null,"string"==typeof this.text&&(this.textSettings=this.textSettings||{},this.textSettings.text=this.text,this.text=void 0),"string"==typeof this.message&&(this.textSettings=this.textSettings||{},this.textSettings.text=this.message,this.message=void 0),!this.message&&this.textSettings&&this.textSettings.text&&this.textSettings.text.length>0&&(this.message=new this.messageEntity(0,0,ig.merge({layerName:this.layerName,fixed:this.fixed,alpha:this.alpha,linkedTo:this,autoRefreshText:!1},this.textSettings))),this.parent()},resize:function(e){if(this.sizeAsPct){var i=ig.system.width*this.sizePct.x,t=ig.system.height*this.sizePct.y;this.size.x!==i&&(this.size.x=i,e=this.needsRebuild=!0),this.size.y!==t&&(this.size.y=t,e=this.needsRebuild=!0)}return e},rebuild:function(){this.refill(),this.fill&&this.fill.finalize(this.pixelPerfect?1:this.scale),this.parent()},refill:function(e,t){if(this.fill){void 0===e&&(e=this.sizeDraw.x),void 0===t&&(t=this.sizeDraw.y);var s=this.fill.dataContext;this.pixelPerfect?(this.fill.setDimensions(this.sizeDraw.x,this.sizeDraw.y),this.cornerRadius>0?i.pixelFillRoundedRect(s,0,0,this.fill.width,this.fill.height,0,0,e,t,this.cornerRadiusAsPct?Math.min(e,t)*this.cornerRadius:this.cornerRadius,this.r,this.g,this.b,1):(s.fillStyle=this.getFillStyle(),s.fillRect(0,0,e,t))):(this.fill.setDimensions(this.sizeDraw.x*this.scale,this.sizeDraw.y*this.scale),s.fillStyle=this.getFillStyle(),e*=this.scale,t*=this.scale,this.cornerRadius>0?i.fillRoundedRect(s,0,0,e,t,this.cornerRadiusAsPct?Math.min(e,t)*this.cornerRadius:this.cornerRadius):s.fillRect(0,0,e,t))}},getFillStyle:function(){var e;return this.pixelPerfect||(this.fillStyle?e=this.fillStyle:this.fillColors&&(e=this.gradientRadial?t.radialGradient(this.cover?Math.max(this.sizeDraw.x,this.sizeDraw.y):Math.min(this.sizeDraw.x,this.sizeDraw.y),this.fillColors):this.gradientHorizontal?t.linearGradient(0,0,this.sizeDraw.x,0,this.fillColors):t.linearGradient(0,0,0,this.sizeDraw.y,this.fillColors))),e||(e=t.RGBToCSS(this.r,this.g,this.b)),e},ready:function(){this.message&&ig.game.spawnEntity(this.message,this.message.pos.x,this.message.pos.y),this.parent()},moveTo:function(e,i){var t=this.parent(e,i);return this.message&&this.message.moveTo(this,this.textMoveToSettings),t},moveToStop:function(){this.message&&this.message.moveToStop(),this.parent()},pause:function(){this.parent(),this.message&&this.message.pause()},unpause:function(){this.parent(),this.message&&this.message.unpause()},cleanup:function(){this.message&&ig.game.removeEntity(this.message),this.parent()},update:function(){if(this.message){var e=this.textSettings&&this.textSettings.text||this.text;e&&this.message.text!==e&&(this.message.text=e),this.message._text!==this.message.text&&this.refresh(!0)}this.parent()},draw:function(){this.message&&(this.message.alpha=this.alpha),this.visible&&(this.fill&&(1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha),this.fixed?this.fill.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):this.fill.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale),1!==this.alpha&&(ig.system.context.globalAlpha=1)),this.parent())}})}),ig.baked=!0,ig.module("plusplus.core.camera").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.image-drawing","plusplus.ui.ui-overlay","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.signals","plusplus.helpers.tweens").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils,t=ig.utilsmath,s=ig.utilsvector2,n=ig.utilsintersection,a=ig.TWEEN;ig.Camera=ig.Class.extend({boundsTrapAsPct:e.CAMERA.BOUNDS_TRAP_AS_PCT,boundsTrap:n.boundsMinMax(e.CAMERA.BOUNDS_TRAP_MINX,e.CAMERA.BOUNDS_TRAP_MINY,e.CAMERA.BOUNDS_TRAP_MAXX,e.CAMERA.BOUNDS_TRAP_MAXY),boundsTrapPct:n.boundsMinMax(e.CAMERA.BOUNDS_TRAP_PCT_MINX,e.CAMERA.BOUNDS_TRAP_PCT_MINY,e.CAMERA.BOUNDS_TRAP_PCT_MAXX,e.CAMERA.BOUNDS_TRAP_PCT_MAXY),keepCentered:e.CAMERA.KEEP_CENTERED,keepInsideLevel:{x:e.CAMERA.KEEP_INSIDE_LEVEL,y:e.CAMERA.KEEP_INSIDE_LEVEL},boundsLevel:n.boundsMinMax(0,0,0,0),paused:!1,changed:!1,entity:null,entityFallback:null,autoFollowPlayer:e.CAMERA.AUTO_FOLLOW_PLAYER,snapFirstFollow:e.CAMERA.SNAP_FIRST_FOLLOW,centerFirstFollow:e.CAMERA.CENTER_FIRST_FOLLOW,lerp:e.CAMERA.LERP,transitionDuration:e.CAMERA.TRANSITION_DURATION,transitionDurationMin:e.CAMERA.TRANSITION_DURATION_MIN,transitionDurationMax:e.CAMERA.TRANSITION_DURATION_MAX,transitionDistance:e.CAMERA.TRANSITION_DISTANCE,transitioning:!1,transitioningInstantly:!1,transitioningCenter:!1,transitionPct:0,
screenLast:{x:0,y:0},atmosphere:!1,atmosphereOverlay:null,atmosphereSettings:{r:0,g:0,b:0,alpha:.9},atmosphereFadeDuration:1e3,lightAmplification:3,lightBaseOnly:!0,lightsCutout:!0,onTransitioned:null,shaking:!1,shakeStrength:8,shakeDuration:2,shakeFunction:!1,shakeOffset:null,shakeTimer:null,_transitionTime:0,_transitionDuration:0,_transitionFrom:{x:0,y:0},_snap:!0,_center:!0,_entityInvulnerable:!1,_entityPaused:!1,_entityAlpha:1,_boundsScreen:n.boundsMinMax(0,0,0,0),_rLast:0,_gLast:0,_bLast:0,_alphaLast:0,init:function(e){ig.merge(this,e),this._snap=this.snapFirstFollow,this._center=this.centerFirstFollow,this.onTransitioned=new ig.Signal,this.shakeTimer=new ig.Timer,ig.system.onResized.add(this.resize,this,-1)},reset:function(){this.screenLast.x=ig.game.screen.x=0,this.screenLast.y=ig.game.screen.y=0,this.shakeStop(),this.removeAtmosphere(0),this.unfollow(),this.unfollowFallback(),this.onTransitioned.removeAll(),this.onTransitioned.forget(),this._snap=this.snapFirstFollow,this._center=this.centerFirstFollow},ready:function(){this.getBoundsLevel(),this.autoFollowPlayer&&this.followPlayer()},pause:function(){this.paused=!0,this.shakeTimer.pause()},unpause:function(){this.paused=!1,this.shakeTimer.unpause()},getBoundsLevel:function(e){e=void 0!==e?e:ig.game.collisionMap,(this.keepInsideLevel.x||this.keepInsideLevel.y)&&e&&e.width&&e.height&&e.tilesize&&(this.boundsLevel=n.boundsMinMax(0,0,e.width*e.tilesize-ig.system.width,e.height*e.tilesize-ig.system.height,this.boundsLevel),this.boundsLevel.maxX<0&&(this.boundsLevel.minX=this.boundsLevel.maxX=.5*this.boundsLevel.maxX),this.boundsLevel.maxY<0&&(this.boundsLevel.minY=this.boundsLevel.maxY=.5*this.boundsLevel.maxY))},shake:function(e,i,t){this.shaking||(this.shaking=!0,this.shakeDuration=e||this.shakeDuration,this.shakeStrength=i||this.shakeStrength,this.shakeFunction=t||this.shakeFunction,this.shakeOffset?s.zero(this.shakeOffset):this.shakeOffset={x:0,y:0},this.shakeTimer.set(this.shakeDuration))},shakeStop:function(){this.shaking&&(this.shaking=!1,ig.game.screen.x-=this.shakeOffset.x,ig.game.screen.y-=this.shakeOffset.y)},updateShake:function(){if(this.shaking){ig.game.screen.x-=this.shakeOffset.x,ig.game.screen.y-=this.shakeOffset.y;var e=this.shakeTimer.delta();if(e>=0)this.shakeStop();else{var i=-e/this.shakeDuration,n=this.shakeFunction?this.shakeFunction():this.shakeStrength*Math.pow(i,2);n>.5&&(this.shakeOffset.x+=t.map(Math.random(),0,1,-n,n),this.shakeOffset.y+=t.map(Math.random(),0,1,-n,n)),s.multiplyScalar(this.shakeOffset,i)}}},toggleAtmosphere:function(e,i){this.atmosphere?this.removeAtmosphere(e):this.addAtmosphere(e,i)},addAtmosphere:function(e,t){this.atmosphere&&!t||(this.atmosphere&&this.removeAtmosphere(e),this.atmosphere=!0,this.atmosphereFadeDuration=i.isNumber(e)?e:this.atmosphereFadeDuration,this.atmosphereOverlay=ig.game.spawnEntity(ig.UIOverlay,0,0,t?ig.merge(ig.merge({},this.atmosphereSettings),t):this.atmosphereSettings),this.atmosphereOverlay.added?this._showAtmosphere():this.atmosphereOverlay.onAdded.addOnce(this._showAtmosphere,this))},_showAtmosphere:function(){this.atmosphereOverlay&&(this.atmosphereOverlay.alpha=0,this.atmosphereOverlay.fadeTo(this.atmosphereOverlay.resetState.alpha,{duration:this.atmosphereFadeDuration}),this.changed=!0,this.updateAtmosphere())},removeAtmosphere:function(e){this.atmosphere=!1,this.atmosphereOverlay&&(this.atmosphereOverlay.added?this.atmosphereOverlay.fadeToDeath({duration:i.isNumber(e)?e:this.atmosphereFadeDuration}):(this.atmosphereOverlay.onAdded.remove(this._showAtmosphere,this),ig.game.removeEntity(this.atmosphereOverlay)),this.atmosphereOverlay=void 0)},updateAtmosphere:function(){if(this.atmosphere&&(this.changed||this.lightsCutout&&(ig.game.dirtyLights||ig.game.changedLights))){this.atmosphereOverlay.refresh(!0);var e=this.atmosphereOverlay.fill.dataContext;if(this.lightsCutout){e.globalCompositeOperation="destination-out";var i,t,s=ig.game.lights;for(i=0,t=s.length;i<t;i++){var n=s[i];n.visible&&n.image&&(e.globalAlpha=Math.min(1,n.alpha*this.lightAmplification),e.drawImage(this.lightBaseOnly&&n.castsShadows?n.imageBase.data:n.image.data,ig.system.getDrawPos(n.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(n.posDraw.y-ig.game.screen.y)))}e.globalCompositeOperation="source-over"}}},follow:function(e,i,t){i=i||this._snap,t=t||this._center,(this.entity!==e||i||t)&&(this._snap=this._center=!1,this.unfollow(),this.entity=e,this.entity&&(this.transitioning=!0,this.transitioningInstantly=i,this.transitioningCenter=t,this._transitionTime=0,s.copy(this._transitionFrom,ig.game.screen),this.transitioningCenter?n.bounds(ig.game.screen.x,ig.game.screen.y,0,0,this._boundsScreen):n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y))),this.transitioning?this.transitioningInstantly&&this.updateFollow():this.entity&&this.transitionComplete()},followFallback:function(e,i,t){this.entityFallback!==e&&(this.entityFallback=e,this.entity||this.follow(this.entityFallback,i,t))},followRespawnable:function(e){this.followFallback(e),this.transitioning&&(e.invulnerable||(e.invulnerable=this._entityInvulnerable=!0),e.paused||(this._entityPaused=!0,e.pause(),this._entityAlpha=e.alpha,e.alpha=0))},followPlayer:function(e,i){var t=ig.game.getPlayer();t&&(this.unfollow(),this.followFallback(t,e,i),t.onRemoved.add(this.unfollowFallback,this),t.onAdded.add(this.followRespawnable,this))},unfollow:function(){this.entity&&(this.entity=void 0),this.transitioning&&(this.transitioning=!1,this._transitionTime=0,n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y))},unfollowFallback:function(){this.entityFallback&&(this.entityFallback===this.entity&&this.unfollow(),this.entityFallback=void 0),this.transitioning&&(this.transitioning=!1,n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y))},transitionComplete:function(){this.transitioning=this.transitioningInstantly=this.transitioningCenter=!1,this._entityInvulnerable&&this.entity.invulnerable&&(this.entity.invulnerable=this._entityInvulnerable=!1),this._entityPaused&&this.entity.paused&&(this._entityPaused=!1,this.entity.unpause(),this.entity.alpha=this._entityAlpha),this.onTransitioned.dispatch()},updateFollow:function(){var e=ig.game.screen;if(!this.entity&&this.entityFallback&&this.follow(this.entityFallback),this.entity){s.copy(this.screenLast,e);var i,o,r=this.entity.pos.x+.5*this.entity.size.x-.5*ig.system.width,h=this.entity.pos.y+.5*this.entity.size.y-.5*ig.system.height;if(this.transitioning){if(this.changed=!0,this.transitioningInstantly)this.transitionPct=1;else{if(0===this._transitionTime)if(this.transitionDistance>0){var l=r-this._boundsScreen.minX,g=h-this._boundsScreen.minY,c=Math.sqrt(l*l+g*g);this._transitionDuration=t.clamp(this.transitionDuration*(c/this.transitionDistance),this.transitionDurationMin,this.transitionDurationMax)}else this._transitionDuration=this.transitionDuration;this._transitionTime+=ig.system.tick,this.transitionPct=this._transitionTime/this._transitionDuration}var u=a.Easing.Quadratic.InOut(this.transitionPct);r<this._boundsScreen.minX?e.x=this._transitionFrom.x+(r-(this._boundsScreen.minX+(this.transitioningCenter?.5*this._boundsScreen.width:0)))*u:r>this._boundsScreen.maxX?e.x=this._transitionFrom.x+(r-(this._boundsScreen.maxX-(this.transitioningCenter?.5*this._boundsScreen.width:0)))*u:i=!0,h<this._boundsScreen.minY?e.y=this._transitionFrom.y+(h-(this._boundsScreen.minY+(this.transitioningCenter?.5*this._boundsScreen.height:0)))*u:h>this._boundsScreen.maxY?e.y=this._transitionFrom.y+(h-(this._boundsScreen.maxY-(this.transitioningCenter?.5*this._boundsScreen.height:0)))*u:o=!0,(this.transitionPct>=1||i&&o)&&this.transitionComplete()}else this.keepCentered?(e.x+=(r-e.x)*this.lerp,e.y+=(h-e.y)*this.lerp):(r<this._boundsScreen.minX?e.x+=r-this._boundsScreen.minX:r>this._boundsScreen.maxX&&(e.x+=r-this._boundsScreen.maxX),h<this._boundsScreen.minY?e.y+=h-this._boundsScreen.minY:h>this._boundsScreen.maxY&&(e.y+=h-this._boundsScreen.maxY)),e.x-this.screenLast.x==0&&e.y-this.screenLast.y==0||(this.changed=!0)}this.changed&&(this.keepInsideLevel.x?this.screenLast.x=e.x=t.clamp(e.x,this.boundsLevel.minX,this.boundsLevel.maxX):this.screenLast.x=e.x,this.keepInsideLevel.y?this.screenLast.y=e.y=t.clamp(e.y,this.boundsLevel.minY,this.boundsLevel.maxY):this.screenLast.y=e.y,this.transitioning||n.boundsCopy(this._boundsScreen,this.boundsTrap,e.x,e.y)),this.shaking&&(e.x+=this.shakeOffset.x,e.y+=this.shakeOffset.y,this.changed=!0)},update:function(){this.changed=!1,this.paused||(this.updateShake(),this.updateFollow(),this.updateAtmosphere())},resize:function(){this.changed=!0,this.getBoundsLevel(),this.boundsTrapAsPct&&n.boundsCopy(this.boundsTrap,this.boundsTrapPct,0,0,.5*ig.system.width,.5*ig.system.height),this.entity&&this.follow(this.entity,!0,!0),this.updateAtmosphere()}})}),ig.baked=!0,ig.module("plusplus.core.player-manager").requires("plusplus.core.config","plusplus.core.entity","plusplus.helpers.utils","plusplus.helpers.utilsmath").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils,t=ig.utilsmath;ig.PlayerManager=ig.global.PlayerManager=ig.Class.extend({autoManagePlayer:e.PLAYER_MANAGER.AUTO_MANAGE_PLAYER,entity:null,entityFallback:null,zIndex:0,type:"",group:"",holdToMove:e.PLAYER_MANAGER.HOLD_TO_MOVE,swipeToJump:e.PLAYER_MANAGER.SWIPE_TO_JUMP,onManageStarted:null,onManageStopped:null,_zIndex:0,_type:ig.EntityExtended.TYPE.NONE,_group:ig.EntityExtended.GROUP.NONE,init:function(e){ig.merge(this,e),this.onManageStarted=new ig.Signal,this.onManageStopped=new ig.Signal},ready:function(){this.autoManagePlayer&&this.managePlayer()},reset:function(){this.onManageStarted.removeAll(),this.onManageStarted.forget(),this.onManageStopped.removeAll(),this.onManageStopped.forget(),this.manageReleaseFallback(),this.manageRelease()},manage:function(e){this.entity!==e&&(this.manageRelease(),e instanceof ig.EntityExtended&&this.manageStart(e))},manageFallback:function(e){this.entityFallback!==e&&(this.entityFallback=e,this.entity||this.manage(e))},managePlayer:function(){var e=ig.game.getPlayer();e&&this.entity!==e&&(this.manageRelease(),this.manageFallback(e),e.onRemoved.add(this.manageReleaseFallback,this),e.onAdded.add(this.managePlayer,this))},manageStart:function(e){this.entity=e,this.entity.onRemoved.addOnce(this.manageRelease,this),this.zIndex&&e.zIndex!==this.zIndex&&(this._zIndex=e.zIndex,e.zIndex=this.zIndex,ig.game.sortEntitiesDeferred(e.layerName)),this.type&&(this._type=e.type,i.addType(ig.EntityExtended,e,"type",this.type)),this.group&&(this._group=e.group,i.addType(ig.EntityExtended,e,"group",this.group,"GROUP")),ig.game.camera&&ig.game.camera.autoFollowPlayer&&ig.game.camera.entity!==e?(e===ig.game.getPlayer()?ig.game.camera.followPlayer():ig.game.camera.follow(e),ig.game.camera.onTransitioned.addOnce(this.highlightManaged,this)):this.highlightManaged(),"function"==typeof e.manageStart&&e.manageStart(),this.onManageStarted.dispatch(e)},manageRelease:function(e){(!e&&this.entity||e&&this.entity===e)&&this.manageStop()},manageReleaseFallback:function(e){(!e&&this.entityFallback||e&&this.entityFallback===e)&&(this.entity===this.entityFallback&&this.manageRelease(),this.entityFallback=null)},manageStop:function(){var e=this.entity;ig.game.camera&&ig.game.camera.onTransitioned.remove(this.highlightManaged,this),e.onRemoved.remove(this.manageRelease,this),this.zIndex&&e.zIndex!==this._zIndex&&(e.zIndex=this._zIndex,ig.game.sortEntitiesDeferred(e.layerName)),this.type&&(e.type=this._type),this.group&&(e.group=this._group),this.entity=null,"function"==typeof e.manageStop&&e.manageStop(),this.onManageStopped.dispatch(e)},highlightManaged:function(){this.entity&&!this.entity._killed&&this.entity.currentAnim==this.entity.anims[this.entity.getDirectionalAnimName("idle")]&&this.entity.animOverride(this.entity.getDirectionalAnimName("highlight"))},update:function(){!this.entity&&this.entityFallback&&this.manage(this.entityFallback),this.isManagedControllable()&&this.handleInput()},isManagedControllable:function(){return this.entity&&!this.entity.paused&&this.entity.controllable},handleInput:function(){var e,i,s,n;if(this.entity.movingTo||(this.entity.jumping?this.entity.moveToHereHorizontal():this.entity.moveToHere()),this.entity.handleInput&&this.entity.handleInput(),ig.input.state("right")?this.entity.moveToRight():ig.input.state("left")&&this.entity.moveToLeft(),ig.input.state("up")?this.entity.hasGravity?this.entity.climbUp():this.entity.moveToUp():ig.input.state("down")&&(this.entity.hasGravity?this.entity.climbDown():this.entity.moveToDown()),this.holdToMove&&ig.input.state("hold"))for(s=ig.input.getInputPoints(["holding"],[!0]),e=0,i=s.length;e<i;e++)if(n=s[e],!n.targetsDownStart.length){var a=.5*this.entity.size.x,o=.5*this.entity.size.y,r=n.worldX-this.entity.pos.x+a,h=n.worldY-this.entity.pos.y+o;!0!==t.almostEqual(r,0,a)&&(r>0?this.entity.moveToRight():this.entity.moveToLeft()),!0!==t.almostEqual(h,0,o)&&(h>0?this.entity.hasGravity?this.entity.climbDown():this.entity.moveToDown():this.entity.hasGravity?this.entity.climbUp():this.entity.moveToUp())}if(ig.input.pressed("jump"))this.entity.jump();else if(this.swipeToJump&&ig.input.state("swipe"))for(s=ig.input.getInputPoints(["swiping"],[!0]),e=0,i=s.length;e<i;e++)s[e].swipingUp&&this.entity.jump()}})}),ig.baked=!0,ig.module("plusplus.entities.trigger").requires("plusplus.core.timer","plusplus.core.entity","plusplus.helpers.utils","plusplus.helpers.signals").defines(function(){"use strict";var e=ig.utils;ig.EntityTrigger=ig.global.EntityTrigger=ig.EntityExtended.extend({_wmScalable:!0,_wmDrawBox:!0,_wmBoxColor:"rgba( 255, 255, 0, 0.7 )",frozen:!0,target:{},sortTargetsBy:null,targetSequence:[],wait:0,delay:0,triggerAfterDelay:!1,once:!0,suicidal:!0,triggerable:!0,useCheckingAsTarget:!1,triggering:!1,autoComplete:!0,autoToggle:!1,teardownWhenComplete:!0,waitTimer:null,delayTimer:null,onCompleted:null,_delaying:!1,initTypes:function(){this.parent(),e.addType(ig.EntityExtended,this,"type","TRIGGER"),e.addType(ig.EntityExtended,this,"checkAgainst","PLAYER")},initProperties:function(){this.parent(),this.waitTimer=new ig.Timer,this.delayTimer=new ig.Timer,this.onCompleted=new ig.Signal},resetExtras:function(){var e=this.activated;this.activated=!1,this.parent(),e&&this.trigger()},check:function(e){this.parent(e),this.triggerable&&this.trigger(e,!0,!0)},trigger:function(i,t,s){if(this.getCanTrigger(i)){if(this.delay>0&&!this._delaying){this._delaying=!0;var n=this.delayTimer.pausedAt;this.delayTimer.set(this.delay),this.delayTimer.pausedAt=n}if(this.delayTimer.delta()>=0){this._delaying=!1,this.triggering=!0,this.targetSequence.length=0;for(var a in this.target){var o=ig.game.namedEntities[this.target[a]];o&&!o.triggering&&this.targetSequence.push(o)}s&&this.useCheckingAsTarget&&e.arrayCautiousAdd(this.targetSequence,i),this.sortTargetsBy&&this.targetSequence.sort(this.sortTargetsBy),this.handleTargets(i,t),this.wait&&this.waitTimer.set(this.wait),this.triggering=!1,this.autoComplete&&this.complete()}}},getCanTrigger:function(e){return!(this.triggering||this.once&&this.activated||this.wait&&!(this.waitTimer.delta()>=0))},handleTargets:function(e,i){!1!==i&&this.activate(e);for(var t=0,s=this.targetSequence.length;t<s;t++){var n=this.targetSequence[t];n instanceof ig.EntityTrigger?n.trigger(e):n.activate&&n.activate(e)}},activate:function(e){this.needsTeardown||this.setup(),this.triggering||this.trigger(e,!1),this.parent(e)},deactivate:function(e){this.needsTeardown&&this.teardown(),this.parent(e)},complete:function(){this.onCompleted.dispatch(),this.targetSequence.length=0,this.suicidal?this.kill(!0):!this.checking&&this.autoToggle&&this.activated?this.deactivate():this.teardownWhenComplete&&this.needsTeardown&&this.teardown()},setup:function(){this.needsTeardown=!0},teardown:function(){this.needsTeardown=!1},pause:function(){this.parent(),this.delayTimer.pause(),this.waitTimer.pause()},unpause:function(){this.parent(),this.delayTimer.unpause(),this.waitTimer.unpause()},kill:function(e){this.triggerable=!1,this.parent(e)},cleanup:function(){ig.game.hasLevel||(this.onCompleted.removeAll(),this.onCompleted.forget()),this.needsTeardown&&this.teardown(),this.parent()},update:function(){this.checking||this.wasChecking===this.checking||(this.triggerAfterDelay||(this._delaying=!1),this.autoToggle&&this.activated&&this.deactivate()),this._delaying&&this.triggerAfterDelay&&this.delayTimer.delta()>=0&&this.trigger(this),this.parent()}}),ig.global.wm&&(delete ig.EntityExtended.prototype.staticInstantiate,ig.EntityTrigger.inject({trigger:function(){}}))}),ig.baked=!0,ig.module("plusplus.abstractities.spawner").requires("plusplus.core.timer","plusplus.entities.trigger","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.signals").defines(function(){"use strict";var e=ig.utils,i=ig.utilsmath;ig.Spawner=ig.EntityTrigger.extend({_wmBoxColor:"rgba( 0, 100, 255, 0.7)",triggerable:!1,autoComplete:!1,triggerAfterDelay:!0,spawningEntity:"",spawnSettings:null,spawnCountMax:1,spawnCount:0,spawnedCount:0,spawning:!1,pool:[],entities:[],duration:0,durationTimer:null,respawnDelay:0,respawnTimer:null,spawnDelay:-1,spawnAt:!1,spawnTarget:{},spawnTargetSequence:[],spawnAtRandomPosition:!0,spawnAtSide:null,spawnAtRandomTarget:!1,spawnAtFirstTarget:!1,spawnAndMoveTo:!1,spawnAndMoveToSettings:null,spawnedDieWith:!1,unspawnSilently:!0,spawnTimer:null,onSpawned:null,onSpawnedAll:null,onUnspawned:null,onUnspawnedAll:null,_spawnedAtTargetIndex:0,_spawningComplete:!1,_reactivate:!1,initProperties:function(){this.parent(),this.durationTimer=new ig.Timer,this.respawnTimer=new ig.Timer,this.spawnTimer=new ig.Timer,this.onSpawned=new ig.Signal,this.onSpawnedAll=new ig.Signal,this.onUnspawned=new ig.Signal,this.onUnspawnedAll=new ig.Signal},resetExtras:function(){this.spawnAt=this.spawnAt||this,-1===this.duration&&(this.suicidal=!1),this.parent()},activate:function(e){if(this.parent(e),!this.spawning&&this.spawnedCount<this.spawnCountMax&&(this.spawningEntity||this.pool.length>0)){this._spawningComplete=!1,this.spawning=!0,this.spawnedCount=this.spawnCount,this.spawnDelay<0&&(this.spawnDelay=this.duration>0?this.duration/this.spawnCountMax:0),this.spawnTargetSequence.length=0;for(var i in this.spawnTarget){var t=ig.game.namedEntities[this.spawnTarget[i]];t&&this.spawnTargetSequence.push(t)}if(0===this.duration||0===this.spawnDelay){for(var s=!0;this.spawnedCount<this.spawnCountMax&&s;)s=this.spawnNext();this.complete()}else this.durationTimer.set(this.duration),this.spawnTimer.set(0)}},deactivate:function(e,i){this.spawning=this._spawningComplete=this._reactivate=!1,this.spawnedCount=this.spawnTargetSequence.length=this._spawnedAtTargetIndex=0,this.parent(e);for(var t=this.entities.length-1;t>=0;t--){var s=this.entities[t];this.unspawn(s,i)}},spawnNext:function(i){return this.spawnTargetSequence.length>0?this.spawnAtRandomTarget?this.spawnAt=this.spawnTargetSequence[Math.round(Math.random()*(this.spawnTargetSequence.length-1))]:this.spawnAtFirstTarget?this.spawnAt=this.spawnTargetSequence[0]:(this.spawnAt=this.spawnTargetSequence[this._spawnedAtTargetIndex],this._spawnedAtTargetIndex=(this._spawnedAtTargetIndex+1)%this.spawnTargetSequence.length):this.spawnAt=this,i?(i.added&&!i._killed||(i=ig.game.spawnEntity(i,0,0,this.spawnSettings)),e.arrayCautiousRemove(this.pool,i),e.arrayCautiousAdd(this.entities,i)):this.pool.length>0?(i=this.pool.pop())&&(i=ig.game.spawnEntity(i,0,0,this.spawnSettings),this.entities.push(i)):this.spawningEntity&&this.spawnedCount<this.spawnCountMax&&(i=ig.game.spawnEntity(this.spawningEntity,0,0,this.spawnSettings),this.entities.push(i)),i&&(this.spawnCount=Math.min(this.spawnCountMax,this.spawnCount+1),this.spawnedCount=Math.min(this.spawnCountMax,this.spawnedCount+1),this.spawned(i),this.onSpawned.dispatch(i),this.spawnedCount===this.spawnCountMax&&this.onSpawnedAll.dispatch(this)),i},unspawn:function(i,t){i._killed?(i.spawner&&i.spawner.unlinkSpawned(i),this.spawnCount=Math.max(0,this.spawnCount-1),this._killed||(e.arrayCautiousRemove(this.entities,i),e.arrayCautiousAdd(this.pool,i),this.onUnspawned.dispatch(i),0===this.spawnCount&&this.onUnspawnedAll.dispatch(this),this.activated&&-1===this.duration&&!this.spawning&&(this.spawnDelay>0||0===this.spawnCount)&&(this.spawnedCount=this.spawnCount,this.respawnTimer.set(this.respawnDelay),this._reactivate=!0))):i.kill("boolean"==typeof t?t:this.unspawnSilently)},spawned:function(e){this.linkSpawned(e);var t=e.size.x,s=e.size.y,n=.5*t,a=.5*s,o=this.spawnAt.size.x,r=this.spawnAt.size.y,h=this.spawnAt.pos.x,l=this.spawnAt.pos.y,g=h+o,c=l+r;this.spawnAtRandomPosition?(e.pos.x=i.map(Math.random(),0,1,h+n,g-n),e.pos.y=i.map(Math.random(),0,1,l+a,c-a)):(e.pos.x=h+.5*o,e.pos.y=l+.5*r),e.pos.x-=n,e.pos.y-=a,this.spawnAtSide&&(this.spawnAtSide.x>0?e.pos.x=g-t-.5*o*(1-this.spawnAtSide.x):this.spawnAtSide.x<0&&(e.pos.x=h+.5*o*(1+this.spawnAtSide.x)),this.spawnAtSide.y>0?e.pos.y=c-s-.5*r*(1-this.spawnAtSide.y):this.spawnAtSide.y<0&&(e.pos.y=l+.5*r*(1+this.spawnAtSide.y))),this.spawnAndMoveTo&&this.spawnTargetSequence.length>0&&e.moveTo(this.spawnTargetSequence,this.spawnAndMoveToSettings)},linkSpawned:function(e){e.spawner&&e.spawner.unlinkSpawned(e),e.onRemoved.add(this.unspawn,this),e.spawner=this},unlinkSpawned:function(e){e.onRemoved.remove(this.unspawn,this),e.spawner=void 0},complete:function(){this._spawningComplete=!0,this.spawning=!1,this.parent()},pause:function(){this.parent(),this.respawnTimer.pause(),this.spawnTimer.pause(),this.durationTimer.pause()},unpause:function(){this.parent(),this.respawnTimer.unpause(),this.spawnTimer.unpause(),this.durationTimer.unpause()},cleanup:function(){if(ig.game.hasLevel||(this.onSpawned.removeAll(),this.onSpawned.forget(),this.onSpawnedAll.removeAll(),this.onSpawnedAll.forget(),this.onUnspawned.removeAll(),this.onUnspawned.forget(),this.onUnspawnedAll.removeAll(),this.onUnspawnedAll.forget()),this.spawnedDieWith)for(var e=this.entities.length-1;e>=0;e--)this.unspawn(this.entities[e]);if(this.entities.length){for(var e=this.entities.length-1;e>=0;e--)this.unlinkSpawned(this.entities[e]);this.entities.length=0}if(this.pool.length){for(var e=this.pool.length-1;e>=0;e--)this.unlinkSpawned(this.pool[e]);this.pool.length=0}this.spawning=this._spawningComplete=this._reactivate=!1,this.spawnCount=this.spawnedCount=this.spawnTargetSequence.length=this._spawnedAtTargetIndex=0,this.parent()},update:function(){if(this.parent(),this.spawning&&!this._spawningComplete&&this.spawnTimer.delta()>=0){this.spawnTimer.set(this.spawnDelay);var e=this.spawnNext();(this.spawnedCount>=this.spawnCountMax||!e)&&this.complete()}else!0===this._reactivate&&this.respawnTimer.delta()>=0&&(this._reactivate=!1,this.activate())}})}),ig.baked=!0,ig.module("plusplus.abstractities.shape").requires("plusplus.core.entity","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.utils;ig.Shape=ig.EntityExtended.extend({_wmScalable:!0,_wmDrawBox:!0,_wmBoxColor:"rgba( 0, 255, 255, 0.7)",frozen:!0,opaqueFromVertices:!0,initTypes:function(){this.parent(),e.addType(ig.EntityExtended,this,"type","SHAPE")}})}),ig.baked=!0,ig.module("plusplus.entities.shape-solid").requires("plusplus.abstractities.shape").defines(function(){"use strict";ig.EntityShapeSolid=ig.global.EntityShapeSolid=ig.Shape.extend({opaque:!0,diffuse:1,hollow:!0})}),ig.baked=!0,ig.module("plusplus.entities.shape-climbable").requires("plusplus.abstractities.shape").defines(function(){"use strict";ig.EntityShapeClimbable=ig.global.EntityShapeClimbable=ig.Shape.extend({climbable:!0})}),ig.baked=!0,ig.module("plusplus.entities.shape-climbable-one-way").requires("plusplus.entities.shape-climbable").defines(function(){"use strict";ig.EntityShapeClimbableOneWay=ig.global.EntityShapeClimbableOneWay=ig.EntityShapeClimbable.extend({collides:ig.EntityExtended.COLLIDES.FIXED,oneWay:!0,oneWayFacing:{x:0,y:-1}})}),ig.baked=!0,ig.module("plusplus.ui.ui-overlay-pause").requires("plusplus.ui.ui-overlay").defines(function(){"use strict";ig.UIOverlayPause=ig.global.UIOverlayPause=ig.UIOverlay.extend({layerName:"ui",textSettings:{text:"PAUSED"}})}),ig.baked=!0,ig.module("plusplus.helpers.pathfinding").requires("plusplus.core.config","plusplus.core.collision-map","plusplus.core.pathfinding-map","plusplus.helpers.utilsmath","plusplus.helpers.utilstile","plusplus.helpers.utilsintersection").defines(function(){"use strict";function e(){var e,i;for(e=0,i=L.length;e<i;e++)L[e].cleanup();for(e=0,i=D.length;e<i;e++)D[e].cleanup();L.length=D.length=0}var i=ig.CONFIG,t=ig.utilsmath,s=ig.utilstile,n=ig.utilsintersection,a=i.COLLISION.TILE_ONE_WAY_UP,o=i.COLLISION.TILE_ONE_WAY_DOWN,r=i.COLLISION.TILE_ONE_WAY_RIGHT,h=i.COLLISION.TILE_ONE_WAY_LEFT,l=i.COLLISION.TILE_CLIMBABLE_WITH_TOP,g=i.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP,c=i.COLLISION.TILES_HASH_WALKABLE,u=i.COLLISION.TILES_HASH_SLOPED,d=i.COLLISION.TILES_HASH_CLIMBABLE,m=i.COLLISION.TILES_HASH_ONE_WAY,p=i.PATHFINDING.WEIGHTED,f=i.PATHFINDING.WEIGHT,y=i.PATHFINDING.WEIGHT_AWAY_FROM,E=i.PATHFINDING.ALLOW_DIAGONAL,v=i.PATHFINDING.DIAGONAL_REQUIRES_BOTH_DIRECT,T=i.PATHFINDING.AWAY_FROM_DISTANCE,I=i.PATHFINDING.AWAY_FROM_MAX_NODES,A=i.PATHFINDING.STRICT_SLOPE_CHECK;ig.pathfinding={};var x=null,_=null,C=null,S=null,w=ig.pathfinding.tilesize=1,b=1,N={from:{x:.1,y:.1},target:{x:.1,y:.1}},O=[],L=[],D=[],R=ig.pathfinding.HEURISTIC={MANHATTAN:function(e,i){return e+i},EUCLIDEAN:function(e,i){return Math.sqrt(e*e+i*i)},CHEBYSHEV:function(e,i){return Math.max(e,i)}};ig.PathNode=ig.Class.extend({x:0,y:0,gridX:0,gridY:0,size:0,walkable:!0,ungrounded:!0,insideLevel:!0,tile:0,sloped:!1,slopeNormal:{x:0,y:0},slopedAlong:!1,slopesAlongMap:{},slopedNeighbor:!1,slopedNeighborMap:{},climbable:!1,oneWay:!1,oneWayFacing:{x:0,y:0},weightPct:1,weight:0,neighbors:null,directNeighbors:null,neighborMap:{},corner:!1,cornerMap:{},closed:!1,opened:!1,openIndex:0,prevNode:null,g:0,w:0,h:0,f:0,init:function(e,i,t,c,p,f){var y,E;if(this.x=e||0,this.y=i||0,this.gridX=t||0,this.gridY=c||0,this.walkable=void 0===p||p,this.tile=f||0,this.climbable=!!d[this.tile],this.oneWay=!!m[this.tile],this.sloped=!!u[this.tile],this.sloped){var v=s.defaultTileSegmentsDef[this.tile];if(v)for(y=0,E=v.length;y<E;y++){var T=v[y].normal;if(T.x&&T.y){this.slopeNormal=T;break}}}if(this.oneWay&&(this.tile===a||this.tile===l||this.tile===g?this.oneWayFacing.y=-1:this.tile===o&&(this.oneWayFacing.y=1),this.tile===h?this.oneWayFacing.x=-1:this.tile===r&&(this.oneWayFacing.x=1)),this.walkable){if(ig.game.shapesLevel.length)for(this.insideLevel=!1,y=0,E=ig.game.shapesLevel.length;y<E;y++){var I=ig.game.shapesLevel[y];if(n.pointInAABB(e,i,I.x,I.y,I.x+I.size.x,I.y+I.size.y)&&n.pointInPolygon(e-(I.x+.5*I.size.x),i-(I.y+.5*I.size.y),I.vertices)){this.insideLevel=!0;break}}}else this.insideLevel=!1},cleanup:function(){this.g=this.h=this.f=this.w=this.openIndex=0,this.prevNode=null,this.closed=this.opened=!1}}),ig.pathfinding.rebuild=function(e,i){if(ig.pathfinding.unload(),x=e,C=i,x&&C&&C.tilesize!==x.tilesize)throw new Error("Maps tilesize mismatch: pathfinding map and collision map must have the same tilesize!");x&&(_=x.data,w=ig.pathfinding.tilesize=x.tilesize,b=1/x.tilesize),C&&(S=C.data,w=ig.pathfinding.tilesize=C.tilesize,b=1/C.tilesize),ig.pathfinding.rebuildGrid()},ig.pathfinding.unload=function(){O.length=0,x=_=C=S=null,w=ig.pathfinding.tilesize=0},ig.pathfinding.rebuildGrid=function(){var e,i,t,s,n,a,o,r,h,l;if(x&&_)for(n=0,a=_.length;n<a;n++)for(e=_[n],t=O[n],t||(t=O[n]=[]),o=0,r=e.length;o<r;o++)i=e[o],h=o*w+.5*w,l=n*w+.5*w,t[o]=new ig.PathNode(h,l,o,n,!!c[i],i);if(C&&S)for(n=0,a=S.length;n<a;n++)for(e=S[n],t=O[n],t||(t=O[n]=[]),o=0,r=!x||!_[0]||e.length>=_[0].length?e.length:_[0].length;o<r;o++){i=e[o]||0;var g=C.tiledef[i];s=t[o],s||(h=o*w+.5*w,l=n*w+.5*w,s=t[o]=new ig.PathNode(h,l,o,n,!g||void 0===g.walkable||g.walkable,i)),ig.merge(s,g)}for(n=0,a=O.length;n<a;n++)for(e=O[n],o=0,r=e.length;o<r;o++){s=e[o],s.size=w;var u=s.neighborMap,d=O[n-1],m=O[n+1];d&&(u.top=d[o],o>0&&(u.topleft=d[o-1]),o<r-1&&(u.topright=d[o+1])),o>0&&(u.left=e[o-1]),o<r-1&&(u.right=e[o+1]),m&&(u.bottom=m[o],o>0&&(u.bottomleft=m[o-1]),o<r-1&&(u.bottomright=m[o+1])),s.ungrounded=!u.bottom||u.bottom.walkable&&u.bottom.oneWayFacing.y>=0,u.top&&u.top.walkable&&(u.top.climbable||u.top.oneWayFacing.y<=0)&&u.left&&u.left.walkable&&(u.left.climbable||u.left.oneWayFacing.x<=0)&&(!u.topleft||!u.topleft.walkable&&!u.topleft.sloped)&&(s.corner=s.cornerMap.topleft=!0),u.top&&u.top.walkable&&(u.top.climbable||u.top.oneWayFacing.y<=0)&&u.right&&u.right.walkable&&(u.right.climbable||u.right.oneWayFacing.x>=0)&&(!u.topright||!u.topright.walkable&&!u.topright.sloped)&&(s.corner=s.cornerMap.topright=!0),u.bottom&&u.bottom.walkable&&(u.bottom.climbable||u.bottom.oneWayFacing.y>=0)&&u.left&&u.left.walkable&&(u.left.climbable||u.left.oneWayFacing.x<=0)&&(!u.bottomleft||!u.bottomleft.walkable&&!u.bottomleft.sloped)&&(s.corner=s.cornerMap.bottomleft=!0),u.bottom&&u.bottom.walkable&&(u.bottom.climbable||u.bottom.oneWayFacing.y>=0)&&u.right&&u.right.walkable&&(u.right.climbable||u.right.oneWayFacing.x>=0)&&(!u.bottomright||!u.bottomright.walkable&&!u.bottomright.sloped)&&(s.corner=s.cornerMap.bottomright=!0),u.top&&u.top.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.top=!0),u.bottom&&u.bottom.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottom=!0),u.right&&u.right.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.right=!0),u.left&&u.left.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.left=!0),u.topleft&&u.topleft.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.topleft=!0),u.topright&&u.topright.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.topright=!0),u.bottomleft&&u.bottomleft.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottomleft=!0),u.bottomright&&u.bottomright.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottomright=!0),s.slopesAlongMap.top=!1,s.slopesAlongMap.bottom=s.walkable&&!s.oneWay&&u.bottom&&u.bottom.sloped,ig.pathfinding.getIsAlongSlope(s,-1,0)&&(s.slopesAlongMap.left=s.slopedAlong=!0),ig.pathfinding.getIsAlongSlope(s,1,0)&&(s.slopesAlongMap.right=s.slopedAlong=!0),ig.pathfinding.getIsAlongSlope(s,-1,-1)&&(s.slopesAlongMap.topleft=s.slopedAlong=!0),ig.pathfinding.getIsAlongSlope(s,1,-1)&&(s.slopesAlongMap.topright=s.slopedAlong=!0),ig.pathfinding.getIsAlongSlope(s,-1,1)&&(s.slopesAlongMap.bottomleft=s.slopedAlong=!0),ig.pathfinding.getIsAlongSlope(s,1,1)&&(s.slopesAlongMap.bottomright=s.slopedAlong=!0),s.directNeighbors=ig.pathfinding.getDirectNeighbors(s),s.neighbors=[].concat(s.directNeighbors,ig.pathfinding.getDiagonalNeighbors(s))}},ig.pathfinding.getPathToEntity=function(e,i,t,s,n){var a=ig.pathfinding.getPositionPathfindingEntities(e,i,N);return ig.pathfinding.getPathTo(a.from.x,a.from.y,a.target.x,a.target.y,t,s,e,i,n)},ig.pathfinding.getPathToPoint=function(e,i,t,s,n,a,o){var r=ig.pathfinding.getPositionPathfindingPoint(e,i,t,N.from);return ig.pathfinding.getPathTo(r.x,r.y,i,t,s,n,e,a,o)},ig.pathfinding.getPathTo=function(i,t,s,n,a,o,r,h,l){var g;r&&r.path?(g=r.path,g.length=0):g=[];var c=O;if(0===c.length)return g;var u=Math.floor(i*b),d=Math.floor(t*b),m=Math.floor(s*b),y=Math.floor(n*b),T=c[d]&&c[d][u],I=c[y]&&c[y][m];if(!T||!I||T===I)return g;var A,x,_,C,S,N,k,P,M,F,G,z,B,Y,H,U,W,X=L,V=D,q=R[l||"MANHATTAN"],K=Math.abs,j=Math.SQRT2,Z=w,Q=Z;r&&(Q=Math.max(r.size.x,r.size.y),M=E&&v,a&&(P=!0,F=ig.pathfinding.nodeHasCollidingEntities));var J;for(h&&o>0?(J=!0,o*=b,o*=o):J=!1,X.push(T);X.length>0;){var $=X.pop(),ee=$.gridX,ie=$.gridY;if(V.push($),$.closed=!0,$===I){for(;$;)g.push($),$=$.prevNode;return e(),g}for(A=$.neighbors,S=A.length,M&&(Q>Z&&S<8&&!$.slopedNeighbor?(A=$.directNeighbors,S=A.length,W=-1,z=!1):(G=$.neighborMap,B=Y=H=U=z=!1,W=.5*S|1)),C=0;C<S;C++)if(x=A[C],!x.closed){var te=x.gridX,se=x.gridY;if(x!==I){if(J){var ne=te-m,ae=se-y;if(ne*ne+ae*ae>o)continue}if(P){
if(z&&(B&&x===G.topleft||Y&&x===G.topright||H&&x===G.bottomleft||U&&x===G.bottomright))continue;if(F(x,$,r,h)){M&&C<W&&(x===G.top&&(z=B=Y=!0),x===G.bottom&&(z=H=U=!0),x===G.left&&(z=B=H=!0),x===G.right&&(z=Y=U=!0));continue}}}var oe,re=te-ee==0||se-ie==0?1:j,he=$.g+re;if(oe=p?$.w+re+x.weight+f*x.weightPct:he,!x.opened||oe<x.w)if(x.g=he,x.w=oe,x.h=x.h||q(K(te-m),K(se-y)),x.f=x.w+x.h,x.prevNode=$,x.opened){var le;for(N=x.openIndex,k=X.length-1;N<k;N++){if(_=X[N+1],_.f<=x.f){le=!0;break}_.openIndex=N,X[N]=_}le||(N=X.length),x.openIndex=N,X[N]=x}else{for(x.opened=!0,N=X.length;N>0&&(_=X[N-1],!(x.f<=_.f));N--)_.openIndex=N,X[N]=_;x.openIndex=N,X[N]=x}}}return e(),g},ig.pathfinding.getPathAwayFromEntity=function(e,i,t,s,n){return ig.pathfinding.getPathAwayFrom(e.pos.x+.5*e.size.x,e.pos.y+.5*e.size.y,i.pos.x+.5*i.size.x,i.pos.y+.5*i.size.y,t,s,e,n)},ig.pathfinding.getPathAwayFromPoint=function(e,i,t,s,n,a){return ig.pathfinding.getPathAwayFrom(e.pos.x+.5*e.size.x,e.pos.y+.5*e.size.y,i,t,s,n,e,a)},ig.pathfinding.getPathAwayFrom=function(i,t,s,n,a,o,r,h){var l;r&&r.path?(l=r.path,l.length=0):l=[];var g=O;if(0===g.length)return l;var c=Math.floor(i*b),u=Math.floor(t*b),d=Math.floor(s*b),m=Math.floor(n*b),A=g[u]&&g[u][c],x=g[m]&&g[m][d];if(!A||!x)return l;var _,C,S,N,k,P,M,F,G,z,B,Y,H,U,W,X,V,q=L,K=D,j=R[h||"MANHATTAN"],Z=Math.abs,Q=Math.SQRT2,J=w,$=J;r&&($=Math.max(r.size.x,r.size.y),G=E&&v,a&&(F=!0,z=ig.pathfinding.nodeHasCollidingEntities)),o>0?o*=b:o=T*b,o*=o,q.push(A);for(var ee,ie,te=1/0,se=-1/0,ne=c-d,ae=u-m,oe=ne*ne+ae*ae;q.length>0;){var re=q.pop(),he=re.gridX,le=re.gridY;K.push(re),re.closed=!0,ne=he-d,ae=le-m;var ge=ne*ne+ae*ae-oe;if(ge>0&&re.g>1&&ge>se&&.5*re.w<te&&(ee=re,te=re.w,se=ge),K.length>=I&&(ie=ee),ie){for(;ie;)l.push(ie),ie=ie.prevNode;return e(),l}for(_=re.neighbors,k=_.length,G&&($>J&&!re.slopedNeighbor&&k<8?(_=re.directNeighbors,k=_.length,V=-1,Y=!1):(B=re.neighborMap,H=U=W=X=Y=!1,V=.5*k|1)),N=0;N<k;N++)if(C=_[N],!C.closed){if(F){if(Y&&(H&&C===B.topleft||U&&C===B.topright||W&&C===B.bottomleft||X&&C===B.bottomright))continue;if(z(C,re,r)){G&&N<V&&(C===B.top&&(Y=H=U=!0),C===B.bottom&&(Y=W=X=!0),C===B.left&&(Y=H=W=!0),C===B.right&&(Y=U=X=!0));continue}}var ce,ue=C.gridX,de=C.gridY,me=ue-he,pe=de-le,fe=0===me||0===pe?1:Q,ye=re.g+fe;ce=p?fe+C.weight+f*C.weightPct:fe,(ne>0&&ne+me<ne||ne<0&&ne+me>ne)&&(ce+=y),(ae>0&&ae+pe<ae||ae<0&&ae+pe>ae)&&(ce+=y);var Ee=re.w+ce;if(!C.opened||Ee<C.w)if(C.g=ye,C.w=Ee,C.h=C.h||j(Z(ue-d),Z(de-m)),C.f=C.w+C.h,C.prevNode=re,C.opened){var ve;for(P=C.openIndex,M=q.length-1;P<M;P++){if(S=q[P+1],S.f<=C.f){ve=!0;break}S.openIndex=P,q[P]=S}ve||(P=q.length),C.openIndex=P,q[P]=C}else{for(C.opened=!0,P=q.length;P>0&&(S=q[P-1],!(C.f<=S.f));P--)S.openIndex=P,q[P]=S;C.openIndex=P,q[P]=C}}}return e(),l},ig.pathfinding.getNeighbors=function(e){var i,t=[],s=e.gridX,n=e.gridY,a=O,o=a[n],r=a[n-1],h=a[n+1];return i=r&&r[s],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,0,-1,e)&&t.push(i),i=o&&o[s+1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,1,0,e)&&t.push(i),i=h&&h[s],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,0,1,e)&&t.push(i),i=o&&o[s-1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,-1,0,e)&&t.push(i),i=r&&r[s-1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,-1,-1,e)&&t.push(i),i=r&&r[s+1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,1,-1,e)&&t.push(i),i=h&&h[s+1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,1,1,e)&&t.push(i),i=h&&h[s-1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,-1,1,e)&&t.push(i),t},ig.pathfinding.getDirectNeighbors=function(e){var i,t=[],s=e.gridX,n=e.gridY,a=O,o=a[n],r=a[n-1],h=a[n+1];return i=r&&r[s],i&&(i.walkable||e.slopesAlongMap.left)&&ig.pathfinding.isDirectionWalkable(i,0,-1,e)&&t.push(i),i=o&&o[s+1],i&&(i.walkable||e.slopesAlongMap.right)&&ig.pathfinding.isDirectionWalkable(i,1,0,e)&&t.push(i),i=h&&h[s],i&&(i.walkable||e.slopesAlongMap.bottom)&&ig.pathfinding.isDirectionWalkable(i,0,1,e)&&t.push(i),i=o&&o[s-1],i&&i.walkable&&ig.pathfinding.isDirectionWalkable(i,-1,0,e)&&t.push(i),t},ig.pathfinding.getDiagonalNeighbors=function(e){var i,t=[],s=e.gridX,n=e.gridY,a=O,o=(a[n],a[n-1]),r=a[n+1];return i=o&&o[s-1],i&&(i.walkable||e.slopesAlongMap.topleft)&&ig.pathfinding.isDirectionWalkable(i,-1,-1,e)&&t.push(i),i=o&&o[s+1],i&&(i.walkable||e.slopesAlongMap.topright)&&ig.pathfinding.isDirectionWalkable(i,1,-1,e)&&t.push(i),i=r&&r[s+1],i&&(i.walkable||e.slopesAlongMap.bottomright)&&ig.pathfinding.isDirectionWalkable(i,1,1,e)&&t.push(i),i=r&&r[s-1],i&&(i.walkable||e.slopesAlongMap.bottomleft)&&ig.pathfinding.isDirectionWalkable(i,-1,1,e)&&t.push(i),t},ig.pathfinding.nodeHasCollidingEntities=function(e,i,t,s){var a=ig.game.layersMap[t.layerName];if(a&&a.spatialHash){var o=a.spatialHash,r=a.spatialHashCellSize,h=e.x,l=e.y,g=h/r|0,c=l/r|0,u=o[g];if(u){var d=u[c];if(d&&d.length>0)for(var m=.45*t.size.x,p=.45*t.size.y,f=h-m,y=l-p,E=h+m,v=l+p,T=e.gridX-i.gridX,I=e.gridY-i.gridY,A=0,x=d.length;A<x;A++){var _=d[A];if(_!==t&&!(_.group&t.group)&&(!s||_!==s)&&!_.hidden&&!_._killed&&(_.collides!==ig.EntityExtended.COLLIDES.NEVER||_.type&ig.EntityExtended.TYPE.DANGEROUS&&_.checkAgainst&t.type)&&n.AABBIntersect(f,y,E,v,_.pos.x,_.pos.y,_.pos.x+_.size.x,_.pos.y+_.size.y)&&(!_.oneWay||(!_.climbable||!t.canClimb&&0!==t.gravityFactor&&0!==ig.game.gravity)&&(I<0&&_.oneWayFacing.y>0||I>0&&_.oneWayFacing.y<0||T<0&&_.oneWayFacing.x>0||T>0&&_.oneWayFacing.x<0)))return!0}}}return!1},ig.pathfinding.getGridNode=function(e,i){return O[i]&&O[i][e]},ig.pathfinding.getNode=function(e,i,t,s){var n=Math.floor(e*b)+(t||0),a=Math.floor(i*b)+(s||0);return ig.pathfinding.getGridNode(n,a)},ig.pathfinding.getGridWalkableNode=function(e,i,t,s,n,a){var o=e+(t||0),r=i+(s||0),h=O[r]&&O[r][o],l=O[i]&&O[i][e];if(h&&h.walkable&&(!t&&!s||ig.pathfinding.isDirectionWalkable(h,t,s,l))){if(!n||!a)return h;if(!l||!ig.pathfinding.nodeHasCollidingEntities(h,l,a))return h}},ig.pathfinding.getWalkableNode=function(e,i,t,s,n,a){return ig.pathfinding.getGridWalkableNode(Math.floor(e*b),Math.floor(i*b),t,s,n,a)},ig.pathfinding.getWalkableNodeChain=function(e,i,t,s,n,a,o,r){var h=Math.floor(e*b),l=Math.floor(i*b);n=n||2,r?r.length=0:r=[];for(var g=1;g<=n;g++){var c=ig.pathfinding.getGridWalkableNode(h+t*g,l+s*g,t,s,a,o);if(!c)break;r.push(c)}return r},ig.pathfinding.isGridWalkable=function(e,i,t,s,n,a){var o=e+(t||0),r=i+(s||0),h=O[r]&&O[r][o],l=O[i]&&O[i][e];if(h&&h.walkable&&(!t&&!s||ig.pathfinding.isDirectionWalkable(h,t,s,l))){if(!n||!a)return!0;if(l&&!ig.pathfinding.nodeHasCollidingEntities(h,l,a))return!0}return!1},ig.pathfinding.isWalkable=function(e,i,t,s,n,a){return ig.pathfinding.isGridWalkable(Math.floor(e*b),Math.floor(i*b),t,s,n,a)},ig.pathfinding.isDirectionWalkable=function(e,i,t,s){if(0!==i&&0!==t&&s){if(!E)return!1;var n=s.neighborMap;if(v)if(i>0){if(!n.right||!n.right.walkable&&!n.right.sloped)return!1;if(t>0){if(!n.bottom||!n.bottom.walkable&&!n.bottom.sloped)return!1}else if(!n.top||!n.top.walkable&&!n.top.sloped)return!1}else{if(!n.left||!n.left.walkable&&!n.left.sloped)return!1;if(t>0){if(!n.bottom||!n.bottom.walkable&&!n.bottom.sloped)return!1}else if(!n.top||!n.top.walkable&&!n.top.sloped)return!1}else if(i>0){if(t>0){if(!(n.right&&(n.right.walkable||n.right.sloped)||n.bottom&&(n.bottom.walkable||n.bottom.sloped)))return!1}else if(!(n.right&&(n.right.walkable||n.right.sloped)||n.top&&(n.top.walkable||n.top.sloped)))return!1}else if(t>0){if(!(n.left&&(n.left.walkable||n.left.sloped)||n.bottom&&(n.bottom.walkable||n.bottom.sloped)))return!1}else if(!(n.left&&(n.left.walkable||n.left.sloped)||n.top&&(n.top.walkable||n.top.sloped)))return!1}return!(e.oneWay&&!e.climbable&&(t<0&&e.oneWayFacing.y>0||t>0&&e.oneWayFacing.y<0||i<0&&e.oneWayFacing.x>0||i>0&&e.oneWayFacing.x<0))},ig.pathfinding.isGridPointInGrid=function(e,i){return O[i]&&O[i][e]instanceof Node},ig.pathfinding.isPointInGrid=function(e,i,t,s){var n=Math.floor(e*b)+(t||0),a=Math.floor(i*b)+(s||0);return O[a]&&O[a][n]instanceof Node},ig.pathfinding.getPositionPathfindingEntities=function(e,i,t){t||(t={from:{x:.1,y:.1},target:{x:.1,y:.1}});var s=e.size.x,n=e.size.y,a=e.pos.x,o=a+s,r=e.pos.y,h=r+n,l=a+.5*s,g=r+.5*n,c=i.size.x,u=i.size.y,d=i.pos.x,m=d+c,p=i.pos.y,f=p+u,y=d+.5*c,E=p+.5*u,v=.25*w;return l>y?(t.from.x=a+v,t.target.x=m-v):l<y?(t.from.x=o-v,t.target.x=d+v):(t.from.x=a+.5*s,t.target.x=d+.5*c),g>E?(t.from.y=e.hasGravity?h-v:r+v,t.target.y=f-v):g<E?(t.from.y=h-v,t.target.y=i.hasGravity?f-v:p+v):(t.from.y=e.hasGravity?h-v:r+.5*n,t.target.y=i.hasGravity?f-v:p+.5*u),t},ig.pathfinding.getPositionPathfindingPoint=function(e,i,t,s){return s||(s={}),s.x=e.pos.x+.5*e.size.x,s.y=e.pos.y+.5*e.size.y,s.x>i?s.x=e.pos.x+.25*w:s.x<i&&(s.x=e.pos.x+e.size.x-.25*w),e.hasGravity||s.y<t?s.y=e.pos.y+e.size.y-.25*w:s.y>t&&(s.y=e.pos.y+.25*w),s},ig.pathfinding.getBoundsPathfollowing=function(e,i,t,s,n,a,o){o||(o={});var r=Math.min(.5*w,.5*t),h=Math.min(.5*w,.5*s);return n.corner?n.cornerMap.bottomleft?(o.minX=e,o.maxX=o.minX+r,o.maxY=i+s,o.minY=o.maxY-h):n.cornerMap.bottomright?(o.maxX=e+t,o.minX=o.maxX-r,o.maxY=i+s,o.minY=o.maxY-h):n.cornerMap.topleft?(o.minX=e,o.maxX=o.minX+r,o.minY=i,o.maxY=o.minY+h):n.cornerMap.topright&&(o.maxX=e+t,o.minX=o.maxX-r,o.minY=i,o.maxY=o.minY+h):(o.ignoreCornerX?(o.minX=e+.5*t-.5*r,o.maxX=o.minX+r):(o.minX=e+.5*t,o.maxX=o.minX),o.maxY=i+s,o.minY=o.maxY-h,n.x>o.maxX?(o.minX=e,o.maxX=o.minX+r):n.x<o.minX&&(o.maxX=e+t,o.minX=o.maxX-r),!o.ignoreCornerX&&n.x>=o.minX-1&&n.x<=o.maxX+1&&(o.ignoreCornerX=!0),a&&(o.ignoreCornerY?(o.minY=i+.5*s-.5*h,o.maxY=o.minY+h):(o.minY=i+.5*s,o.maxY=o.minY),n.y>o.maxY?(o.minY=i,o.maxY=o.minY+h):n.y<o.minY&&(o.maxY=i+s,o.minY=o.maxY-h),!o.ignoreCornerY&&n.y>=o.minY-1&&n.y<=o.maxY+1&&(o.ignoreCornerY=!0))),o.width=r,o.height=h,o},ig.pathfinding.getEntityNeighborPositionX=function(e,i,t){return 0!==t?t<0?e-w:e+i+w:e+.5*i},ig.pathfinding.getEntityNeighborPositionY=function(e,i,t,s){return 0!==t?t<0?e-w:e+i+w:s?e+.5*i:e+i-.25*w},ig.pathfinding.getEntityOnSmoothSlope=function(e,i,t){var s,n=.25*w;if(s=i<0?ig.pathfinding.getNode(e.pos.x+n,e.pos.y+e.size.y-n):ig.pathfinding.getNode(e.pos.x+e.size.x-n,e.pos.y+e.size.y-n)){if(A){var a;return a=i<0?"left":"right",s.slopesAlongMap[a]||t&&s.slopesAlongMap[(t<0?"top":"bottom")+a]||!t&&(s.slopesAlongMap["top"+a]||s.slopesAlongMap["bottom"+a])}return s.slopedAlong}return!1},ig.pathfinding.getSlopeDirectionY=function(e,i){var s,n=.25*w;return s=i<0?ig.pathfinding.getNode(e.pos.x+n,e.pos.y+e.size.y-n):ig.pathfinding.getNode(e.pos.x+e.size.x-n,e.pos.y+e.size.y-n),s&&s.sloped&&s.slopeNormal?t.direction(-s.slopeNormal.x*(i<0?1:-1)):0},ig.pathfinding.getIsAlongSlope=function(e,i,t){var s,n,a;i<0?(s="left",n=1,a=3):(s="right",n=3,a=1);var o,r,h;if(void 0!==t?0!==t?t<0?(o=e.neighborMap["top"+s],r=0,h=1):(o=e.neighborMap["bottom"+s],r=0,h=-1):(o=e.neighborMap[s],r=1,h=0):e.sloped?(o=e.neighborMap["top"+s],r=0,h=1):(o=e.neighborMap[s],r=1,h=0),o&&o.sloped){var l=ig.game.collisionMap&&ig.game.collisionMap.tiledef||ig.CollisionMap.defaultTileDef,g=l[e.tile],c=l[o.tile];if(!c||!g&&c[a]===r||g&&g[n]+h===c[a])return!0}return!1}}),ig.baked=!0,ig.module("plusplus.core.game").requires("impact.game","plusplus.core.config","plusplus.core.timer","plusplus.core.font","plusplus.core.image","plusplus.core.background-map","plusplus.core.collision-map","plusplus.core.pathfinding-map","plusplus.core.animation","plusplus.core.layer","plusplus.core.input","plusplus.core.entity","plusplus.core.camera","plusplus.core.player-manager","plusplus.abstractities.spawner","plusplus.entities.light","plusplus.entities.shape-solid","plusplus.entities.shape-climbable","plusplus.entities.shape-climbable-one-way","plusplus.ui.ui-overlay-pause","plusplus.helpers.signals","plusplus.helpers.tweens","plusplus.helpers.pathfinding","plusplus.helpers.utils","plusplus.helpers.utilstile","plusplus.helpers.utilsintersection").defines(function(){"use strict";var e=ig.CONFIG,i=ig.pathfinding,t=ig.utils,s=ig.utilstile,n=ig.utilsintersection;ig.GameExtended=ig.Game.extend({shapesPasses:{level:{retainBoundaryOuter:!1,discardEdgesInner:!0,ignoreClimbables:!0,ignoreOneWays:!0},climbables:{ignoreSolids:!0,ignoreOneWays:!0}},shapesLevel:[],layers:[],layersMap:{},sortLayersBy:null,paused:!1,pauseLocked:!1,changed:!1,changedLights:!1,dirtyEntities:!0,dirtyLights:!0,deferring:!1,hasLevel:!1,entities:[],namedEntities:{},persistentEntities:{},autoSpawnPlayer:e.AUTO_SPAWN_PLAYER,playerClass:null,canSearchForPlayerByClass:!0,canSearchForPlayerByType:!0,lights:[],gravity:e.TOP_DOWN?0:e.GRAVITY,cameraClass:ig.Camera,cameraSettings:null,camera:null,playerManagerClass:ig.PlayerManager,playerManagerSettings:null,playerManager:null,pathfindingMap:null,onPaused:null,onUnpaused:null,clearColor:e.CLEAR_COLOR,_gameNeedsSetup:!0,_gameNeedsResize:!1,_gameForceResize:!1,_levelBuilding:!1,_levelToBuild:null,_levelNeedsBuild:!1,_levelNeedsUnload:!1,_playerSpawnerName:"",_layersToChange:[],_layersToAdd:[],_layersToRemove:[],_itemsToAdd:[],_itemsToAddNext:[],_itemsToRemove:[],_itemsToRemoveNext:[],init:function(){this._gameNeedsSetup&&this.setup()},setup:function(){this._gameNeedsSetup=!1,this.onPaused=new ig.Signal,this.onUnpaused=new ig.Signal,this.cameraClass&&(this.camera=new this.cameraClass(this.cameraSettings)),this.playerManagerClass&&(this.playerManager=new this.playerManagerClass(this.playerManagerSettings)),this.sortLayersBy=this.sortLayersBy||ig.Game.SORT.Z_INDEX,this.addLayer(new ig.Layer("backgroundMaps",{preRender:e.PRERENDER_BACKGROUND_LAYER,noUpdate:e.NO_UPDATE_BACKGROUND_LAYER})),this.addLayer(new ig.Layer("lights")),this.addLayer(new ig.Layer("entities")),this.addLayer(new ig.Layer("foregroundMaps",{preRender:e.PRERENDER_FOREGROUND_LAYER,noUpdate:e.NO_UPDATE_FOREGROUND_LAYER})),this.addLayer(new ig.Layer("overlay",{zIndex:1,ignorePause:e.IGNORE_PAUSE_OVERLAY_LAYER,autoSort:e.AUTO_SORT_OVERLAY_LAYER})),this.addLayer(new ig.Layer("ui",{zIndex:2,clearOnLoad:e.CLEAR_ON_LOAD_UI_LAYER,ignorePause:e.IGNORE_PAUSE_UI_LAYER,autoSort:e.AUTO_SORT_UI_LAYER}));for(var i in e.LAYERS_CUSTOM){var s=e.LAYERS_CUSTOM[i];this.addLayer(new ig.Layer(i,s))}this._addDeferredLayers(),ig.global.addEventListener("resize",t.debounce(this.resize.bind(this),e.RESIZE_DELAY),!1),this.resize(),this.inputStart()},loadLevelDeferred:function(e,i){this.resetLoadLevel(),this._levelToLoad=e,this._playerSpawnerName=i},loadLevel:function(i,t){if(this._gameNeedsSetup&&this.setup(),i=i||this._levelToLoad,this._levelToLoad=void 0,"string"==typeof i){var s=i.replace(/^(Level)?(\w)(\w*)/,function(e,i,t,s){return t.toUpperCase()+s});s=s.replace(/[-|\s?)](.)/g,function(e,i){return i.toUpperCase()}),i=ig.global["Level"+s]}if(i)if(this._levelToBuild=i,this.hasLevel&&e.TRANSITION_LEVELS&&this.layersMap[e.TRANSITIONER_LAYER]&&this.layersMap[e.TRANSITIONER_LAYER].ignorePause){var n=this;this.transitioner||(this.transitioner=this.spawnEntity(ig.UIOverlay,0,0,{layerName:e.TRANSITIONER_LAYER,zIndex:e.Z_INDEX_TRANSITIONER,fillStyle:e.TRANSITIONER_COLOR,r:e.TRANSITIONER_R,g:e.TRANSITIONER_G,b:e.TRANSITIONER_B,alpha:0})),this.transitioner.fadeTo(1,{onComplete:function(){n.buildLevelDeferred()}}),this.pause(!0)}else this.buildLevel()},buildLevelDeferred:function(){this._levelToBuild&&(this._levelNeedsBuild=!0)},buildLevel:function(){this._gameNeedsSetup&&this.setup();var t,n,a,o,r,h=this._levelToBuild,l=this._playerSpawnerName;if(h){for(this._levelBuilding=!0,this.unloadLevel(),this.collisionMap=ig.CollisionMap.staticNoCollision,o=0;o<h.layer.length;o++)n=h.layer[o],"collision"===n.name?this.collisionMap=new ig.CollisionMap(n.tilesize,n.data):"pathfinding"===n.name?this.pathfindingMap=new ig.PathfindingMap(n.tilesize,n.data):(a=new ig.BackgroundMapExtended(n.tilesize,n.data,n.tilesetName),a.anims=this.backgroundAnims[n.tilesetName]||{},a.repeat=n.repeat,a.distance=n.distance,a.foreground=!!n.foreground,a.preRender=!!n.preRender,a.name=n.name,!a.layerName&&a.foreground?a.layerName="foregroundMaps":a.layerName||(a.layerName="backgroundMaps"),this.addItem(a));for(s.rebuild(this.collisionMap),this.createShapes(),e.PATHFINDING.BUILD_WITH_LEVEL&&i.rebuild(this.collisionMap,this.pathfindingMap),this.namedEntities={},o=0,r=h.entities.length;o<r;o++)t=h.entities[o],this.spawnEntity(t.type,t.x,t.y,t.settings);var g=this.getPlayer();for(!g&&this.autoSpawnPlayer&&(g=this.persistentEntities.player||this.playerClass)&&this.spawnEntity(g,0,0),this.sortEntities(),this._levelBuilding=!1,this.hasLevel=!0,o=0,r=this.layers.length;o<r;o++)this.layers[o].ready();if(g&&l){var c=this.namedEntities[l];c&&(c instanceof ig.Spawner?c.spawnNext(g):g.moveToPosition(c))}this.unpause(!0),this.transitioner&&(this.transitioner.added||this.spawnEntity(this.transitioner,0,0,{alpha:1}),this.transitioner.fadeToDeath(),this.transitioner=void 0),this.camera&&this.camera.ready(),this.playerManager&&this.playerManager.ready(),this.resize(),this.dirtyEntities=this.dirtyLights=!0}},unloadLevelDeferred:function(){this._levelNeedsUnload=!0},unloadLevel:function(){if(this.hasLevel){this.hasLevel=!1,this.shapesLevel.length=0,this.playerManager&&this.playerManager.reset(),this.camera&&this.camera.reset(),this._removeDeferredItems(),this._addDeferredItems(),this.resetLoadLevel(),i.unload();for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].reset()}},resetLoadLevel:function(){this._levelToLoad=this._levelToBuild=void 0,this._levelNeedsBuild=this._levelNeedsUnload=!1,this._playerSpawnerName=""},createShapes:function(){var e,i,t,n;if(this.shapesPasses&&this.collisionMap)for(var a in this.shapesPasses){for(t=this.shapesPasses[a],n=s.shapesFromCollisionMap(this.collisionMap,t),e=0,i=n.solids.length;e<i;e++){var o=n.solids[e];"level"===a?(o.size=o.settings.size,o.vertices=o.settings.vertices,delete o.id,delete o.settings,this.shapesLevel.push(o)):this.spawnEntity(ig.EntityShapeSolid,o.x,o.y,o.settings)}for(e=0,i=n.oneWays.length;e<i;e++){var o=n.oneWays[e];this.spawnEntity(ig.EntityShapeSolid,o.x,o.y,o.settings)}for(e=0,i=n.climbables.length;e<i;e++){var o=n.climbables[e];this.spawnEntity(o.settings.oneWay?ig.EntityShapeClimbableOneWay:ig.EntityShapeClimbable,o.x,o.y,o.settings)}}},addLayer:function(e){return this._layersToAdd.push(e),e},_addDeferredLayers:function(e){if(e=e||this._layersToAdd,e.length>0){for(var i=0,t=e.length;i<t;i++){var s=e[i];this.layersMap[s.name]!==s&&(this.layersMap[s.name]&&this.removeLayer(this.layersMap[s.name]),this.layersMap[s.name]=s,this.layers.push(s),this.sortLayersBy&&this.layers.sort(this.sortLayersBy))}e===this._layersToAdd&&(this._layersToAdd.length=0)}},removeLayer:function(e){this._layersToRemove.push(e)},_removeDeferredLayers:function(e){if(e=e||this._layersToRemove,e.length>0){for(var i=0,s=e.length;i<s;i++){var n=e[i];t.arrayCautiousRemove(this.layers,n),this.layersMap[n.name]===n&&delete this.layersMap[n.name],n.reset()}e===this._layersToRemove&&(this._layersToRemove.length=0)}},changeLayer:function(e,i){this._layersToChange.push({name:e,settings:i})},_changeDeferredLayers:function(){if(this._layersToChange.length>0){for(var e=0,i=this._layersToChange.length;e<i;e++){var t=this._layersToChange[e],s=t.name,n=t.settings,a=this.layersMap[s];a&&ig.merge(a,n)}this._layersToChange.length=0}},spawnEntity:function(i,t,s,n){var a="string"==typeof i?ig[i]||ig.global[i]:i;if(!a)throw new Error("Can't spawn entity of type: "+i+". It does not exist in namespace 'ig' or 'ig.global'/'window'.");var o;if(a instanceof ig.EntityExtended){if(o=a,o._layerNameAdd)return o;o.reset(t,s,n)}else o=new a(t,s,n);if(o.name&&(o.persistent&&(this.persistentEntities[o.name]instanceof ig.EntityExtended?(o=this.persistentEntities[o.name],o.reset(t,s,n)):this.persistentEntities[o.name]=o),this.namedEntities[o.name]=o),e.FORCE_ENTITY_EXTENDED&&!(o instanceof ig.EntityExtended))throw new Error("You are trying to spawn an entity that does not inherit or extend ig.EntityExtended. Although it is not recommended (seriously), if you wish to allow this, see ig.CONFIG.FORCE_ENTITY_EXTENDED.");return this.addItem(o),o},removeEntity:function(e,i){e instanceof ig.EntityExtended&&!e._killed&&this.flagAsKilled(e),this.removeItem(e,i)},clearPersistentEntity:function(e){var i=ig.game.persistentEntities[e];i&&(i.added?i._cleanupPersistent=!0:i.cleanupPersistent(),delete ig.game.persistentEntities[e])},clearPersistentEntities:function(){for(var e in ig.game.persistentEntities)this.clearPersistentEntity(e)},flagAsKilled:function(e){e.name&&delete this.namedEntities[e.name],e._killed=!0,e.type=ig.EntityExtended.TYPE.NONE,e.checkAgainst=ig.EntityExtended.TYPE.NONE,e.collides=ig.EntityExtended.COLLIDES.NEVER},addItem:function(e,i){if(!e._killed){var t;i?(e._layerChange=i.forChange||!1,t=i.layerName||e.layerName||"entities"):(e._layerChange=!1,t=e.layerName||"entities"),!e._layerChange&&e._layerNameAdd||(e._layerNameAdd=t,this._levelBuilding?this._addDeferredItem(e):this.deferring?this._itemsToAdd.push(e):this._itemsToAddNext.push(e))}},_addDeferredItems:function(){if(this._itemsToAdd.length>0){for(var e=0,i=this._itemsToAdd.length;e<i;e++)this._addDeferredItem(this._itemsToAdd[e]);this._itemsToAdd.length=0}},_addDeferredItem:function(e){this._gameNeedsSetup&&this.setup(),e.layerName=e._layerNameAdd,e._layerNameAdd=void 0;var i=this.layersMap[e.layerName];if(!i)throw new Error("Attempting to add item/entity to layer named "+e.layerName+" and that layer doesn't exist. Your item needs a 'layerName' property with a value matching one of the existing game layer names: ",this.layersMap);i.addItem(e),e.added=!0,e._layerChange||this._levelBuilding||(i.paused?e.pause&&e.pause():e.paused&&e.unpause&&e.unpause(),e.adding&&e.adding()),e._layerChange=!1,this.dirtyEntities=!0,e instanceof ig.EntityLight&&(this.dirtyLights=!0)},removeItem:function(e,i){i?(e._layerNameRemove=i.layerName||e.layerName,e._layerChange=i.forChange||!1):(e._layerNameRemove=e.layerName,e._layerChange=!1),e._layerChange||(e.cleanup&&e.cleanup(),e.added=!1),this._levelBuilding?this._removeDeferredItem(e):(e._layerNameAdd&&(e._layerNameAdd=void 0,t.arrayCautiousRemove(this._itemsToAddNext,e),t.arrayCautiousRemove(this._itemsToAdd,e)),this.deferring?this._itemsToRemove.push(e):this._itemsToRemoveNext.push(e))},_removeDeferredItems:function(){if(this._itemsToRemove.length>0){for(var e=0,i=this._itemsToRemove.length;e<i;e++)this._removeDeferredItem(this._itemsToRemove[e]);this._itemsToRemove.length=0}},_removeDeferredItem:function(e){var i=this.layersMap[e._layerNameRemove];e._layerNameRemove=void 0,i&&i.removeItem(e),this.dirtyEntities=!0,e instanceof ig.EntityLight&&(this.dirtyLights=!0)},_advanceDeferredNext:function(){this._itemsToAddNext.length>0&&(this._itemsToAdd=this._itemsToAddNext,this._itemsToAddNext=[]),this._itemsToRemoveNext.length>0&&(this._itemsToRemove=this._itemsToRemoveNext,this._itemsToRemoveNext=[])},layerChangeItem:function(e,i){e&&(!i&&e.resetState&&(i=e.resetState.layerName),i&&e.layerName!==i&&(this.removeItem(e,{layerName:e.layerName,forChange:!0}),this.addItem(e,{layerName:i,forChange:!0})))},sortEntities:function(e){if("string"==typeof e)this.sortEntitiesOnLayer(this.layersMap[e]);else for(var i=0,t=this.layers.length;i<t;i++)this.sortEntitiesOnLayer(this.layers[i])},sortEntitiesOnLayer:function(e){e&&e.items.sort(e.sortBy)},sortEntitiesDeferred:function(e){if("string"==typeof e)this.sortEntitiesOnLayerDeferred(this.layersMap[e]);else for(var i=0,t=this.layers.length;i<t;i++)this.sortEntitiesOnLayerDeferred(this.layers[i])},sortEntitiesOnLayerDeferred:function(e){e&&e.sort()},isInsideLevel:function(e,t){if(i.tilesize){var n=i.getNode(e,t);return n&&n.insideLevel}return!this.collisionMap||s.isTileWalkableStrict(this.collisionMap.getTile(e,t))},getPlayer:function(e){return this.namedEntities.player||this.canSearchForPlayerByClass&&this.getEntitiesByClass("Player",e||{first:!0})[0]||this.canSearchForPlayerByType&&this.getEntitiesByType(ig.EntityExtended.TYPE.PLAYER,e||{first:!0})[0]},getEntitiesByClass:function(e,i){var t="string"==typeof e?ig.global[e]:e;return t?this.getEntitiesMatching(function(e){return e instanceof t},i):[]},getEntitiesByType:function(e,i){var s="string"==typeof e?t.getType(ig.EntityExtended,e):e;return this.getEntitiesMatching(function(e){return e.type&s},i)},getEntitiesByGroup:function(e,i){var s="string"==typeof e?t.getType(ig.EntityExtended,e):e;return this.getEntitiesMatching(function(e){return e.group&s},i)},getCharactersByGroup:function(e,i){var s="string"==typeof e?t.getType(ig.EntityExtended,e):e;return this.getEntitiesMatching(function(e){return e.group&s&&e instanceof ig.Character},i)},getEntitiesMatching:function(e,i){var t,s,a,o,r,h,l,g,c,u,d,m,p,f,y,E,v=[];if(i&&i.layerName){if(i&&(s=i.layerName,a=i.unsorted,o=i.distanceSquared,r=i.byDistance,h=i.lineOfSight,l=i.nonHidden,g=i.from,f=i.first,void 0!==i.minX&&(c=!0,u=i.minX,d=i.minY,m=i.maxX,p=i.maxY)),t=this.layersMap[s]){var T=t.items;for(y=0,E=T.length;y<E;y++){var I=T[y];if(!I._killed&&e(I)&&(!l||!I.hidden)&&(!o||I.distanceSquaredTo(g)<=o)&&(!c||n.AABBIntersect(u,d,m,p,I.pos.x,I.pos.y,I.pos.x+I.width,I.pos.y+I.height))&&(!h||g.lineOfSight(I))&&(v.push(I),f))break}}}else for(i=i||{},i.unsorted=!0,y=0,E=this.layers.length;y<E;y++)if(t=this.layers[y],t.numEntities){i.layerName=t.name;var A=this.getEntitiesMatching(e,i);if(A.length&&(v=v.concat(A),i.first))break}return v.length>1&&!a&&(r?g instanceof ig.EntityExtended?n.sortByDistance(g.pos.x+.5*g.size.x,g.pos.y+.5*g.size.y,v):n.sortByDistance(g.x,g.y,v):v.sort(this.sortBy)),v},getMapByName:function(e){var i,t,s,n,a,o;if("collision"===e)return this.collisionMap;for(i=0,t=this.layers.length;i<t;i++)if(o=this.layers[i],a=o.items,o.numBackgroundMaps)for(s=0,n=a.length;s<n;s++){var r=a[s];if(r.name===e)return r}},pause:function(i){if(!this.pauseLocked&&!this._levelBuilding){for(var t=0,s=this.layers.length;t<s;t++)this.layers[t].pause();this.paused||(this.paused=!0,this.pauseLocked=i,this.camera&&this.camera.pause(),!this.pauseLocked&&e.DIMMED_PAUSE&&(this.dimmer||(this.dimmer=this.spawnEntity(ig.UIOverlayPause,0,0,{fillStyle:e.DIMMER_COLOR,r:e.DIMMER_R,g:e.DIMMER_G,b:e.DIMMER_B,alpha:0})),this.dimmer.fadeTo(e.DIMMER_ALPHA)),this.onPaused.dispatch(this))}},unpause:function(e){if(e&&(this.pauseLocked=!1),!this.pauseLocked&&!this._levelBuilding){for(var i=0,t=this.layers.length;i<t;i++)this.layers[i].unpause();this.paused&&(this.paused=!1,this.camera&&this.camera.unpause(),this.dimmer&&(this.dimmer.fadeToDeath(),this.dimmer=void 0),this.onUnpaused.dispatch(this))}},inputStart:function(){ig.input.bind(ig.KEY.MOUSE1,"touch"),ig.input.bind(ig.KEY.MOUSE2,"touch"),ig.input.bind(ig.KEY.TAP,"tap"),ig.input.bind(ig.KEY.TAP_DOUBLE,"tapDouble"),ig.input.bind(ig.KEY.HOLD,"hold"),ig.input.bind(ig.KEY.HOLD_ACTIVATE,"holdActivate"),ig.input.bind(ig.KEY.SWIPE,"swipe"),ig.input.bind(ig.KEY.SWIPE_X,"swipeX"),ig.input.bind(ig.KEY.SWIPE_Y,"swipeY"),ig.input.bind(ig.KEY.SWIPE_LEFT,"swipeLeft"),ig.input.bind(ig.KEY.SWIPE_RIGHT,"swipeRight"),ig.input.bind(ig.KEY.SWIPE_UP,"swipeUp"),ig.input.bind(ig.KEY.SWIPE_DOWN,"swipeDown"),ig.input.bind(ig.KEY.LEFT_ARROW,"left"),ig.input.bind(ig.KEY.RIGHT_ARROW,"right"),ig.input.bind(ig.KEY.UP_ARROW,"up"),ig.input.bind(ig.KEY.DOWN_ARROW,"down"),ig.input.bind(ig.KEY.A,"left"),ig.input.bind(ig.KEY.D,"right"),ig.input.bind(ig.KEY.W,"up"),ig.input.bind(ig.KEY.S,"down"),ig.input.bind(ig.KEY.SPACE,"jump")},inputEnd:function(){ig.input.unbind(ig.KEY.MOUSE1,"touch"),ig.input.unbind(ig.KEY.MOUSE2,"touch"),ig.input.unbind(ig.KEY.TAP,"tap"),ig.input.unbind(ig.KEY.TAP_DOUBLE,"tapDouble"),ig.input.unbind(ig.KEY.HOLD,"hold"),ig.input.unbind(ig.KEY.HOLD_ACTIVATE,"holdActivate"),ig.input.unbind(ig.KEY.SWIPE,"swipe"),ig.input.unbind(ig.KEY.SWIPE_X,"swipeX"),ig.input.unbind(ig.KEY.SWIPE_Y,"swipeY"),ig.input.unbind(ig.KEY.SWIPE_LEFT,"swipeLeft"),ig.input.unbind(ig.KEY.SWIPE_RIGHT,"swipeRight"),ig.input.unbind(ig.KEY.SWIPE_UP,"swipeUp"),ig.input.unbind(ig.KEY.SWIPE_DOWN,"swipeDown"),ig.input.unbind(ig.KEY.LEFT_ARROW,"left"),ig.input.unbind(ig.KEY.RIGHT_ARROW,"right"),ig.input.unbind(ig.KEY.UP_ARROW,"up"),ig.input.unbind(ig.KEY.DOWN_ARROW,"down"),ig.input.unbind(ig.KEY.A,"left"),ig.input.unbind(ig.KEY.D,"right"),ig.input.unbind(ig.KEY.W,"up"),ig.input.unbind(ig.KEY.S,"down"),ig.input.unbind(ig.KEY.SPACE,"jump")},handleInput:function(){var e,i,t,s,n,a,o,r;if(ig.input.released("tap"))for(n=ig.input.getInputPoints(["tapped"],[!0]),e=0,i=n.length;e<i;e++)if(a=n[e],o=a.targets,o.length>0)for(t=0,s=o.length;t<s;t++)if(r=o[t],r.type&ig.EntityExtended.TYPE.UI&&r.fixed){r.toggleActivate(),a.tapped=!1,1===i&&(ig.input.delayedKeyup.tap=!1);break}},update:function(){var e,i,t;if(this.deferring=!1,this._removeDeferredLayers(),this._addDeferredLayers(),this._changeDeferredLayers(),this._removeDeferredItems(),this._addDeferredItems(),this._advanceDeferredNext(),this._levelToLoad?this.loadLevel():this._levelNeedsBuild?this.buildLevel():this._levelNeedsUnload&&this.unloadLevel(),this._gameNeedsResize&&this.resize(this._gameForceResize),this.deferring=!0,!1!==this.dirtyEntities)for(this.entities.length=this.lights.length=0,e=0,i=this.layers.length;e<i;e++)t=this.layers[e],t.numEntities&&t.items.length>0&&(this.entities=this.entities.concat(t.items),this.lights=this.lights.concat(t.itemsLight));for(ig.TWEEN.update(),ig.input.update(),this.handleInput(),this.playerManager&&this.playerManager.update(),this.changed=this.changedLights=!1,e=0,i=this.layers.length;e<i;e++){var t=this.layers[e];t.update(),this.changed|=t.changed,this.changedLights|=t.changedLights}for(var s in this.backgroundAnims){var n=this.backgroundAnims[s];for(e in n)n[e].update()}this.camera&&this.camera.update(),this.dirtyEntities=this.dirtyLights=!1},updateEntities:function(e){var i=this.layersMap[e];if(i)for(var t=i.items,s=0,n=t.length;s<n;s++){var a=t[s];a.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor),this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale,this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;for(var e=0,i=this.layers.length;e<i;e++)this.layers[e].draw()},drawEntities:function(e){var i=this.layersMap[e];if(i)for(var t=i.items,s=0,n=t.length;s<n;s++)t[s].draw()},resize:function(i){var t=e.GAME_WIDTH_PCT?ig.global.innerWidth*e.GAME_WIDTH_PCT:e.GAME_WIDTH,s=e.GAME_HEIGHT_PCT?ig.global.innerHeight*e.GAME_HEIGHT_PCT:e.GAME_HEIGHT,n=e.SCALE;if(e.GAME_WIDTH_VIEW||e.GAME_HEIGHT_VIEW){var a=e.GAME_WIDTH_VIEW||1,o=e.GAME_HEIGHT_VIEW||1;n=Math.floor(Math.max(Math.min(t/a,s/o),1))}n=Math.min(Math.max(n,e.SCALE_MIN),e.SCALE_MAX);var r=1/n;ig.system.resize(t*r,s*r,n,i||this._gameForceResize),this._gameNeedsResize=this._gameForceResize=!1},resizeDeferred:function(e){this._gameNeedsResize=!0,this._gameForceResize=e||!1}})}),ig.baked=!0,ig.module("plusplus.core.plusplus").requires("plusplus.core.config","plusplus.core.loader","plusplus.core.game","plusplus.helpers.signals").defines(function(){"use strict";var e=ig.CONFIG;ig.System.inject({size:240,onResized:null,init:function(e,i,t,s,n){this.onResized=new ig.Signal,this.fps=i,this.clock=new ig.Timer,this.canvas=ig.$(e),this.context=this.canvas.getContext("2d"),this.getDrawPos=ig.System.drawMode,this.resize(t,s,n)},run:function(){ig.Timer.step(),ig.Timer.stepped&&(this.tick=this.clock.tick(),this.delegate.run(),ig.input.clearPressed(),this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null))},resize:function(i,t,s,n){var a;a=ig.ua.pixelRatio>1&&(!this.context.webkitBackingStorePixelRatio||this.context.webkitBackingStorePixelRatio>1)?ig.ua.pixelRatio:1,a=1,this.width=i*a,this.height=t*a,void 0!==s&&null!==s&&(this.scale=s),this.realWidth=this.width*this.scale,this.realHeight=this.height*this.scale,this.canvas.width=this.realWidth,this.canvas.height=this.realHeight,this.canvas.style.width=Math.round(this.realWidth/a)+"px",this.canvas.style.height=Math.round(this.realHeight/a)+"px",this.size=Math.min(this.width,this.height),
1!==this.scale&&e.AUTO_CRISP_SCALING&&(ig.System.scaleMode=ig.System.SCALE.CRISP),ig.System.scaleMode(this.canvas,this.context),this.onResized.dispatch(n)}})}),ig.baked=!0,ig.module("game.components.pacloader").requires("plusplus.core.loader").defines(function(){"use strict";ig.CONFIG,ig.utilsmath,ig.pacLoader=ig.LoaderExtended.extend({run:function(){Date.now()-this._endTime<100?this.draw():(ig.game.run(),ig.system.setDelegate(ig.game))}})}),ig.baked=!0,ig.module("plusplus.core.hierarchy").requires("plusplus.helpers.utils").defines(function(){"use strict";var e=ig.utils,i=0;ig.Hierarchy=ig.Class.extend({id:i++,name:"",descendants:[],descendantsMap:{},ancestor:null,sortBy:null,init:function(e){this.id=i++,this.sortBy=ig.Hierarchy.SORT.PRIORITY,ig.merge(this,e)},setAncestor:function(e){this.ancestor=e},setName:function(e){this.name!==e&&(this.ancestor instanceof ig.Hierarchy&&this.ancestor.unmapDescendant(this),this.name=e,this.ancestor instanceof ig.Hierarchy&&this.ancestor.mapDescendant(this))},setFallback:function(e){this.fallback=e},addDescendants:function(i){i=e.toArray(i);for(var t=0,s=i.length;t<s;t++)this.addDescendant(i[t])},addDescendant:function(e){if(e instanceof ig.Hierarchy){if(!0===this.isAncestor(e))return;void 0!==e.ancestor&&e.ancestor.removeDescendant(e),e.setAncestor(this)}this.mapDescendant(e),this.descendants.push(e),this.sortDescendants()},removeDescendants:function(i){i=e.toArray(i);for(var t=0,s=i.length;t<s;t++)this.removeDescendant(i[t])},removeDescendant:function(i){var t=e.indexOfValue(this.descendants,i);if(-1!==t)i instanceof ig.Hierarchy&&i.setAncestor(),this.descendants.splice(t,1),this.unmapDescendant(i);else for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];a instanceof ig.Hierarchy&&a.removeDescendant(i)}},clearDescendants:function(){for(var e=this.descendants.length-1;e>=0;e--){var i=this.descendants[e];i instanceof ig.Hierarchy&&i.setAncestor(),this.descendants.length--,this.unmapDescendant(i)}},sortDescendants:function(){this.descendants.sort(this.sortBy)},mapDescendant:function(e){if(e.name){var i=this.descendantsMap[e.name];i instanceof ig.Hierarchy&&i.ancestor.removeDescendant(i),this.descendantsMap[e.name]=e}},unmapDescendant:function(e){e.name&&e===this.descendantsMap[e.name]&&delete this.descendantsMap[e.name]},getDescendantByName:function(e,i){var t=this._getDescendantByName(e,i);return!t&&this.fallback&&(t=this.fallback._getDescendantByName(e,i)),t},_getDescendantByName:function(e,i){var t=this.descendantsMap[e];if(!0===i&&!t)for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];if(a instanceof ig.Hierarchy&&(t=a.getDescendantByName(e,i)))break}return t},getDescendantsByType:function(e,i){var t=this._getDescendantsByType(e,i,[]);return!t.length&&this.fallback&&(t=this.fallback._getDescendantsByType(e,i,t)),t},_getDescendantsByType:function(e,i,t){for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];a.type&e&&t.push(a),!0===i&&a instanceof ig.Hierarchy&&a._getDescendantsByType(name,i,t)}return t},getDescendants:function(i){i=e.toArray(i).concat(this.descendants);for(var t=0,s=this.descendants.length;t<s;t++){var n=this.descendants[t];n instanceof ig.Hierarchy&&(i=n.getDescendants(i))}return i},getRoot:function(){for(var e,i=this;i;)e=i,i=i.ancestor;return e},isAncestor:function(e){for(var i=this.ancestor;i;){if(i===e)return!0;i=i.ancestor}return!1},forAll:function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(this,i),this.forAllDescendants.apply(this,arguments)},forAllDescendants:function(e){for(var i=Array.prototype.slice.call(arguments,1),t=0,s=this.descendants.length;t<s;t++){var n=this.descendants[t];e.apply(n,i),n instanceof ig.Hierarchy&&n.forAllDescendants.apply(n,arguments)}},forAllWithCallback:function(e){var i=this[e];if("function"==typeof i){var t=Array.prototype.slice.call(arguments,1);i.apply(this,t)}this.forAllDescendantsWithCallback.apply(this,arguments)},forAllDescendantsWithCallback:function(e){for(var i=Array.prototype.slice.call(arguments,1),t=0,s=this.descendants.length;t<s;t++){var n=this.descendants[t],a=n[e];"function"==typeof a&&a.apply(n,i),n instanceof ig.Hierarchy&&n.forAllWithCallback.apply(n,arguments)}},forImmediate:function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(this,i);for(var t=0,s=this.descendants.length;t<s;t++)e.apply(this.descendants[t],i)},forImmediateWithCallback:function(e){var i=this[e];if("function"==typeof i){var t=Array.prototype.slice.call(arguments,1);i.apply(this,t)}for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];"function"==typeof(i=a[e])&&i.apply(a,t)}},activate:function(){for(var e=!1,i=!1,t="activate",s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];a[t].apply(a,arguments),i||!a.activated&&!a.getUsing()||(e=!0,a.blocking&&(i=!0,t="cleanup"))}return this.fallback&&(e=this.fallback[t].apply(a,arguments)||e),e},deactivate:function(){for(var e=0,i=this.descendants.length;e<i;e++)this.descendants[e].deactivate();this.fallback&&this.fallback.deactivate()},update:function(){for(var e=0,i=this.descendants.length;e<i;e++)this.descendants[e].update();this.fallback&&this.fallback.update()},cleanup:function(){for(var e=0,i=this.descendants.length;e<i;e++)this.descendants[e].cleanup();this.fallback&&this.fallback.cleanup()},setEntity:function(e){for(var i=0,t=this.descendants.length;i<t;i++)this.descendants[i].setEntity(e);this.fallback&&this.fallback.setEntity(e)},setEntityTarget:function(e){for(var i=0,t=this.descendants.length;i<t;i++)this.descendants[i].setEntityTarget(e);this.fallback&&this.fallback.setEntityTarget(e)},setEntityTargetFirst:function(e){for(var i=0,t=this.descendants.length;i<t;i++)this.descendants[i].setEntityTargetFirst(e);this.fallback&&this.fallback.setEntityTargetFirst(e)},setEntityOptions:function(e){for(var i=0,t=this.descendants.length;i<t;i++)this.descendants[i].setEntityOptions(e);this.fallback&&this.fallback.setEntityOptions(e)},getUsing:function(){for(var e=0,i=this.descendants.length;e<i;e++)if(this.descendants[e].getUsing())return!0;return!!this.fallback&&this.fallback.getUsing()},pause:function(){for(var e=0,i=this.descendants.length;e<i;e++)this.descendants[e].pause();this.fallback&&this.fallback.pause()},unpause:function(){for(var e=0,i=this.descendants.length;e<i;e++)this.descendants[e].unpause();this.fallback&&this.fallback.unpause()},clone:function(e){e instanceof ig.Hierarchy!=1&&(e=new ig.Hierarchy),e.name=this.name;for(var i=0,t=this.descendants.length;i<t;i++){var s=this.descendants[i];"function"==typeof s.clone&&e.addDescendant(s.clone())}return e}}),ig.Hierarchy.SORT={PRIORITY:function(e,i){return i.priority-e.priority},Z_INDEX:function(e,i){return i.zIndex-e.zIndex}}}),ig.baked=!0,ig.module("plusplus.abstractities.spawner-fast").requires("plusplus.abstractities.spawner","plusplus.helpers.utils","plusplus.helpers.utilsmath").defines(function(){var e=ig.utils,i=ig.utilsmath;ig.SpawnerFast=ig.global.SpawnerFast=ig.Spawner.extend({spawnNext:function(e){return this.pool.length>0?(e=this.pool.pop())&&(e=ig.game.spawnEntity(e,0,0,this.spawnSettings),this.entities.push(e)):this.spawningEntity&&this.spawnedCount<this.spawnCountMax&&(e=ig.game.spawnEntity(this.spawningEntity,0,0,this.spawnSettings),this.entities.push(e),this.linkSpawned(e)),e&&(this.spawnCount=Math.min(this.spawnCountMax,this.spawnCount+1),this.spawnedCount=Math.min(this.spawnCountMax,this.spawnedCount+1),this.spawned(e)),e},unspawn:function(i){i._killed?(this.spawnCount=Math.max(0,this.spawnCount-1),e.arrayCautiousRemove(this.entities,i),this.pool.push(i),this.activated&&-1===this.duration&&!this.spawning&&(this.spawnDelay>0||0===this.spawnCount)&&(this.spawnedCount=this.spawnCount,this.respawnTimer.set(this.respawnDelay),this._reactivate=!0)):i.kill(!0)},spawned:function(e){var t=e.size.x,s=e.size.y,n=this.size.x,a=this.size.y,o=this.pos.x,r=this.pos.y,h=o+n,l=r+a;e.pos.x=i.map(Math.random(),0,1,o,h-t)-.5*t,e.pos.y=i.map(Math.random(),0,1,r,l-s)-.5*s}})}),ig.baked=!0,ig.module("plusplus.abstractities.particle").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.entity").defines(function(){"use strict";var e=ig.CONFIG;ig.Particle=ig.EntityExtended.extend({animAutomatic:e.PARTICLE.ANIM_AUTOMATIC,animsExpected:["move"],zIndex:e.Z_INDEX_ABOVE_ALL,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,size:{x:1,y:1},maxVel:{x:150,y:150},friction:{x:20,y:0},minBounceVelocity:0,bounciness:.6,lifeDuration:1,fadeAfterSpawnDuration:0,fadeBeforeDeathDuration:.5,collisionKills:!1,collisionSticky:!1,randomVel:!0,randomDoubleVel:!0,randomFlip:!0,velocityFlip:!0,lifeTimer:null,_fadeAfterInv:0,_fadeBeforeDiff:0,_fadeBeforeInv:0,initProperties:function(){this.parent(),this.lifeTimer=new ig.Timer},resetExtras:function(){this.parent(),this.animAutomatic&&!this._animsPlaceheld&&(this._animsPlaceheld=!0,this.placeholdAnims()),this.fadeAfterSpawnDuration&&(this._fadeAfterInv=1/this.fadeAfterSpawnDuration),this.fadeBeforeDeathDuration&&(this._fadeBeforeInv=1/this.fadeBeforeDeathDuration,this._fadeBeforeDiff=this.lifeDuration-this.fadeBeforeDeathDuration)},placeholdAnims:function(){if(this.animsExpected.length>0){var e,i=this.anims;e=this.animInit instanceof ig.Animation?animInit:this.animInit&&i[this.animInit]?i[this.animInit]:i.idle||this.currentAnim;for(var t=0,s=this.animsExpected.length;t<s;t++){var n=this.animsExpected[t],a=i[n]||e;a&&(i[n+"X"]||(i[n+"X"]=a),i[n+"Right"]||(i[n+"Right"]=i[n+"X"]),i[n+"Left"]||(i[n+"Left"]=i[n+"X"]),i[n+"Y"]||(i[n+"Y"]=a),i[n+"Down"]||(i[n+"Down"]=i[n+"Y"]),i[n+"Up"]||(i[n+"Up"]=i[n+"Y"]))}}},ready:function(){this.lifeTimer.set(this.lifeDuration),this.randomVel&&(this.randomDoubleVel?(this.vel.x=(2*Math.random()-1)*this.vel.x,this.vel.y=(2*Math.random()-1)*this.vel.y):(this.vel.x*=Math.random(),this.vel.y*=Math.random())),this.currentAnim&&(this.randomFlip?(this.flip.x=Math.random()>.5,this.flip.y=Math.random()>.5):this.velocityFlip&&(this.canFlipX&&(this.flip.x=this.vel.x<0),this.canFlipY&&(this.flip.y=this.vel.y<0))),this.parent()},pause:function(){this.parent(),this.lifeTimer.pause()},unpause:function(){this.parent(),this.lifeTimer.unpause()},collideWith:function(e,i,t,s,n,a){this.parent(e,i,t,s,n,a),this.collisionKills?this.kill():!this.collisionSticky||e instanceof ig.Particle||(this.collides=ig.EntityExtended.COLLIDES.NEVER,this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE,this.moveTo(e,{offset:{x:this.pos.x+.5*this.size.x-(e.pos.x+.5*e.size.x),y:this.pos.y+.5*this.size.y-(e.pos.y+.5*e.size.y)}}))},handleMovementTrace:function(e){this.parent(e),this.collidingWithMap&&(this.collisionKills?this.kill():this.collisionSticky&&(this.applyAntiVelocity(),this.collides=ig.EntityExtended.COLLIDES.NEVER,this.performance=ig.EntityExtended.PERFORMANCE.STATIC))},update:function(){var e=this.lifeTimer.delta();if(e>=0)this.kill();else{var i=e+this.lifeDuration;this.alpha=(0!==this.fadeAfterSpawnDuration?Math.min(1,i*this._fadeAfterInv):1)-(0!==this.fadeBeforeDeathDuration?Math.max(0,(i-this._fadeBeforeDiff)*this._fadeBeforeInv):0)}this.parent()},recordChanges:function(i){this.parent(i),this.changed&&(e.TOP_DOWN||this.canFlipY?this.movingX?(this.facing.x=this.vel.x<0?-1:1,this.movingY?this.facing.y=this.vel.y<0?-1:1:this.facing.y=0):this.movingY&&(this.facing.x=0,this.facing.y=this.vel.y<0?-1:1):this.movingX&&(this.facing.x=this.vel.x<0?-1:1))},updateVisible:function(){this.animAutomatic&&!this._killed&&this.updateCurrentAnim(),this.parent()},updateCurrentAnim:function(){this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.currentAnim=this.anims[this.getDirectionalAnimName("move")])}})}),ig.baked=!0,ig.module("plusplus.abstractities.particle-fast").requires("plusplus.core.config","plusplus.abstractities.particle").defines(function(){"use strict";ig.CONFIG,ig.ParticleFast=ig.Particle.extend({type:ig.EntityExtended.TYPE.NONE,collides:ig.EntityExtended.COLLIDES.NEVER,checkAgainst:ig.EntityExtended.TYPE.NONE,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,highPerformance:!0,init:function(e,i,t){this.id=++ig.Entity._lastId,this.lifeTimer=new ig.Timer,this.onAdded=new ig.Signal,this.onRemoved=new ig.Signal,this.onMovedTo=new ig.Signal,this.reset(e,i,t)},reset:function(e,i,t){if(this.pos.x=e,this.pos.y=i,this.posDraw=this.pos,this.sizeDraw=this.size,ig.merge(this,t),this._killed=!1,this.changed=!0,this.moving=this.movingX=this.movingY=!0,!this.ignoreSystemScale){var s=Math.min(Math.max(Math.round(ig.system.scale*this.scaleOfSystemScale),this.scaleMin),this.scaleMax);this.scale!==s&&(this.scale=s)}this.scaleMod=this.scale/ig.system.scale,this.fadeAfterSpawnDuration&&(this._fadeAfterInv=1/this.fadeAfterSpawnDuration),this.fadeBeforeDeathDuration&&(this._fadeBeforeInv=1/this.fadeBeforeDeathDuration,this._fadeBeforeDiff=this.lifeDuration-this.fadeBeforeDeathDuration)},refresh:function(){},resetCore:function(){},resetExtras:function(){},recordResetState:function(){},ready:function(){this.lifeTimer.set(this.lifeDuration),this.randomVel&&(this.randomDoubleVel?(this.vel.x=(2*Math.random()-1)*this.vel.x,this.vel.y=(2*Math.random()-1)*this.vel.y):(this.vel.x*=Math.random(),this.vel.y*=Math.random())),this.currentAnim&&(this.randomFlip?(this.flip.x=Math.random()>.5,this.flip.y=Math.random()>.5):(this.canFlipX&&(this.flip.x=this.vel.x<0),this.canFlipY&&(this.flip.y=this.vel.y<0)))},spawn:function(){},tween:function(){throw new Error("Attempting to TWEEN fast particle but fast particle does not tween!")},collideWith:function(){throw new Error("Attempting to COLLIDE fast particle but fast particle does not collide!")},handleMovementTrace:function(){throw new Error("Attempting to TRACE COLLISION MAP fast particle but fast particle ignore collision map!")},kill:function(){this._killed||ig.game.removeEntity(this)},die:function(){},cleanup:function(){if(this.moveToStop(),this.onRemoved.dispatch(this),!ig.game.hasLevel){this.onAdded.removeAll(),this.onAdded.forget(),this.onRemoved.removeAll(),this.onRemoved.forget(),this.onMovedTo.removeAll(),this.onMovedTo.forget();for(var e in this.anims){var i=this.anims[e];i.onCompleted.removeAll(),i.onCompleted.forget()}}},update:function(){if(this.paused)ig.game.camera&&!ig.game.camera.paused&&(this.visible=this.getIsVisible());else if(!this._killed){var e=this.lifeTimer.delta();if(e>=0)return this.kill();var i=e+this.lifeDuration;this.alpha=(0!==this.fadeAfterSpawnDuration?Math.min(1,i*this._fadeAfterInv):1)-(0!==this.fadeBeforeDeathDuration?Math.max(0,(i-this._fadeBeforeDiff)*this._fadeBeforeInv):0),this.movingTo?this.moveToUpdate():(this.pos.x+=this.vel.x*ig.system.tick,this.pos.y+=this.vel.y*ig.system.tick),this.getIsVisible()?(this.visible=!0,this.currentAnim.update()):this.visible=!1}},getIsVisible:function(){if(this.alpha<=0)return!1;var e=this.posDraw.x-ig.game.screen.x,i=this.posDraw.y-ig.game.screen.y;return!(e<0||i<0||e+this.sizeDraw.x>ig.system.width||i+this.sizeDraw.y>ig.system.height)},recordChanges:function(){throw new Error("Attempting to RECORD CHANGES in fast particle but fast particle is always changed!")},recordLast:function(){throw new Error("Attempting to RECORD LAST of fast particle but fast particle doesn't record last!")},updateBounds:function(){throw new Error("Attempting to UPDATE BOUNDS of fast particle but fast particle does not update bounds!")},draw:function(){if(this.visible){var e=this.currentAnim,i=e.sheet,t=i.image;if(t.loaded){t._scale!==this.scale&&t.resize(this.scale);var s=this.scale,n=i.width,a=i.height,o=Math.floor(n*s),r=Math.floor(a*s);1!==this.alpha?(ig.system.context.globalAlpha=this.alpha,ig.system.context.drawImage(t.data,Math.floor(e.tile*n)%t.width*s,Math.floor(e.tile*n/t.width)*a*s,o,r,ig.system.getDrawPos(this.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(this.posDraw.y-ig.game.screen.y),o,r),ig.system.context.globalAlpha=1):ig.system.context.drawImage(t.data,Math.floor(e.tile*n)%t.width*s,Math.floor(e.tile*n/t.width)*a*s,o,r,ig.system.getDrawPos(this.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(this.posDraw.y-ig.game.screen.y),o,r),ig.Image.drawCount++}}}})}),ig.baked=!0,ig.module("plusplus.entities.particle-color").requires("plusplus.core.config","plusplus.abstractities.particle-fast").defines(function(){"use strict";var e=ig.CONFIG;ig.EntityParticleColor=ig.global.EntityParticleColor=ig.ParticleFast.extend({size:{x:2,y:2},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"particles.png",2,2),animTileOffset:0,animSequenceCount:7,vel:{x:50,y:50},lifeDuration:.35,fadeBeforeDeathDuration:.15,_animTileOffsetLast:-1,reset:function(e,i,t){this.parent(e,i,t),this._animTileOffsetLast!==this.animTileOffset&&(this._animTileOffsetLast=this.animTileOffset,this.addAnim("move",{sequence:[Math.round(Math.random()*this.animSequenceCount)+this.animTileOffset*(this.animSequenceCount+1)],frameTime:1,stop:!0}))}}),ig.EntityParticleColor.colorOffsets={RED:0,YELLOW:4,GREEN:8,BLUE:12,PURPLE:16,BROWN:20,GRAY:24,WHITE:28}}),ig.baked=!0,ig.module("plusplus.entities.explosion").requires("plusplus.abstractities.spawner-fast","plusplus.entities.particle-color").defines(function(){"use strict";ig.EntityExplosion=ig.global.EntityExplosion=ig.SpawnerFast.extend({spawningEntity:ig.EntityParticleColor,spawnCountMax:3,spawnSettings:{vel:{x:100,y:100},animTileOffset:ig.EntityParticleColor.colorOffsets.YELLOW},activated:!0})}),ig.baked=!0,ig.module("plusplus.abstractities.character").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.entity","plusplus.core.hierarchy","plusplus.entities.explosion","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsintersection","plusplus.helpers.utilsvector2","plusplus.helpers.tweens","plusplus.helpers.pathfinding").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils,t=ig.utilsmath,s=ig.utilsintersection,n=ig.utilsvector2,a=ig.pathfinding;ig.Character=ig.EntityExtended.extend({performance:ig.EntityExtended.PERFORMANCE.MOVABLE,targetable:!0,animAutomatic:e.CHARACTER.ANIM_AUTOMATIC,animsExpected:["idle","move","stairs","climb","jump","fall"],size:{x:e.CHARACTER.SIZE_EFFECTIVE_X,y:e.CHARACTER.SIZE_EFFECTIVE_Y},offset:{x:e.CHARACTER.SIZE_OFFSET_X,y:e.CHARACTER.SIZE_OFFSET_Y},maxVelUngrounded:{x:e.CHARACTER.MAX_VEL_UNGROUNDED_X,y:e.CHARACTER.MAX_VEL_UNGROUNDED_Y},maxVelGrounded:{x:e.CHARACTER.MAX_VEL_GROUNDED_X,y:e.CHARACTER.MAX_VEL_GROUNDED_Y},maxVelClimbing:{x:e.CHARACTER.MAX_VEL_CLIMBING_X,y:e.CHARACTER.MAX_VEL_CLIMBING_Y},frictionUngrounded:{x:e.CHARACTER.FRICTION_UNGROUNDED_X,y:e.CHARACTER.FRICTION_UNGROUNDED_Y},frictionGrounded:{x:e.CHARACTER.FRICTION_GROUNDED_X,y:e.CHARACTER.FRICTION_GROUNDED_Y},speed:{x:e.CHARACTER.SPEED_X,y:e.CHARACTER.SPEED_Y},canJump:e.CHARACTER.CAN_JUMP&&!e.TOP_DOWN,jumpSteps:e.CHARACTER.JUMP_STEPS,jumpForce:e.CHARACTER.JUMP_FORCE,jumpControl:e.CHARACTER.JUMP_CONTROL,canClimb:e.CHARACTER.CAN_CLIMB&&!e.TOP_DOWN,climbingControl:e.CHARACTER.CLIMBING_CONTROL,movingFrom:!1,moveToUnsafe:!1,canPathfind:e.CHARACTER.CAN_PATHFIND,path:[],pathfindingDelay:e.CHARACTER.PATHFINDING_DELAY,pathfindingUpdateDelay:e.CHARACTER.PATHFINDING_UPDATE_DELAY,pathfindingSimpleDelay:e.CHARACTER.PATHFINDING_SIMPLE_DELAY,pathingTimer:null,stuck:!1,stuckDelay:e.CHARACTER.STUCK_DELAY,stuckTimer:null,health:e.CHARACTER.HEALTH,healthMax:e.CHARACTER.HEALTH,energy:e.CHARACTER.ENERGY,energyMax:e.CHARACTER.ENERGY,damageDelay:0,damageTimer:null,temporaryInvulnerabilityPulses:2,temporaryInvulnerabilityAlpha:.5,regen:!1,regenDelay:0,regenTimer:null,regenRateHealth:e.CHARACTER.REGEN_RATE_HEALTH,regenAsPctHealth:!1,regenRateEnergy:e.CHARACTER.REGEN_RATE_ENERGY,regenAsPctEnergy:!1,regenHealth:!0,regenEnergy:!0,mimicLevel:e.RANKS_MAP.NONE,explodingDamage:e.CHARACTER.EXPLODING_DAMAGE,damageSettings:{spawnCountMax:e.CHARACTER.EXPLODING_DAMAGE_PARTICLE_COUNT,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.WHITE}},explodingDeath:e.CHARACTER.EXPLODING_DEATH,deathSettings:{spawnCountMax:e.CHARACTER.EXPLODING_DEATH_PARTICLE_COUNT,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.WHITE}},abilities:null,abilitiesOriginal:null,slopeSticking:e.CHARACTER.SLOPE_STICKING,falling:!1,ungroundedFor:0,ungroundedForThreshold:e.CHARACTER.UNGROUNDED_FOR_THRESHOLD,ungroundedForAndFallingThreshold:e.CHARACTER.UNGROUNDED_FOR_AND_FALLING_THRESHOLD,withinClimbables:!1,withinClimbablesAbove:!1,withinStairs:!1,withinOneWay:!1,jumping:!1,jumpAscend:!1,climbing:!1,needsNewPath:!1,_jumpPushing:!1,_jumpWhileClimbing:!1,_climbingIntentDown:!1,_climbingIntentUp:!1,_cleanIntentDown:!1,_cleanIntentUp:!1,_temporarilyInvulnerable:!1,_temporarilyInvulnerablePulsing:!1,_positionsPathfinding:{from:{x:.1,y:.1},target:{x:.1,y:.1}},_boundsPathfollow:{},initTypes:function(){this.parent(),i.addType(ig.EntityExtended,this,"type","CHARACTER")},initProperties:function(){this.parent(),this.regenTimer=new ig.Timer,this.damageTimer=new ig.Timer,this.pathingTimer=new ig.Timer,this.stuckTimer=new ig.Timer,this.abilities=this.abilitiesOriginal=new ig.Hierarchy},resetExtras:function(){this.parent(),this.energyMax=this.energy,this.moveToStop(),this.applyAntiVelocity(),this.animAutomatic&&this.animsExpected.length>0&&!this._animsPlaceheld&&(this._animsPlaceheld=!0,this.placeholdAnims())},placeholdAnims:function(){var e,i=this.anims;e=this.animInit instanceof ig.Animation?animInit:this.animInit&&i[this.animInit]?i[this.animInit]:i.idle||this.currentAnim;for(var t=0,s=this.animsExpected.length;t<s;t++){var n=this.animsExpected[t],a=i[n]||e;a&&(i[n+"X"]||(i[n+"X"]=a),i[n+"Right"]||(i[n+"Right"]=i[n+"X"]),i[n+"Left"]||(i[n+"Left"]=i[n+"X"]),i[n+"Y"]||(i[n+"Y"]=a),i[n+"Down"]||(i[n+"Down"]=i[n+"Y"]),i[n+"Up"]||(i[n+"Up"]=i[n+"Y"]))}},recordResetState:function(){this.parent(),this.resetState.controllable=this.controllable,this.resetState.energy=this.energy},ready:function(){var e=this;this.abilities.forAllDescendants(function(){this.setEntity(e)}),this.temporaryInvulnerability(),this.removeControl(),this.parent()},spawn:function(){this.parent(),this.resetState.controllable&&this.addControl()},removeControl:function(){this.parent(),this.moveToStop(),this.jumpEnd(),this.climbEnd()},pause:function(){this.parent(),this.regenTimer.pause(),this.damageTimer.pause(),this.pathingTimer.pause(),this.stuckTimer.pause(),this.abilities.pause()},unpause:function(){this.parent(),this.regenTimer.unpause(),this.damageTimer.unpause(),this.pathingTimer.unpause(),this.stuckTimer.unpause(),this.abilities.unpause()},setGrounded:function(i){e.TOP_DOWN?(this.standing=this.grounded=!0,this.falling=!1):(this.standing=this.grounded=this.hasGravity,this.falling=!1,this.climbing||i||(this.slopeSticking&&this.hasGravity?this.vel.y=this.maxVelGrounded.y:this.vel.y=0))},setUngrounded:function(){e.TOP_DOWN||(this.grounded=this.standing=this.falling=!1)},moveTo:function(e,i){var t=this.parent(e,i);return t&&(this.needsNewPath=!0,this.pathingTimer&&this.pathingTimer.set(0)),t},moveFrom:function(e,i){var t=this.moveTo(e,i);return t&&(this.movingFrom=!0),t},moveToUpdate:function(){this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC?this.movingTo&&(this.canPathfind?(this.needsNewPath=this.movingTo.changed||this.changed||this.moveToUnsafe||this.needsNewPath,this.movedTo&&!this.needsNewPath||(this.findMoveToPath(),this.moveToPath())):this.lookAt(this.movingTo)):this.parent()},findMoveToPath:function(e){if(this.pathingTimer.delta()>=0&&(0===this.path.length||this.needsNewPath)){this.needsNewPath=this.movedTo=this.moveToUnsafe=!1,e=e||this.movingToSettings;var i,s,n,o,r,h;if(e&&(i=e.simple,s=e.avoidEntities,n=e.unsafe,o=e.avoidSlopes,r=e.searchDistance,h=e.alwaysKeepFirst),i){var l,g;if(this.movingTo instanceof ig.EntityExtended){var c=ig.pathfinding.getPositionPathfindingEntities(this,this.movingTo,this._positionsPathfinding);l=c.from,g=c.target}else g=this.movingTo,l=a.getPositionPathfindingPoint(this,this.movingTo.x,this.movingTo.y,this._positionsPathfinding.from);var u=g.x-l.x,d=g.y-l.y;if(this.movingFrom&&(u=-u,d=-d),0!==u&&(u=u*u<this.size.x*this.size.x*.25?0:t.direction(u)),0!==d&&(d=d*d<this.size.y*this.size.y*.25?0:t.direction(d)),this.hasGravity&&(0!==u&&0!==d&&d*d<u*u*2&&(d=0),!o)){var m=a.getEntityOnSmoothSlope(this,u);m&&0===d&&(d=a.getSlopeDirectionY(this,u))}var p=n||m?a.getNode(l.x,l.y,u,d):a.getWalkableNode(l.x,l.y,u,d,s,this);p?this.path[0]=p:(this.clearPath(),this.moveToUnsafe=!0),this.pathingTimer.set(this.pathfindingSimpleDelay)}else if(this.movingFrom?this.movingTo instanceof ig.EntityExtended?this.path=a.getPathAwayFromEntity(this,this.movingTo,s,r):this.path=a.getPathAwayFromPoint(this,this.movingTo.x,this.movingTo.y,s,r):this.movingTo instanceof ig.EntityExtended?this.path=a.getPathToEntity(this,this.movingTo,s,r):this.path=a.getPathToPoint(this,this.movingTo.x,this.movingTo.y,s,r),0===this.path.length)this.clearPath(),this.pathingTimer.set(this.pathfindingDelay);else if(this.pathingTimer.set(this.pathfindingUpdateDelay),this.path.length>1&&!h){var p=this.path[this.path.length-1];if(!p.corner||this._lastCornerNode===p)return void this.path.length--;var f=this.path[this.path.length-2],y=this.pos.x+.5*this.size.x,E=this.pos.y+.5*this.size.y;(p.x<y&&f.x>y||p.x>y&&f.x<y||p.y<E&&f.y>E||p.y>E&&f.y<E)&&this.path.length--,this.path.length&&this._lastNode!==this.path[this.path.length-1]&&(this._boundsPathfollow.ignoreCornerX=this._boundsPathfollow.ignoreCornerY=!1)}}},moveToPath:function(e,i){if(e=e||this.path)if(0===e.length||this.stuck&&this.stuckTimer.delta()>=0)this.moveToComplete();else{this.changed?this.stuck=!1:this.stuck||(this.stuckTimer.set(this.stuckDelay),this.stuck=!0),i=i||this.movingToSettings;var t,n;i&&(t=i.unsafe,n=i.avoidUngrounded);var o=e.length,r=this._lastNode=e[o-1],h=r.x,l=r.y,g=this.size.x,c=this.size.y,u=this.pos.x,d=this.pos.y,m=a.getBoundsPathfollowing(u,d,g,c,r,!this.hasGravity,this._boundsPathfollow),p=Math.round(m.minX),f=Math.round(m.maxX),y=Math.round(m.minY),E=Math.round(m.maxY);if(r.corner?s.pointInAABB(h,l,p,y,f,E):this.jumping&&r.ungrounded&&o>1?u<=h&&u+g>=h:s.pointInAABB(h,l,u,d,u+g,d+c))return r.corner?this._lastCornerNode=r:this._lastCornerNode=null,this._boundsPathfollow.ignoreCornerX=this._boundsPathfollow.ignoreCornerY=!1,1===e.length?this.moveToComplete():(e.length--,this.moveToPath(e));g=m.width,c=m.height;var v=Math.round(p+.5*g),T=Math.round(y+.5*c);if(this.hasGravity){var I,A=p<=h&&f>=h;if(!this.jumping&&(y<=l&&E>=l?this.moveToHereVertical():T<l?(this.canClimb&&this.climbDown(),this.climbing||this.moveToDown()):T>l&&(this.moveToUnsafe=!t&&r.ungrounded,this.withinClimbables&&this.canClimb?(this.moveToUnsafe=!1,this.climbUp()):this.canJump&&(this.moveToUnsafe=!1,this.jump())),!t&&r.ungrounded&&(!r.oneWay||r.oneWayFacing.y>=0)&&n&&(this.grounded||this.climbing)))for(I=r.neighborMap.bottom;I&&(I=I.neighborMap.bottom,I.walkable&&!(I.oneWay&&I.oneWayFacing.y<0));)if(I.y>this.pos.y+this.size.y){this.moveToUnsafe=!0;break}if(this.moveToUnsafe)return this.moveToComplete();A?(this.moveToHereHorizontal(),!this.jumping||r.ungrounded&&r.x!==e[0].x||(v<h?this.moveToRight():v>h&&this.moveToLeft())):v<h?this.moveToRight():v>h&&this.moveToLeft()}else y<=l&&E>=l?this.moveToHereVertical():T<l?this.moveToDown():T>l&&this.moveToUp(),p<=h&&f>=h?this.moveToHereHorizontal():v<h?this.moveToRight():v>h&&this.moveToLeft()}},clearPath:function(){this.stuck=!1,this.path.length>0&&(this.path.length=0)},moveToLeft:function(e){this.accel.x=e?-this.speed.x*e:-this.speed.x,this.flip.x=this.canFlipX,this.moving&&(this.movingY||(this.facing.y=0),this.facing.x=-1)},moveToRight:function(e){this.accel.x=e?this.speed.x*e:this.speed.x,this.flip.x=!1,this.moving&&(this.movingY||(this.facing.y=0),this.facing.x=1)},moveToUp:function(i){this.accel.y=i?-this.speed.y*i:-this.speed.y,this.flip.y=this.canFlipY,this.moving&&(e.TOP_DOWN||this.canFlipY)&&(this.movingX||(this.facing.x=0),this.facing.y=-1)},moveToDown:function(i){this.accel.y=i?this.speed.y*i:this.speed.y,this.flip.y=!1,this.moving&&(e.TOP_DOWN||this.canFlipY)&&(this.movingX||(this.facing.x=0),this.facing.y=1)},moveToHereHorizontal:function(){this.accel.x=0},moveToHereVertical:function(){this.accel.y=0},moveToHere:function(){this.clearPath(),this.moveToHereHorizontal(),this.moveToHereVertical()},moveToSequenceNext:function(){this.movingToSequence&&(this.movingToSequence.length>0?this.movingFrom?(this.movingTo=null,this.movingFrom=!1,this.moveFrom(this.movingToSequence.shift(),this.movingToSettings)):(this.movingTo=null,this.moveTo(this.movingToSequence.shift(),this.movingToSettings)):(this.movingToSequence=void 0,this.moveToComplete(),this.moveToStop()))},moveToComplete:function(){this.pathingTimer&&this.pathingTimer.set(0),this.moveToHere(),this.parent()},moveToStop:function(){this.moveToHere(),this.movingFrom=!1,this.parent()},manageStart:function(){this.parent(),this.moveToStop()},jump:function(){this.canJump&&(this.climbing&&(this._jumpWhileClimbing=!0,this.climbEnd()),(this.grounded||this.canClimb&&this.withinClimbables||this.ungroundedFor<this.ungroundedForThreshold)&&!0!==this.jumping&&(this.jumping=this._jumpPushing=!0,this.jumpStepsRemaining=this.jumpSteps))},jumpUpdate:function(){!0===this.jumping&&(this._jumpPushing&&this.jumpPush(),this.vel.y>=0&&(this.jumpAscend=!1),this._jumpPushing||this.jumpAscend||!(this.grounded||this._jumpWhileClimbing&&this.withinClimbables)||this.jumpEnd())},jumpPush:function(){this.jumpStepsRemaining>0&&(this.jumpStepsRemaining===this.jumpSteps&&(this.setUngrounded(),this.applyAntiVelocityY()),this.jumpAscend=!0,this.jumpStepsRemaining--,this.moveToUp(this.jumpForce),this.jumpStepsRemaining<=0&&(this._jumpPushing=!1,this.moveToHereVertical()))},jumpEnd:function(){this.jumping=this._jumpPushing=!1,this.jumpStepsRemaining=0,this._jumpWhileClimbing&&(this._jumpWhileClimbing=!1,this.climb())},climb:function(){this.canClimb&&this.withinClimbables&&(this.jumping&&this.jumpEnd(),!0!==this.climbing&&(this._climbingIntentUp&&this.withinClimbablesAbove||this._climbingIntentDown&&!this.grounded)&&(this.setUngrounded(),this.climbing=!0,this.jumping||this.applyAntiVelocityY()))},climbUp:function(){this._climbingIntentUp=!0,this._cleanIntentUp=!1,this.climb(),this.climbing&&this.moveToUp()},climbDown:function(){this._climbingIntentDown=!0,this._cleanIntentDown=!1,this.climb(),this.climbing&&this.moveToDown()},climbUpdate:function(){this.climbing&&(this.applyAntiGravity(),(!this.withinClimbables||this.grounded&&this.vel.y>=0)&&this.climbEnd()),this._climbingIntentDown&&(this._cleanIntentDown?this._cleanIntentDown=this._climbingIntentDown=!1:this._cleanIntentDown=!0),this._climbingIntentUp&&(this._cleanIntentUp?this._cleanIntentUp=this._climbingIntentUp=!1:this._cleanIntentUp=!0)},climbEnd:function(){!1!==this.climbing&&(this.climbing=!1,!this.jumping&&this.vel.y<0&&this.applyAntiVelocityY())},receiveDamage:function(e,i,t){var s=this.parent(e,i,t);return s&&!this._killed&&(this.explodingDamage&&this.explode(),t||this.temporaryInvulnerability()),s},explode:function(e){ig.game.spawnEntity(ig.EntityExplosion,this.pos.x,this.pos.y,ig.merge({size:{x:this.size.x,y:this.size.y}},e||this.damageSettings))},receiveHealing:function(e,i){this.health=Math.min(this.healthMax,this.health+e)},drainEnergy:function(e,i,t){return!(this.invulnerable&&!t||(this.energy=Math.max(0,this.energy-e),0))},receiveEnergy:function(e,i){this.energy=Math.min(this.energyMax,this.energy+e)},restoreStats:function(e){this.receiveHealing(this.healthMax-this.health,e),this.receiveEnergy(this.energyMax-this.energy,e)},regenerate:function(){this.regenHealth&&this.receiveHealing(this.regenRateHealth*(this.regenAsPctHealth?this.healthMax:1),this),this.regenEnergy&&this.receiveEnergy(this.regenRateEnergy*(this.regenAsPctEnergy?this.energyMax:1),this)},temporaryInvulnerability:function(e){if(void 0===e&&(e=this.damageDelay),!this.invulnerable&&e>0&&(this.damageTimer.set(e),this.invulnerable=this._temporarilyInvulnerable=!0,1===this.alpha&&this.temporaryInvulnerabilityAlpha<1&&this.temporaryInvulnerabilityPulses>0)){
this._temporarilyInvulnerablePulsing=!0;var i=this.tween({alpha:this.temporaryInvulnerabilityAlpha},{name:"invulnerableHide",duration:1e3*e/(2*this.temporaryInvulnerabilityPulses),noComplete:!0,stopped:!0}),t=this.tween({alpha:1},{name:"invulnerableShow",duration:1e3*e/(2*this.temporaryInvulnerabilityPulses),noComplete:!0,stopped:!0});i.chain(t),t.chain(i),i.start()}},temporaryInvulnerabilityEnd:function(){this._temporarilyInvulnerable&&(this._temporarilyInvulnerablePulsing&&(this.tweenEnd("invulnerableHide"),this.tweenEnd("invulnerableShow"),this._temporarilyInvulnerablePulsing=!1,this.alpha=1),this.invulnerable=this._temporarilyInvulnerable=!1)},kill:function(e){this.controllable=!1,this.parent(e)},die:function(){this.temporaryInvulnerabilityEnd(),!this.dieingSilently&&this.explodingDeath&&this.explode(this.deathSettings),this.parent()},cleanup:function(){this.moveToUnsafe=!1,this._lastNode=this._lastCornerNode=null,this.parent()},cleanupCollision:function(){this.parent(),this.withinOneWay=this.withinClimbables=this.withinClimbablesAbove=this.withinStairs=!1},intersectWith:function(e){this.parent(),e.oneWay&&(this.withinOneWay=!0),e.climbable&&(this.withinClimbables=!0,this.withinStairs=e.climbableStairs,e.pos.y<Math.round(this.pos.y+.9*this.size.y)&&(this.withinClimbablesAbove=!0))},getIsCollidingWithOneWay:function(e){var i=this.parent(e);if(i&&e.climbable){if(this._climbingIntentDown&&e.oneWayFacing.y<0)return this.withinClimbables=!0,this.withinStairs=e.climbableStairs,this.grounded=!1,this.climbDown(),!1;if(this._climbingIntentUp&&e.oneWayFacing.y>0)return this.withinClimbables=this.withinClimbablesAbove=!0,this.withinStairs=e.climbableStairs,this.climbUp(),!1}return i},collideWith:function(e,i,t,s,n,a){this.parent(e,i,t,s,n,a),a&&this!==a||(t<0&&this.jumping&&this.jumpEnd(),this.changed&&this.updateVisible())},updateChanges:function(){this.parent(),this._temporarilyInvulnerable&&this.invulnerable&&this.damageTimer.delta()>=0&&this.temporaryInvulnerabilityEnd(),this.regen&&this.regenTimer.delta()>=0&&(this.regenTimer.set(this.regenDelay),this.regenerate()),this.abilities.update(),this.jumpUpdate(),this.climbUpdate(),!this.hasGravity||this.grounded||this.climbing?this.ungroundedFor=0:(this.ungroundedFor+=ig.system.tick,this.ungroundedFor>this.ungroundedForAndFallingThreshold&&(this.falling=!0))},updateVelocity:function(){var e;this.climbing?(n.copy(this.maxVel,this.maxVelClimbing),e=this.climbingControl):this.grounded?(n.copy(this.maxVel,this.maxVelGrounded),e=1):(n.copy(this.maxVel,this.maxVelUngrounded),e=this.jumpControl),this.standing||this.climbing?n.copy(this.friction,this.frictionGrounded):n.copy(this.friction,this.frictionUngrounded),this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x*e,this.friction.x,this.maxVel.x),this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y*e,this.friction.y,this.maxVel.y)},updateVisible:function(){this.animAutomatic&&!this._killed&&this.updateCurrentAnim(),this.parent()},updateCurrentAnim:function(){var e,i=this.anims;if(this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC){if(!0===this.climbing){if(!this.withinStairs)return this.currentAnim=i[this.getDirectionalAnimName("climb")],this.currentAnim.stop=!this.moving,this.currentAnim.reverse=this.vel.y>0,!0;if(this.moving)return this.currentAnim=i[this.getDirectionalAnimName("stairs")],!0}else if(!this.grounded){if(this.jumping)return e=i[this.getDirectionalAnimName("jump")],this.currentAnim!==e&&(this.currentAnim=e,this.currentAnim.playFromStart(!0)),!0;if(this.falling)return this.currentAnim=i[this.getDirectionalAnimName("fall")],!0}if(this.moving)return this.currentAnim=i[this.getDirectionalAnimName("move")],!0}e=i[this.getDirectionalAnimName("idle")],this.currentAnim!==e&&(this.currentAnim=e,this.currentAnim.playFromStart())}})}),ig.baked=!0,ig.module("plusplus.abilities.ability").requires("plusplus.core.timer","plusplus.core.entity","plusplus.abstractities.particle","plusplus.helpers.utils","plusplus.helpers.utilsintersection","plusplus.helpers.signals").defines(function(){"use strict";var e=ig.utils,i=ig.utilsintersection,t=0;ig.Ability=ig.Class.extend({id:t++,name:"",type:0,paused:!1,blocking:!0,priority:0,enabled:!0,entity:null,entityOptions:null,entityTarget:null,movable:!1,autoStopMoving:!0,once:!1,activated:!1,needsDeactivate:!1,activateToggle:!1,activateStrict:!0,channelled:!1,channelling:!1,costActivate:0,costChannel:0,cooldownDelay:0,cooldownTimer:null,castTimer:null,requiresTarget:!1,canFindTarget:!1,canTargetSelf:!0,canTargetOthers:!0,canTargetFixed:!1,rangeX:0,rangeY:0,typeTargetable:0,groupTargetable:0,faceTarget:!0,retainTarget:!1,regenBlocking:!0,rank:0,upgrades:[],casting:!1,activateCastSettings:null,activatePassCastSettings:null,activateSetupCastSettings:null,deactivateCastSettings:null,deactivateSetupCastSettings:null,failCastSettings:null,failReason:"",onActivated:null,onDeactivated:null,onFailed:null,_activating:!1,_deactivating:!1,_regenBlocked:!1,_entityTargetRetained:!1,init:function(i,s){this.id=t++,s&&!ig.global.wm&&("string"==typeof s.typeTargetable&&(e.addType(ig.EntityExtended,this,"typeTargetable",s.typeTargetable),delete s.typeTargetable),"string"==typeof s.groupTargetable&&(e.addType(ig.EntityExtended,this,"groupTargetable",s.groupTargetable,"GROUP"),delete s.groupTargetable),ig.merge(this,s)),this.initTypes(),this.initProperties(),this.initUpgrades(),this.setEntity(i)},initTypes:function(){},initProperties:function(){this.castTimer=new ig.Timer,this.cooldownTimer=new ig.Timer,this.onActivated=new ig.Signal,this.onDeactivated=new ig.Signal,this.onFailed=new ig.Signal},initUpgrades:function(){},activate:function(){if(this.enabled){if(this.activateToggle&&(this.needsDeactivate||this.activated))return this.deactivate.apply(this,arguments);if(!this._activating&&!this.channelling&&(this.activated=!1,this.assert(this.cooledDown(),ig.Ability.FAIL.COOLDOWN)))return this.activateSetup.apply(this,arguments)}},activatePlain:function(){return this.activate()},execute:function(){return console.warn("DEPRECATED: ig.Ability.execute has been replaced by ig.Ability.activate, and ig.Ability.activate's previous functionality is now handled by ig.Ability.activateComplete."),this.activate.apply(arguments,this)},activateSetup:function(){if(!this._activating){if(this.castEnd(),this._deactivating=!1,this.needsDeactivate=this._activating=!0,this.faceTarget&&this.entity.lookAt(this.entityTarget),!this.activateSetupCastSettings)return this.activateTry.apply(this,arguments);this.cast(this.activateSetupCastSettings,this.activateTry,arguments)}},activateTry:function(){if(0===this.costActivate){if(this.assert(this.hasTarget(),ig.Ability.FAIL.TARGET)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE)){if(!this.activatePassCastSettings)return this.activatePass.apply(this,arguments);this.cast(this.activatePassCastSettings,this.activatePass,arguments)}}else if(this.assert(this.hasTarget(),ig.Ability.FAIL.TARGET)&&this.assert(this.canPayCost(this.costActivate),ig.Ability.FAIL.COST)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE)){if(this.extractCost(this.costActivate),!this.activatePassCastSettings)return this.activatePass.apply(this,arguments);this.cast(this.activatePassCastSettings,this.activatePass,arguments)}},activatePass:function(){if(!this.activatePassCastSettings||!this.activateStrict||this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.activateComplete.apply(this,arguments)},activateComplete:function(){this._activating=this._deactivating=!1,this.needsDeactivate=!0,this.activated=this.once||this.channelled,this.onActivated.dispatch(this),this.cooldownDelay>0&&this.cooldownTimer.set(this.cooldownDelay),this.activateCastSettings?this.cast(this.activateCastSettings,this.channelled?this.channelTry:null):(this.castEnd(),this.channelled&&this.channelTry()),this.dropEntityTarget()},deactivate:function(){return this.deactivateSetup.apply(this,arguments)},deactivateSetup:function(){if(this.needsDeactivate&&!this._deactivating){if(this._deactivating=!0,this.activated=this._activating=this.needsDeactivate=!1,this.channelling&&this.channelStop(),this.castEnd(),!this.deactivateSetupCastSettings||this.entity._killed)return this.deactivateComplete.apply(this,arguments);this.cast(this.deactivateSetupCastSettings,this.deactivateComplete,arguments)}},deactivateComplete:function(){this._deactivating=!1,this.onDeactivated.dispatch(this),this.deactivateCastSettings&&!this.entity._killed?this.cast(this.deactivateCastSettings):this.castEnd(),this.dropEntityTarget()},cleanup:function(){this.castEnd();var e=this.deactivateSetupCastSettings,i=this.deactivateCastSettings;this.deactivateCastSettings=this.deactivateSetupCastSettings=null;var t=this.deactivate.apply(this,arguments);return this.deactivateSetupCastSettings=e,this.deactivateCastSettings=i,ig.game.hasLevel||(this.onActivated.removeAll(),this.onActivated.forget(),this.onDeactivated.removeAll(),this.onDeactivated.forget(),this.onFailed.removeAll(),this.onFailed.forget()),t},cleanupPlain:function(){return this.cleanup()},pause:function(){this.paused=!0,this.castTimer.pause(),this.cooldownTimer.pause()},unpause:function(){this.paused=!1,this.castTimer.unpause(),this.cooldownTimer.unpause()},setEnabled:function(e){void 0===e&&(e=!0),e?this.enable():this.disable()},enable:function(){this.enabled=!0},disable:function(){if(this.enabled=!1,this.needsDeactivate||this.activated)return this.deactivateSetup(arguments)},cooledDown:function(){return this.cooldownDelay<=0||this.cooldownTimer.delta()>=0},cast:function(e,i,t){if(e){var s,n;e.async||(s=i,n=t);var a=e.animName;a&&!e.animOmniDirectional&&(a=this.entity.getDirectionalAnimName(a));var o=e.animSettings||{};if(a&&!e.delay&&(o.loop||o.lock||o.stop||o.frame&&this.entity.anims[a]&&this.entity.anims[a].stop)&&(e.delay=1),e.delay)this.castStart(e,s,n),this.castTimer.set(e.delay),a&&(void 0===o.loop&&(o.loop=!0),this.entity.animOverride(a,o));else if(a){this.castStart(e,s,n);var r=o.callback,h=o.context;o.callback=function(){this.castComplete(),r&&r.call(h||this)},o.context=this,this.entity.animOverride(a,o)}else this.castEffects(e.effects),s&&s.apply(this,n);e.async&&i&&i.apply(this,t)}else i&&i.apply(this,t)},castStart:function(e,i,t){this.castEnd(),this.casting=!0,this.castSettings=e,this.castInternalCallback=i,this.castInternalArgs=t,this.autoStopMoving&&this.getInterrupted()&&this.entity.moveAllStop(),this.castEffects(e.effects)},castUpdate:function(){this.castSettings&&this.castSettings.delay&&this.castTimer.delta()>=0?this.castComplete():this.failReason||this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)},castComplete:function(){var e=this.castSettings,i=this.castInternalCallback,t=this.castInternalArgs;this.castEnd(),this.failReason="",e&&e.callback&&e.callback.apply(e.context||this,e.settings),i&&i.apply(this,t)},castEnd:function(){if(this.casting||this.castSettings){if(this.casting=!1,this.castSettings){var e=this.castSettings.effects;if(e)for(var i=0,t=e.length;i<t;i++)this.effectEnd(e[i]);var s=this.castSettings.animName;s&&(this.castSettings.animOmniDirectional||(s=this.entity.getDirectionalAnimName(s)),this.entity.animRelease(s,!0))}this.castSettings=this.castInternalCallback=this.castInternalArgs=void 0}},castEffects:function(e){if(e&&e.length)for(var i=0,t=e.length;i<t;i++)this.effectStart(e[i])},effectStart:function(e){var i=e.settings||{};if(!e.ignoreDuration){if(this.castSettings)if(this.castSettings.delay)i.lifeDuration=this.castSettings.delay;else if(this.castSettings.animName){var t=this.entity.anims[this.castSettings.animName];t&&(i.lifeDuration=t.frameTime*t.sequence.length)}e.fade&&(i.fadeBeforeDeathDuration=i.fadeBeforeDeathDuration||0)}if(!e.followTarget||this.entityTarget){var s=e.entity=ig.game.spawnEntity(e.entityClass,0,0,i);e.followSettings?(void 0===e.followSettings.flipWith&&(e.followSettings.flipWith=!0),e.followTarget?this.entityTarget&&s.moveTo(this.entityTarget,e.followSettings):s.moveTo(this.entity,e.followSettings)):!1!==e.center&&(s.pos.x=this.entity.pos.x+.5*(this.entity.size.x-s.size.x),s.pos.y=this.entity.pos.y+.5*(this.entity.size.y-s.size.y))}},effectEnd:function(e){!e.entity||e.entity._killed||this.failReason!==ig.Ability.FAIL.INTERRUPT&&e.entity instanceof ig.Particle||(e.entity.kill(),e.entity=void 0)},update:function(){this.enabled&&!this.paused&&(this.casting&&this.castUpdate(),this.activated&&this.channelled&&this.channelTry(arguments))},channelTry:function(e){if(!this.channelling&&this.autoStopMoving&&this.getInterrupted()&&this.entity.moveAllStop(),0===this.costChannel){if(this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.channel.apply(this,e)}else if(this.assert(this.canPayCost(this.costChannel),ig.Ability.FAIL.COST)&&this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.extractCost(this.costChannel),this.channel.apply(this,e);return this.deactivate.apply(this,e)},channel:function(){!this.channelling&&this.regenBlocking&&(this.channelling=!0,this.blockRegen(this.entity)),this.faceTarget&&this.entity.lookAt(this.entityTarget)},channelStop:function(){this.channelling=!1,this.unblockRegen(this.entity)},getUsing:function(){return this.casting||this.channelling},getActivelyUsing:function(){return this.activated||this.getUsing()},getInterrupted:function(){return this.entity.moving&&!(this.movable||this.castSettings&&this.castSettings.movable)},blockRegen:function(e){e.regenEnergy&&(this._regenBlocked=!0,e.regenEnergy=!1)},unblockRegen:function(e){this._regenBlocked&&(e.regenEnergy=!0,this._regenBlocked=!1)},setEntity:function(e){this.entity&&(this.entity.onRemoved.remove(this.cleanupPlain,this),this.entity.onAdded.remove(this.activatePlain,this),this.cleanup()),this.entity=e,this.entity&&(this.entity.onRemoved.add(this.cleanupPlain,this),this.type&ig.Ability.TYPE.PASSIVE&&(this.entity.added?this.activatePlain():this.entity.onAdded.addOnce(this.activatePlain,this)))},setEntityOptions:function(e){this.entityOptions=e},setEntityTarget:function(e){(!e||this.entityTarget!==e&&this.isEntityTargetable(e))&&(this.entityTarget=e,this._entityTargetRetained=!1)},isEntityTargetable:function(e){return(!e.fixed||this.canTargetFixed)&&(!this.typeTargetable||(e.type&this.typeTargetable)===this.typeTargetable&&!(this.entity.group&e.group))&&(!this.groupTargetable||(e.group&this.groupTargetable)===this.groupTargetable)&&(this.canTargetOthers&&this.entity!==e||this.canTargetSelf&&this.entity===e)},setEntityTargetFirst:function(e){if(e&&e.length)for(var i=0,t=e.length;i<t&&(this.setEntityTarget(e[i]),!this.entityTarget);i++);else this.setEntityTarget()},setClosestEntityTarget:function(){if(this.rangeX>0||this.rangeY>0){this.entityTarget&&this.setEntityTarget();var e=i.entitiesInAABB(this.entity.pos.x-this.rangeX,this.entity.pos.y-this.rangeY,this.entity.pos.x+this.entity.size.x+this.rangeX,this.entity.pos.y+this.entity.size.y+this.rangeY,!0);this.setEntityTargetFirst(e)}},dropEntityTarget:function(){this.entityTarget&&(this.isEntityTargetDroppable()?this.setEntityTarget():this._entityTargetRetained=!0)},isEntityTargetDroppable:function(){return!(this.activated&&this.channelled||this.retainTarget)},hasTarget:function(){return!this.requiresTarget||(this.canFindTarget&&!this.entityTarget&&this.setClosestEntityTarget(),!!this.entityTarget)},hasValidTarget:function(){return!this.requiresTarget||this.entityTarget},closeEnough:function(){if(this.requiresTarget){if(this.entityTarget){var e=this.entityTarget.type&ig.EntityExtended.TYPE.INTERACTIVE;if(0===this.rangeX&&0===this.rangeY||e&&0===this.entityTarget.rangeInteractableX&&0===this.entityTarget.rangeInteractableY)return!0;var t,s;e?(t=Math.max(this.rangeX,this.entityTarget.rangeInteractableX),s=Math.max(this.rangeY,this.entityTarget.rangeInteractableY)):(t=this.rangeX,s=this.rangeY);var n=i.AABBIntersect(this.entityTarget.pos.x,this.entityTarget.pos.y,this.entityTarget.pos.x+this.entityTarget.size.x,this.entityTarget.pos.y+this.entityTarget.size.y,this.entity.pos.x-t,this.entity.pos.y-s,this.entity.pos.x+this.entity.size.x+t,this.entity.pos.y+this.entity.size.y+s);return this.faceTarget&&this.entity.lookAt(this.entityTarget),n}return!1}return!0},assert:function(e,i){return e?this.failReason="":this.fail(i),e},fail:function(e){if(this.failReason=e||ig.Ability.FAIL.UNKNOWN,this._activating=this._deactivating=!1,this.failReason===ig.Ability.FAIL.INTERRUPT)this.castEnd();else{var i=this.failCastSettings;if(i){if(i.effects)for(var t=0,s=i.effects.length;t<s;t++){var n=i.effects[t];n.settings=n.settings||{},n.settings.animInit=this.failReason}this.failCastSettings?this.cast(this.failCastSettings):this.castEnd()}}this.onFailed.dispatch(this),this.dropEntityTarget()},canPayCost:function(e){return!this.entity.hasOwnProperty("energy")||this.entity.invulnerable||this.entity.energy>=e},extractCost:function(e){this.entity.drainEnergy&&this.entity.drainEnergy(e,this)},addUpgrades:function(i){e.arrayCautiousAddMulti(this.upgrades,i)},upgrade:function(i){!0===i?i=this.upgrades.length:e.isNumber(i)||(i=this.rank+1),this.changegrade(i)},downgrade:function(i){!0===i?i=0:e.isNumber(i)||(i=this.rank-1),this.changegrade(i)},changegrade:function(e){var i=this.upgrades.length,t=e<this.rank?-1:1,s=this.rank+t;for(this.rank!==e&&this.cleanup();this.rank!==e&&s<i&&s>=0;){this.rank=s;var n=this.upgrades[s],a=this.entity,o=this.entityOptions||a;"function"==typeof n?n.call(this,a,o):ig.merge(this,n),s+=t}},clone:function(e){return e instanceof ig.Ability!=1&&(e=new ig.Ability),e.name=this.name,e.type=this.type,e.enabled=this.enabled,e.costActivate=this.costActivate,e.costDeactivate=this.costDeactivate,e.costChannel=this.costChannel,e.requiresTarget=this.requiresTarget,e.canFindTarget=this.canFindTarget,e.canTargetSelf=this.canTargetSelf,e.canTargetOthers=this.canTargetOthers,e.typeTargetable=this.typeTargetable,e.rangeX=this.rangeX,e.rangeY=this.rangeY,e.retainTarget=this.retainTarget,e.rank=this.rank,e.upgrades=this.upgrades.slice(0),e.regenBlocking=this.regenBlocking,e.setEntityOptions(this.entityOptions),e.setEntity(this.entity),e}}),ig.Ability.TYPE,e.getType(ig.Ability,"PASSIVE"),e.getType(ig.Ability,"SPAMMABLE"),e.getType(ig.Ability,"TOGGLEABLE"),ig.Ability.FAIL={UNKNOWN:"unknown",COST:"cost",TARGET:"target",DISTANCE:"distance",COOLDOWN:"cooldown",INTERRUPT:"interrupt"}}),ig.baked=!0,ig.module("plusplus.abilities.interact").requires("plusplus.core.config","plusplus.abilities.ability","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils;ig.AbilityInteract=ig.Ability.extend({rangeX:e.CHARACTER.SIZE_EFFECTIVE_X,rangeY:.5*e.CHARACTER.SIZE_EFFECTIVE_Y,requiresTarget:!0,canFindTarget:!1,canTargetSelf:!1,initTypes:function(){this.parent(),i.addType(ig.Ability,this,"type","INTERACT"),i.addType(ig.EntityExtended,this,"typeTargetable","INTERACTIVE")},activateComplete:function(){this.entityTarget.toggleActivate(this.entity),this.parent()}})}),ig.baked=!0,ig.module("plusplus.abstractities.player").requires("plusplus.core.config","plusplus.abstractities.character","plusplus.abilities.interact","plusplus.helpers.utils","plusplus.helpers.utilsmath").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utils;ig.Player=ig.Character.extend({name:"player",zIndex:e.Z_INDEX_PLAYER,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,collides:ig.EntityExtended.COLLIDES.LITE,persistent:!0,damageDelay:1,initTypes:function(){this.parent(),i.addType(ig.EntityExtended,this,"type","PLAYER DAMAGEABLE MIMICABLE"),i.addType(ig.EntityExtended,this,"group","PLAYER FRIEND","GROUP")},initProperties:function(){this.parent(),ig.global.wm||(this.abilityInteract=new ig.AbilityInteract(this),this.abilities.addDescendant(this.abilityInteract))},spawn:function(){this.parent(),this.checkAutomaticUtilities()},checkAutomaticUtilities:function(){ig.game.playerManager&&!ig.game.playerManager.entity&&ig.game.playerManager.autoManagePlayer&&ig.game.playerManager.managePlayer(),ig.game.camera&&!ig.game.camera.entity&&ig.game.camera.autoFollowPlayer&&ig.game.camera.followPlayer()},handleInput:function(){var e,i,t,s;if(!this.jumping&&ig.input.released("tap"))for(t=ig.input.getInputPoints(["tapped"],[!0]),e=0,i=t.length;e<i;e++)s=t[e],this.abilityInteract.setEntityTargetFirst(s.targets),!this.abilityInteract.entityTarget||this.abilityInteract.entityTarget.type&ig.EntityExtended.TYPE.UI&&this.abilityInteract.entityTarget.fixed||this.abilityInteract.activate()}})}),ig.baked=!0,ig.module("plusplus.ui.ui-text-bubble").requires("plusplus.core.config","plusplus.ui.ui-overlay","plusplus.helpers.utilsvector2","plusplus.helpers.utilsdraw","plusplus.helpers.utilsintersection").defines(function(){"use strict";var e=ig.CONFIG,i=ig.utilsvector2,t=ig.utilsdraw;ig.UITextBubble=ig.global.UITextBubble=ig.UIOverlay.extend({layerName:"ui",size:{x:e.TEXT_BUBBLE.SIZE_X,y:e.TEXT_BUBBLE.SIZE_Y},sizeAsPct:e.TEXT_BUBBLE.SIZE_AS_PCT,sizePct:{x:e.TEXT_BUBBLE.SIZE_PCT_X,y:e.TEXT_BUBBLE.SIZE_PCT_Y},cornerRadius:e.TEXT_BUBBLE.CORNER_RADIUS,cornerRadiusAsPct:e.TEXT_BUBBLE.CORNER_RADIUS_AS_PCT,r:e.TEXT_BUBBLE.R,g:e.TEXT_BUBBLE.G,b:e.TEXT_BUBBLE.B,alpha:e.TEXT_BUBBLE.ALPHA,pixelPerfect:e.TEXT_BUBBLE.PIXEL_PERFECT,shrinkToText:e.TEXT_BUBBLE.SHRINK_TO_TEXT,triangleLength:e.TEXT_BUBBLE.TRIANGLE_LENGTH,triangleWidth:e.TEXT_BUBBLE.TRIANGLE_WIDTH,padding:{x:e.TEXT_BUBBLE.PADDING_X,y:e.TEXT_BUBBLE.PADDING_Y},resetExtras:function(){this.textSettings&&(this.textSettings.font=this.textSettings.font||ig.Font.FONTS.CHAT,this.textSettings.margin={x:0,y:this.padding.y-this.triangleLength},this.textSettings.marginAsPct=!1),this.textMoveToSettings=ig.merge(this.textMoveToSettings,{offset:{x:0,y:this.padding.y-this.triangleLength}}),this.sizeAsPct||(this.resetState.size=this.resetState.size||{x:0,y:0},i.copy(this.resetState.size,this.size)),this.parent()},recordResetState:function(){this.parent(),this.resetState.size=this.resetState.size||{x:0,y:0},i.copy(this.resetState.size,this.size),this.resetState.sizePct=this.resetState.sizePct||{x:0,y:0},i.copy(this.resetState.sizePct,this.sizePct)},refresh:function(e){this.sizeAsPct||i.copy(this.size,this.resetState.size),this.message&&this.message.added&&this.added&&(this.message.maxWidth=this.message.maxHeight=0,this.message.refresh(e)),this.parent(e),this.message&&this.message.linkedTo!==this&&this.message.refresh(e)},resize:function(e){var e=this.parent(e);if(this.message){var i=this.message.scale/this.scale,t=this.getSizeDrawX()-2*this.padding.x,s=this.getSizeDrawY()-2*this.padding.y-this.triangleLength,n=this.message.getSizeDrawX()*i;n>t&&(this.message.maxWidth=t*(1/i),this.message.resize(!0),n=this.message.getSizeDrawX()*i);var a=this.message.getSizeDrawY()*i;a>s&&(this.message.maxHeight=s*(1/i),this.message.resize(!0),a=this.message.getSizeDrawY()*i),this.shrinkToText&&(n<t&&(this.size.x=n+2*this.padding.x,e=this.needsRebuild=!0),a<s&&(this.size.y=a+2*this.padding.y+this.triangleLength,e=this.needsRebuild=!0))}return e},refill:function(){if(this.fill&&this.triangleLength>0){var e=this.triangleLength,i=this.triangleWidth,s=this.sizeDraw.x,n=this.sizeDraw.y-e;this.parent(s,n),this.pixelPerfect||(s*=this.scale,n*=this.scale,e*=this.scale,i*=this.scale);var a=[{x:.5*s-.5*i,y:n},{x:.5*s+.5*i,y:n},{x:.5*s,y:n+e}],o=this.fill.dataContext;this.pixelPerfect?t.pixelFillPolygon(o,0,0,this.fill.width,this.fill.height,a,this.r,this.g,this.b,this.alpha):(o.fillStyle=this.getFillStyle(),t.fillPolygon(o,a))}else this.parent()}})}),ig.baked=!0,ig.module("plusplus.entities.conversation").requires("plusplus.core.timer","plusplus.ui.ui-text","plusplus.ui.ui-text-bubble","plusplus.entities.trigger","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.utils;ig.EntityConversation=ig.global.EntityConversation=ig.EntityTrigger.extend({_wmBoxColor:"rgba(200, 200, 200, 0.7)",steps:{},stepsSorted:[],stepsUnused:[],stepsUsed:[],step:null,message:null,messageEntity:ig.UIText,messageContainer:null,messageContainerEntity:ig.UITextBubble,messageSettings:{},messageFollowsSpeaker:!0,messageMoveToSettings:{matchPerformance:!0,offsetPct:{x:0,y:-1.3}},speaker:null,speakerLast:null,participate:{},participating:[],looking:!0,pausing:!1,locking:!1,lockingPlayer:!1,interrupting:!0,animNameTalk:"talk",animNameListen:"listen",cameraFollows:!0,cameraCentered:!1,autoAdvance:!0,advanceTimer:null,durationPerLetter:.1,durationPerStepMin:1,action:"tap",triggerAfterDelay:!0,autoComplete:!1,_order:0,_step:null,_speakersModified:[],_cameraWasFollowing:null,initProperties:function(){this.parent(),this.advanceTimer=new ig.Timer},resetExtras:function(){this.stepsSorted.length=0;for(var i in this.steps){var t=this.steps[i],s=parseInt(t.order);e.isNumber(s)||(s=t.order=parseInt(i)),e.isNumber(s)?s>this._order&&(this._order=s):s=t.order=++this._order,this._addStep(t)}this.parent()},addStep:function(i,t,s,n){if(i&&i.length>0){e.isNumber(s)?s>this._order&&(this._order=s):s=++this._order;var a=this.steps[s]={name:t,text:i,order:s,settings:n};this._addStep(a)}},_addStep:function(e){this.stepsSorted.push(e),this.stepsSorted.sort(function(e,i){return e.order-i.order}),this.activated&&(this._addUnusedStep(e),this.stepsUnused.sort(function(e,i){return e.order-i.order}))},setup:function(){var i,t;if(this.pausing&&!this.action&&(this.pausing=!1,this.autoAdvance=!0),this.interrupting){var s={};for(i=0,t=this.stepsSorted.length;i<t;i++){var n=this.stepsSorted[i],a=ig.game.namedEntities[n.name],o=a&&a.conversation;o&&o!==this&&!s[o.id]&&o instanceof ig.EntityConversation&&o.activated&&(s[o.id]=!0,o.deactivate())}}if(this.pausing&&(ig.game.pause(!0),ig.game.camera&&ig.game.camera.unpause(),this.unpause()),this.lockingPlayer){var r=ig.game.getPlayer();r&&r.removeControl()}for(this.stepsUnused.length=this.stepsUsed.length=this.participating.length=this._speakersModified.length=0,i=0,t=this.stepsSorted.length;i<t;i++)this._addUnusedStep(this.stepsSorted[i]);this._speakersModified.length=0;for(var h in this.participate){var l=ig.game.namedEntities[this.participate[h]];l&&e.arrayCautiousAdd(this.participating,l)}this.nextStep(),this.parent()},teardown:function(){this.hideStep(),this.speakerLast=null,this.stepsUnused.length=this.stepsUsed.length=this.participating.length=this._speakersModified.length=0;for(var i in this.steps){var t=this.steps[i],s=ig.game.namedEntities[t.name];s&&-1===e.indexOfValue(this._speakersModified,t.name)&&(this._speakersModified.push(t.name),s.conversation=void 0,(t.locking||this.locking)&&s.addControl(),s.animRelease(s.getDirectionalAnimName(t.animNameTalk||this.animNameTalk)),s.animRelease(s.getDirectionalAnimName(t.animNameListen||this.animNameListen)))}if(this._speakersModified.length=0,ig.game.camera&&(ig.game.camera.onTransitioned.remove(this.complete,this),this._cameraWasFollowing=null),this.lockingPlayer){var n=ig.game.getPlayer();n&&n.addControl()}this.pausing&&ig.game.unpause(!0),this.parent()},_addUnusedStep:function(i){this.stepsUnused.push(i);var t=i.name,s=ig.game.namedEntities[t];if(s&&-1===e.indexOfValue(this._speakersModified,i.name)&&(this._speakersModified.push(t),this.participating.push(s),s.conversation=this,this.pausing&&s.unpause(),i.locking||this.locking)){s.removeControl();var n;(n=void 0!==i.animNameListen?i.animNameListen:this.animNameListen)&&s.animOverride(s.getDirectionalAnimName(n),{loop:!0})}},nextStep:function(){if(this.hideStep(),this.stepsUnused.length>0)if(this._step=this.stepsUnused.shift(),this.stepsUsed.push(this._step),this._step.name){if(this.speaker=ig.game.namedEntities[this._step.name],this.speaker){var e=this._step.locking||this.locking;if(e){var i;(i=void 0!==this._step.animNameTalk?this._step.animNameTalk:this.animNameTalk)&&this.speaker.animOverride(this.speaker.getDirectionalAnimName(i),{loop:!0})}if(this.looking)for(var t=0,s=this.participating.length;t<s;t++){var n=this.participating[t];n!==this.speaker&&n.lookAt(this.speaker)}(this.pausing||this.lockingPlayer||e)&&ig.game.camera&&this.cameraFollows&&this.speaker!==this.speakerLast?(this._cameraWasFollowing||(this._cameraWasFollowing=ig.game.camera.entity),this._cameraFollowing=this.speaker,ig.game.camera.onTransitioned.addOnce(this.showStep,this),ig.game.camera.follow(this.speaker,!1,this.cameraCentered)):this.showStep()}}else this.showStep();else ig.game.camera&&this.cameraFollows&&this._cameraWasFollowing?(ig.game.camera.onTransitioned.addOnce(this.complete,this),ig.game.camera.follow(this._cameraWasFollowing,!1,!0),this._cameraWasFollowing=null):this.complete()},showStep:function(){if(this._step&&this._step.text){var e=this.messageSettings;this.speaker&&this.messageFollowsSpeaker&&(e.fixed=e.fixed||!1);var i;this.messageContainerEntity?(e.textSettings={text:this._step.text},i=this.messageContainer=ig.game.spawnEntity(this.messageContainer||this.messageContainerEntity,0,0,ig.merge(e,this._step.settings))):(e.text=this._step.text,i=this.message=ig.game.spawnEntity(this.message||this.messageEntity,0,0,ig.merge(e,this._step.settings))),i.added?this.activateStep():i.onAdded.addOnce(this.activateStep,this)}else this.activateStep()},activateStep:function(){if(this._step){this.step=this._step,this._step=void 0;var e,i;if(this.messageContainer?(e=this.messageContainer,i=this.message=e.message):e=i=this.message,i){if(i.textOverflow){var t=i.textOverflow;i.text=i.textDisplay||i.text,i.textOverflow="";var s=ig.merge({},this.step);this.step.text=i.text,s.text=t,this._addStep(s)}this.speaker&&this.messageFollowsSpeaker&&(e.unpause(),e.moveTo(this.speaker,this.messageMoveToSettings),(this.pausing||this.locking||this.lockingPlayer||this.step.locking)&&ig.game.camera&&this.cameraFollows&&!e.fixed&&(this._cameraWasFollowing||(this._cameraWasFollowing=ig.game.camera.entity),this._cameraFollowing=e,ig.game.camera.follow(e,!1,this.cameraCentered))),this.autoAdvance&&this.advanceTimer.set(Math.max(this.step.text.length*this.durationPerLetter,this.durationPerStepMin))}else this.advanceTimer.set(this.durationPerStepMin)}},hideStep:function(){if(this.messageContainer&&(this.messageContainer.onAdded.remove(this.activateStep,this),this.messageContainer._killed||ig.game.removeEntity(this.messageContainer),this.messageContainer=null),this.message&&(this.message.onAdded.remove(this.activateStep,this),this.message._killed||ig.game.removeEntity(this.message),this.message=null),this.speaker){if(this.stepsUnused.length>0){if(this.locking||this.step&&this.step.locking){var e;(e=this.step&&void 0!==this.step.animNameListen?this.step.animNameListen:this.animNameListen)&&this.speaker.animOverride(this.speaker.getDirectionalAnimName(e),{loop:!0})}this.speakerLast=this.speaker}else this.speaker.animRelease(this.speaker.getDirectionalAnimName(this.step.animNameTalk||this.animNameTalk)),this.speaker.animRelease(this.speaker.getDirectionalAnimName(this.step.animNameListen||this.animNameListen));this.speaker=null}ig.game.camera&&this.cameraFollows&&(ig.game.camera.onTransitioned.remove(this.showStep,this),ig.game.camera&&this._cameraFollowing&&ig.game.camera.entity===this._cameraFollowing&&ig.game.camera.unfollow(),this._cameraFollowing=null),this.step=this._step=null},pause:function(){this.parent(),this.advanceTimer.pause()},unpause:function(){this.parent(),this.advanceTimer.unpause()},update:function(){this.step&&(this.speaker&&this.speaker._killed?this.nextStep():(this.autoAdvance||this.step&&!this.step.text)&&this.advanceTimer.delta()>=0?this.nextStep():(ig.input.pressed(this.action)||ig.input.released(this.action))&&this.nextStep()),this.parent()}})}),ig.baked=!0,ig.module("game.entities.player").requires("plusplus.abstractities.player","plusplus.core.config","plusplus.entities.conversation").defines(function(){var e=ig.CONFIG;ig.EntityPlayer=ig.global.EntityPlayer=ig.Player.extend({name:"player",collides:ig.Entity.COLLIDES.ACTIVE,size:{x:8,y:8},offset:{x:28,y:67},temporaryInvulnerabilityAlpha:1,
animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"helmut.png",64,96),animInit:"moveDown",animSettings:{idleX:{frameTime:.1,sequence:[0]},idleDown:{frameTime:1,sequence:[9]},idleUp:{frameTime:1,sequence:[18]},moveX:{frameTime:.1,sequence:[0,1,2,3,4]},moveDown:{frameTime:.1,sequence:[9,10,11,12,13,14,15,16,17]},moveUp:{frameTime:.1,sequence:[18,19,20,21,22,23,24,25,26]}},dance:function(){},speak:function(e,i){ig.game.getEntitiesByClass(ig.EntityConversation)[0]&&ig.game.getEntitiesByClass(ig.EntityConversation)[0].kill();var t=ig.game.spawnEntity(ig.EntityConversation,0,0);t.durationPerLetter=.05,t.messageMoveToSettings={matchPerformance:!0,offset:{x:0,y:-60},align:{x:.5,y:1}},t.addStep(e,"player",1),i&&t.addStep(i,"player",2),t.activate()}})}),ig.baked=!0,ig.module("game.entities.inventory-item-lemon").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemLemon=ig.global.EntityInventoryItemLemon=ig.EntityExtended.extend({name:"Monsterzitrone",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-lemon.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Eine riesige Zitrone ... unglaublich!"):"Rede"===e?ig.game.getPlayer().speak("Na Zitrone, bist du SAUER auf mich."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.start").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-lemon").defines(function(){var e=ig.CONFIG;ig.EntityStart=ig.global.EntityStart=ig.EntityExtended.extend({size:{x:81,y:9},matchingInventoryItem:ig.EntityInventoryItemLemon,animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"start.gif",81,9),animInit:"blink",animSettings:{blink:{frameTime:.9,sequence:[0,1]}}})}),ig.baked=!0,ig.module("game.entities.cursor").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityCursor=ig.global.EntityCursor=ig.EntityExtended.extend({name:"cursor",performance:"moveable",size:{x:14,y:14},layerName:"cursor",cursorOffset:{x:-6,y:-6},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/cursor.png",14,14),animInit:"blink",animSettings:{blink:{frameTime:.2,sequence:[0,1,2,0]}},repositionCursor:function(){this.pos={x:ig.input.mouse.x+ig.game.screen.x+this.cursorOffset.x,y:ig.input.mouse.y+ig.game.screen.y+this.cursorOffset.y}},update:function(){this.parent(),this.repositionCursor()}})}),ig.baked=!0,ig.module("game.levels.titlescreen").requires("impact.image","game.entities.start","game.entities.cursor").defines(function(){LevelTitlescreen={entities:[{type:"EntityStart",x:120,y:160},{type:"EntityCursor",x:52,y:120}],layer:[{name:"background",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/title-screen.gif ",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920],[921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960],[961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3]]}]},LevelTitlescreenResources=[new ig.Image("media/title-screen.gif ")]}),ig.baked=!0,ig.module("game.levels.ending").requires("impact.image").defines(function(){LevelEnding={entities:[],layer:[{name:"background",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/ending.gif",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920],[921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960],[961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3]]}]},LevelEndingResources=[new ig.Image("media/ending.gif")]}),ig.baked=!0,ig.module("game.entities.item-mirror").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemMirror=ig.global.EntityItemMirror=ig.EntityExtended.extend({name:"Spiegel",collides:ig.Entity.COLLIDES.FIXED,size:{x:8,y:8},interactionDistance:6,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Boah, die zweite Flasche Vodka hätte ich stecken lassen sollen."):"Benutze"===e?ig.game.getPlayer().speak("Boah, die zweite Flasche Vodka hätte ich stecken lassen sollen."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Scherben bringen zwar Glück, aber das ist keine gute Idee.")}})}),ig.baked=!0,ig.module("game.entities.player-spawner").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityPlayerSpawner=ig.global.EntityPlayerSpawner=ig.EntityExtended.extend({name:"spawner",_wmBoxColor:"rgba(0, 255, 0, 0.7)",size:{x:8,y:8}})}),ig.baked=!0,ig.module("game.entities.item-bookshelf").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemBookshelf=ig.global.EntityItemBookshelf=ig.EntityExtended.extend({name:"Bücherregal",collides:ig.Entity.COLLIDES.NEVER,_wmScalable:!0,size:{x:8,y:8},interactionDistance:9,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Der Bücherregal, er hat viele Bücher."):"Benutze"===e?ig.game.getPlayer().speak("Ich habe jetzt keine Lust zu lesen."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Drücke"===e||"Ziehe"===e?ig.game.getPlayer().speak("Bewegt sich kein Stück."):"Nimm"===e?ig.game.getPlayer().speak("Festgeschraubt."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.inventory-item-gumex").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemGumex=ig.global.EntityInventoryItemGumex=ig.EntityExtended.extend({name:"Kaugummi-Ex",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-gumex.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Damit kann man Kaugummis entfernen. Wie nützlich!"):"Rede"===e?ig.game.getPlayer().speak("Was ist grau und gestreift? Ein Klebra!"):"Öffne"===e?ig.game.getPlayer().speak("Boah, das Zeug stinkt! Das mache ich schnell wieder zu."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-bed").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-gumex").defines(function(){ig.CONFIG,ig.EntityItemBed=ig.global.EntityItemBed=ig.EntityExtended.extend({name:"Bett",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},persistent:!0,state:"full",matchingInventoryItem:ig.EntityInventoryItemGumex,interactionDistance:12,interact:function(e){"Schau"===e?"full"===this.state?ig.game.getPlayer().speak("Unter dem Bett liegt etwas, aber ich komme nicht ran."):ig.game.getPlayer().speak("Ein Bett. Unglaublich!"):"Nimm"===e?ig.game.getPlayer().speak("Nein, ich habe selber eins zu Hause."):"Benutze"===e?ig.game.getPlayer().speak("Ich bin nicht müde."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Ziehe"===e||"Drücke"===e?ig.game.getPlayer().speak("Hmpf ... zu schwer."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Stock"===e.name?(ig.game.getPlayer().speak("Mit dem Stock konnte ich ein komisches Fläschen unter dem Bett rausholen.","Leider ist der Stock dabei zerbrochen."),this.state="empty",ig.game.inventory.removeInventoryItem(e),ig.game.inventory.addItem(this.matchingInventoryItem)):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-pictures").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemPictures=ig.global.EntityItemPictures=ig.EntityExtended.extend({name:"Bilder",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:4,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Eine Frau, eine Wiese und ein Berg."):"Benutze"===e?ig.game.getPlayer().speak("Und wie?"):"Nimm"===e?ig.game.getPlayer().speak("Nein, die finde ich gruselig."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-lamp").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemLamp=ig.global.EntityItemLamp=ig.EntityExtended.extend({name:"Lampe",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:16,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Der Lampe, er ist von IKEA."):"Benutze"===e?ig.game.getPlayer().speak("Nein, noch ist es hell genug."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Nimm"===e?ig.game.getPlayer().speak("Die lasse ich besser wo sie ist."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("plusplus.entities.levelchange").requires("plusplus.entities.trigger").defines(function(){ig.EntityLevelchange=ig.global.EntityLevelchange=ig.EntityTrigger.extend({_wmBoxColor:"rgba(0, 0, 255, 0.7)",levelName:"",playerSpawnerName:"",clearPersistentPlayer:!1,clearPersistentEntities:!1,activate:function(e){if(this.parent(e),this.clearPersistentEntities)ig.game.clearPersistentEntities();else if(this.clearPersistentPlayer){var i=ig.game.getPlayer(),t="player";i&&(t=i.name||t),ig.game.clearPersistentEntity(t)}ig.game.loadLevelDeferred(this.levelName,this.playerSpawnerName)}})}),ig.baked=!0,ig.module("game.levels.testroom").requires("impact.image","game.entities.item-mirror","game.entities.player-spawner","game.entities.item-bookshelf","game.entities.item-bed","game.entities.item-pictures","game.entities.item-lamp","game.entities.cursor","plusplus.entities.levelchange","game.entities.player").defines(function(){LevelTestroom={entities:[{type:"EntityItemMirror",x:148,y:12,settings:{size:{x:24,y:24}}},{type:"EntityPlayerSpawner",x:60,y:104,settings:{name:"spawner-a"}},{type:"EntityItemBookshelf",x:40,y:4,settings:{size:{x:80,y:40}}},{type:"EntityPlayerSpawner",x:24,y:112,settings:{name:"spawner-b"}},{type:"EntityItemBed",x:72,y:96,settings:{size:{x:48,y:24}}},{type:"EntityItemPictures",x:184,y:56,settings:{size:{x:24,y:16}}},{type:"EntityItemLamp",x:184,y:48,settings:{size:{x:16,y:8}}},{type:"EntityCursor",x:108,y:72},{type:"EntityLevelchange",x:-116,y:-20,settings:{size:{x:124,y:188},name:"Zaun",levelName:"testroom2",playerSpawnerName:"spawner-b"}},{type:"EntityPlayer",x:120,y:99}],layer:[{name:"background",width:40,height:23,linkWithCollision:!1,visible:1,tilesetName:"media/Thimbleweed.png",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920]]},{name:"collision",width:40,height:23,linkWithCollision:!1,visible:0,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"pathfinding",width:40,height:23,linkWithCollision:!1,visible:1,tilesetName:"media/pathfindingtiles_plusplus_8.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!0,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,4,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelTestroomResources=[new ig.Image("media/Thimbleweed.png"),new ig.Image("media/pathfindingtiles_plusplus_8.png")]}),ig.baked=!0,ig.module("game.levels.testroom2").requires("impact.image","game.entities.item-mirror","game.entities.player-spawner","game.entities.item-bookshelf","game.entities.item-bed","game.entities.item-pictures","game.entities.item-lamp","game.entities.cursor","plusplus.entities.levelchange","game.entities.player").defines(function(){LevelTestroom2={entities:[{type:"EntityItemMirror",x:180,y:4,settings:{size:{x:24,y:24}}},{type:"EntityPlayerSpawner",x:40,y:96,settings:{name:"spawner-a"}},{type:"EntityItemBookshelf",x:40,y:24,settings:{size:{x:32,y:84},Name:"Sherrif"}},{type:"EntityPlayerSpawner",x:296,y:96,settings:{name:"spawner-b"}},{type:"EntityItemBed",x:72,y:96,settings:{size:{x:48,y:24}}},{type:"EntityItemPictures",x:236,y:4,settings:{size:{x:24,y:12}}},{type:"EntityItemLamp",x:208,y:4,settings:{size:{x:16,y:28}}},{type:"EntityCursor",x:108,y:72},{type:"EntityLevelchange",x:0,y:84,settings:{size:{x:16,y:44},name:"Rumpelkammer",levelName:"junkroom",playerSpawnerName:"spawner-b"}},{type:"EntityLevelchange",x:308,y:48,settings:{size:{x:12,y:80},name:"Clubeingang",levelName:"testroom",playerSpawnerName:"spawner-b"}},{type:"EntityPlayer",x:148,y:91}],layer:[{name:"background",width:40,height:23,linkWithCollision:!1,visible:1,tilesetName:"media/MultiRoom02.png",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,0,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,0,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920]]},{name:"collision",width:40,height:23,linkWithCollision:!1,visible:0,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,
data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"pathfinding",width:40,height:23,linkWithCollision:!1,visible:1,tilesetName:"media/pathfindingtiles_plusplus_8.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!0,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,4,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4],[0,0,0,0,4,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4],[0,0,0,0,4,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,0,0,0,0,0,0,0,0,0,0,4,4,3,3],[0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,0,0,0,0,4,4,3,3,3],[4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,0,0,0,0,0,4,4,3,3,3,3],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,4,4,4,4,4,4,4,3,3,3,1,1],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,1,1,1,3,3,3,3,3,3,3,3,3,3,3,1,1],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,1,1],[3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelTestroom2Resources=[new ig.Image("media/MultiRoom02.png"),new ig.Image("media/pathfindingtiles_plusplus_8.png")]}),ig.baked=!0,ig.module("game.entities.item-door").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemDoor=ig.global.EntityItemDoor=ig.EntityExtended.extend({name:"Haustür",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,persistent:!0,state:"gummy",size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Hier geht es raus. Ich muss schnell zum Sport, aber die Tür ist bestimmt verschloßen."):"Öffne"===e?ig.game.getPlayer().speak("Verschloßen! Ich brauche den Schlüssel, sonst komme ich zu spät zum Sport."):"Benutze"===e?ig.game.getPlayer().speak("Verschloßen! Ich brauche den Schlüssel, sonst komme ich zu spät zum Sport."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Ziehe"===e||"Drücke"===e?ig.game.getPlayer().speak("Verschloßen! Ich brauche den Schlüssel, sonst komme ich zu spät zum Sport."):"Nimm"===e?ig.game.getPlayer().speak("Die ist deutlich zu groß für meine Hosentasche."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Schlüssel"===e.name&&"ungummy"===this.state?ig.game.showEnding():"Schlüssel"===e.name&&"gummy"===this.state?ig.game.getPlayer().speak("Geht nicht!","Eine zähe klebrige Flüssigkeit verstopft das Schlüsselloch."):"Kaugummi-Ex"===e.name?(ig.game.getPlayer().speak("Der Kaugummi-Ex hat das Schlüsselloch von der klebrigen Flüssigkeit befreit.","Danke Kaugummi-Ex!"),ig.game.inventory.removeInventoryItem(e),this.state="ungummy"):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-carpet").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemCarpet=ig.global.EntityItemCarpet=ig.EntityExtended.extend({name:"Teppich",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Hier liegt ein hässlicher Teppich."):"Benutze"===e?ig.game.getPlayer().speak("Ich wüsste nicht wie."):"Nimm"===e?ig.game.getPlayer().speak("Ich hab habe gerade keinen Teppichbedarf."):"Ziehe"===e||"Drücke"===e?ig.game.getPlayer().speak("Geht nicht. Ist am Boden festgeklebt."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.inventory-item-egg").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemEgg=ig.global.EntityInventoryItemEgg=ig.EntityExtended.extend({name:"Dino-Ei",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-egg.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Das ist eines von diesen Spielzeug-Eiern, die sich im Wasser auflösen."):"Öffne"===e?ig.game.getPlayer().speak("Hmpf! Bekomme ich nicht auf ... das Ei ist steinhart!"):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Wasserflasche"===e.name?"open"===e.state?ig.game.getPlayer().speak("Das Ei passt nicht in die Flasche. Ich muss das Ei in einem Behälter einweichen damit es sich auflöst."):ig.game.getPlayer().speak("Die Flasche ist immer noch zu."):"Schraubenschlüssel"===e.name?ig.game.getPlayer().speak("Das Ei ist zu hart. Selbst der Schraubenschlüssel hilft mir da nicht weiter."):ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-dresser").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-egg").defines(function(){ig.CONFIG,ig.EntityItemDresser=ig.global.EntityItemDresser=ig.EntityExtended.extend({name:"Kommode",state:"closed",looted:!1,persistent:!0,_wmScalable:!0,matchingInventoryItem:ig.EntityInventoryItemEgg,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?"closed"===this.state?ig.game.getPlayer().speak("Da ist bestimmt der Haustürschlüssel drin!"):ig.game.getPlayer().speak("Jetzt ist es offen."):"Öffne"===e?("closed"===this.state&&ig.game.getPlayer().speak("Es klemmt! Ein altes verrostetes Schloß verhindert das Öffnen."),"open"!==this.state||this.looted?"open"===this.state&&this.looted&&ig.game.getPlayer().speak("Leer ..."):(ig.game.getPlayer().speak("Da war ein Dino-Ei drin?!"),ig.game.inventory.addItem(this.matchingInventoryItem),this.looted=!0)):"Benutze"===e?ig.game.getPlayer().speak("Soll ich drauf tanzen, oder wie?"):"Ziehe"===e||"Drücke"===e?ig.game.getPlayer().speak("Bewegt sich kein Stück."):"Nimm"===e?ig.game.getPlayer().speak("Ähhh .. lieber nicht."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Monsterzitrone"===e.name?(ig.game.getPlayer().speak("Der Zitronensaft hat das Schloß verätzt. Ich kann die Kommode jetzt öffnen."),this.state="open",ig.game.inventory.removeInventoryItem(e)):"Schraubenschlüssel"===e.name?ig.game.getPlayer().speak("Das würde zwar das Schloß kaputt machen,","aber ich möchte die Kommode nicht aus Versehen beschädigen."):"Stock"===e.name?ig.game.getPlayer().speak("Das würde zwar das Schloß kaputt machen,","aber ich möchte die Kommode nicht aus Versehen beschädigen."):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-flower").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemFlower=ig.global.EntityItemFlower=ig.EntityExtended.extend({name:"Blume",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:6,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Ein wunderschönes Veilchen."):"Nimm"===e?ig.game.getPlayer().speak("Nein, ich glaube auf die reagiere ich allergisch."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-clock").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemClock=ig.global.EntityItemClock=ig.EntityExtended.extend({name:"Uhr",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:16,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Scheiße! Schon so spät?! Ich muss zum Sport."):"Benutze"===e?ig.game.getPlayer().speak("Scheiße! Schon so spät?! Ich muss zum Sport."):"Nimm"===e?ig.game.getPlayer().speak("Ähhh .. lieber nicht."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-painting").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemPainting=ig.global.EntityItemPainting=ig.EntityExtended.extend({name:"Gemälde",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:20,interact:function(e){ig.game.getPlayer().speak("Berm.")},combine:function(e){ig.game.getPlayer().speak("... Berschauer.")}})}),ig.baked=!0,ig.module("game.levels.floor").requires("impact.image","game.entities.player-spawner","game.entities.item-door","plusplus.entities.levelchange","game.entities.item-carpet","game.entities.item-dresser","game.entities.item-flower","game.entities.item-clock","game.entities.item-bookshelf","game.entities.item-painting","game.entities.cursor","game.entities.player").defines(function(){LevelFloor={entities:[{type:"EntityPlayerSpawner",x:224,y:100,settings:{name:"spawner-b"}},{type:"EntityItemDoor",x:183,y:62,settings:{size:{x:20,y:32}}},{type:"EntityLevelchange",x:184,y:120,settings:{name:"Schlafzimmer",playerSpawnerName:"spawner-a",levelName:"bedroom"}},{type:"EntityLevelchange",x:236,y:72,settings:{size:{x:12,y:40},name:"Küche",levelName:"kitchen",playerSpawnerName:"spawner-a"}},{type:"EntityItemCarpet",x:174,y:102,settings:{size:{x:38,y:12}}},{type:"EntityPlayerSpawner",x:188,y:108,settings:{name:"spawner-a"}},{type:"EntityItemDresser",x:152,y:82,settings:{size:{x:17,y:17}}},{type:"EntityItemFlower",x:152,y:72,settings:{size:{x:16,y:10}}},{type:"EntityItemClock",x:136,y:60,settings:{size:{x:8,y:12}}},{type:"EntityItemBookshelf",x:104,y:68,settings:{size:{x:19,y:28}}},{type:"EntityItemPainting",x:56,y:56,settings:{size:{x:32,y:24}}},{type:"EntityCursor",x:168,y:36},{type:"EntityPlayer",x:135,y:104}],layer:[{name:"background",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/background-floor.gif",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920],[921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960],[961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3]]},{name:"collision",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"pathfinding",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/pathfindingtiles_plusplus_8.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4,4,4,4,4,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,4,4,4,4,4,4,1,4,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,4,4,1,1,1,4,1,4,0,0,4,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,4,4,1,1,1,4,1,4,1,1,4,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,4,4,1,1,1,0,1,0,1,1,0,0,1,1,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelFloorResources=[new ig.Image("media/background-floor.gif"),new ig.Image("media/pathfindingtiles_plusplus_8.png")]}),ig.baked=!0,ig.module("game.entities.inventory-item-stick").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemStick=ig.global.EntityInventoryItemStick=ig.EntityExtended.extend({name:"Stock",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-stick.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Ein langer zerbrechlicher Holzstock."):"Rede"===e?ig.game.getPlayer().speak("Stock auch noch mal!"):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-crates").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-stick").defines(function(){ig.CONFIG,ig.EntityItemCrates=ig.global.EntityItemCrates=ig.EntityExtended.extend({name:"Kisten",_wmScalable:!0,persistent:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},sealed:!0,state:"untouched",matchingInventoryItem:ig.EntityInventoryItemStick,interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Da stehen zwei komische Kisten in der Ecke."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Öffne"===e?"untouched"!==this.state||this.sealed?"touched"!==this.state||this.sealed?"untouched"===this.state&&this.sealed&&ig.game.getPlayer().speak("Die Kisten sind zugeklebt."):ig.game.getPlayer().speak("Der Stock, ich will nicht noch einen."):(ig.game.getPlayer().speak("WTF? Die Kisten sind voller Stöcker ... ich nehme mal einen mit."),ig.game.inventory.addItem(this.matchingInventoryItem),this.state="touched"):"Benutze"===e?ig.game.getPlayer().speak("Und wie?"):"Nimm"===e?ig.game.getPlayer().speak("Keine Lust die durch die Gegend zu schleppen."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Bastelschere"===e.name?(ig.game.getPlayer().speak("Damit konnte ich die Kisten aufschneiden, dabei ist die Schere leider kaputt gegangen.","Kein Wunder das die im Müll lag."),this.sealed=!1,ig.game.inventory.removeInventoryItem(e)):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-pipe").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemPipe=ig.global.EntityItemPipe=ig.EntityExtended.extend({name:"Rohr",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Ein Rohr, wo das wohl hinführt?"):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Benutze"===e?ig.game.getPlayer().speak("Und wie?"):"Drücke"===e||"Drücke"===e?ig.game.getPlayer().speak("Bloß nicht, das geht sonst noch kaputt."):"Nimm"===e?ig.game.getPlayer().speak("Das lasse ich lieber bleiben."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Stock"===e.name?ig.game.getPlayer().speak("Rohr + Stock? Dann hätte ich ja einen Rohrstock. Ha!","Bringt mich aber auch nicht weiter."):ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.levels.junkroom").requires("impact.image","plusplus.entities.levelchange","game.entities.player-spawner","game.entities.item-crates","game.entities.item-pipe","game.entities.cursor","game.entities.player").defines(function(){LevelJunkroom={entities:[{type:"EntityLevelchange",x:104,y:72,settings:{size:{x:14,y:32},name:"Schlafzimmer",playerSpawnerName:"spawner-b",levelName:"testroom"}},{type:"EntityPlayerSpawner",x:120,y:96,settings:{name:"spawner-a"}},{type:"EntityPlayerSpawner",x:164,y:96,settings:{name:"spawner-b"}},{type:"EntityLevelchange",x:160,y:64,settings:{size:{x:16,y:22},name:"Küche",levelName:"kitchen",playerSpawnerName:"spawner-b"}},{type:"EntityItemCrates",x:184,y:84,settings:{size:{x:32,y:20}}},{type:"EntityItemPipe",x:120,y:56,settings:{size:{x:8,y:40}}},{type:"EntityCursor",x:184,y:44},{type:"EntityPlayer",x:155,y:96}],layer:[{name:"background",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/background-junkroom.gif",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920],[921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960],[961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3]]},{name:"collision",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,
data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"pathfinding",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/pathfindingtiles_plusplus_8.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,1,4,4,1,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,4,4,1,4,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0,0,1,4,0,0,4,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelJunkroomResources=[new ig.Image("media/background-junkroom.gif"),new ig.Image("media/pathfindingtiles_plusplus_8.png")]}),ig.baked=!0,ig.module("game.entities.inventory-item-key").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemKey=ig.global.EntityInventoryItemKey=ig.EntityExtended.extend({name:"Schlüssel",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-key.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Damit kann ich bestimmt die Haustür aufschließen."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-sink").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-key").defines(function(){var e=ig.CONFIG;ig.EntityItemSink=ig.global.EntityItemSink=ig.EntityExtended.extend({name:"Spüle",_wmScalable:!1,collides:ig.Entity.COLLIDES.NEVER,size:{x:18,y:3},persistent:!0,state:"empty",animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"sink.gif",18,3),animInit:"empty",matchingInventoryItem:ig.EntityInventoryItemKey,animSettings:{empty:{frameTime:1,sequence:[1]},full:{frameTime:1,sequence:[0]}},interactionDistance:7,interact:function(e){"Schau"===e?"full"===this.state?ig.game.getPlayer().speak("Eine Spüle voller Sprudelwasser."):ig.game.getPlayer().speak("Der Abfluß ist verstopft. Hier fließt nix ab."):"Benutze"===e?ig.game.getPlayer().speak("Der Abfluß ist verstopft. Hier fließt nix ab."):"Nimm"===e?ig.game.getPlayer().speak("Ähhh .. lieber nicht."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Wasserflasche"===e.name?"open"===e.state?(this.state="full",ig.game.getPlayer().speak("Die Spüle ist jetzt voller Sprudelwasser!"),ig.game.inventory.removeInventoryItem(e)):ig.game.getPlayer().speak("Ich kann die Flasche nicht auskippen, der Verschluß ist zu."):"Dino-Ei"===e.name&&"full"===this.state?(ig.game.inventory.removeInventoryItem(e),ig.game.inventory.addItem(this.matchingInventoryItem),ig.game.getPlayer().speak("Das Dino-Ei hat sich im Wasser aufgelöst.","Versteckt im Ei war kein Dino, sondern ein Schlüssel!")):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")},update:function(){this.parent(),"full"===this.state&&this.animOverride("full")}})}),ig.baked=!0,ig.module("game.entities.item-faucet").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemFaucet=ig.global.EntityItemFaucet=ig.EntityExtended.extend({name:"Wasserhahn",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:12,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Der Wasserhahn ist kaputt"):"Benutze"===e?ig.game.getPlayer().speak("Der Wasserhahn ist kaputt"):"Öffne"===e?ig.game.getPlayer().speak("Der Wasserhahn ist kaputt"):"Nimm"===e?ig.game.getPlayer().speak("Das wäre Sachbeschädigung."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.inventory-item-scissor").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemScissor=ig.global.EntityInventoryItemScissor=ig.EntityExtended.extend({name:"Bastelschere",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-scissor.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Eine Bastelschere für Kinder."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-trashcan").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-scissor").defines(function(){ig.CONFIG,ig.EntityItemTrashcan=ig.global.EntityItemTrashcan=ig.EntityExtended.extend({name:"Mülleimer",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,matchingInventoryItem:ig.EntityInventoryItemScissor,persistent:!0,looted:!1,size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Der Mülleimer, er ist ekelig."):"Benutze"===e?ig.game.getPlayer().speak("Nein, ich habe gerade kein Müll."):"Öffne"!==e||this.looted?"Öffne"===e&&this.looted?ig.game.getPlayer().speak("Nix drin außer Müll."):"Nimm"===e?ig.game.getPlayer().speak("Ungern."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn."):(ig.game.getPlayer().speak("Im Mülleimer liegt eine Bastelschere, die könnte nützlich sein."),ig.game.inventory.addItem(this.matchingInventoryItem),this.looted=!0)},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-window").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemWindow=ig.global.EntityItemWindow=ig.EntityExtended.extend({name:"Fenster",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:24,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Kacke. Die Sonne geht schon unter. Ich muss zum Sport."):"Benutze"===e?ig.game.getPlayer().speak("Da komme ich nicht raus."):"Öffne"===e?ig.game.getPlayer().speak("Ich komme nicht ran."):"Nimm"===e?ig.game.getPlayer().speak("Ähhh .. lieber nicht."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-refrigerator").requires("plusplus.core.entity","plusplus.core.config").defines(function(){ig.CONFIG,ig.EntityItemRefrigerator=ig.global.EntityItemRefrigerator=ig.EntityExtended.extend({name:"Kühlschrank",_wmScalable:!0,collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:1,interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Der Kühlschrank, er ist anwesend."):"Benutze"===e?ig.game.getPlayer().speak("Nein, ich habe keinen Hunger."):"Öffne"===e?ig.game.getPlayer().speak("Nein, ich habe keinen Hunger."):"Nimm"===e?ig.game.getPlayer().speak("Nein, der passt auch nicht in meine Tasche."):"Drücke"===e||"Ziehe"===e?ig.game.getPlayer().speak("Bewegt sich kein Stück"):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.levels.kitchen").requires("impact.image","plusplus.entities.levelchange","game.entities.player-spawner","game.entities.item-sink","game.entities.item-faucet","game.entities.item-trashcan","game.entities.item-window","game.entities.item-refrigerator","game.entities.cursor","game.entities.player").defines(function(){LevelKitchen={entities:[{type:"EntityLevelchange",x:80,y:64,settings:{size:{x:12,y:40},name:"Flur",levelName:"floor",playerSpawnerName:"spawner-b"}},{type:"EntityLevelchange",x:152,y:107,settings:{name:"Rumpelkammer",levelName:"junkroom",playerSpawnerName:"spawner-b",size:{x:16,y:13}}},{type:"EntityPlayerSpawner",x:164,y:96,settings:{name:"spawner-b"}},{type:"EntityPlayerSpawner",x:96,y:96,settings:{name:"spawner-a"}},{type:"EntityItemSink",x:156,y:78},{type:"EntityItemFaucet",x:160,y:68},{type:"EntityItemTrashcan",x:204,y:88,settings:{size:{x:8,y:11}}},{type:"EntityItemWindow",x:144,y:48,settings:{size:{x:40,y:16}}},{type:"EntityItemRefrigerator",x:112,y:72,settings:{size:{x:20,y:24}}},{type:"EntityCursor",x:200,y:28},{type:"EntityPlayer",x:147,y:92}],layer:[{name:"background",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/background-kitchen.gif",repeat:!1,preRender:!0,distance:"1",tilesize:8,foreground:!1,data:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],[81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],[121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160],[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],[201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240],[241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280],[281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320],[321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360],[361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400],[401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440],[441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480],[481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520],[521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560],[561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600],[601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640],[641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680],[681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720],[721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760],[761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800],[801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],[841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880],[881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920],[921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960],[961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3]]},{name:"collision",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,11,0,0,10,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"pathfinding",width:40,height:25,linkWithCollision:!1,visible:1,tilesetName:"media/pathfindingtiles_plusplus_8.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,1,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,1,1,4,4,1,1,1,1,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelKitchenResources=[new ig.Image("media/background-kitchen.gif"),new ig.Image("media/pathfindingtiles_plusplus_8.png")]}),ig.baked=!0,ig.module("game.components.command-execution").requires("plusplus.core.config").defines(function(){"use strict";ig.CONFIG,ig.CommandExecution=ig.Class.extend({hasActiveCommand:!1,init:function(){this.player=ig.game.getPlayer()},execute:function(){var e=ig.game.getEntitiesByClass(ig.CommandPreview)[0].currentCommand,i=ig.game.getEntitiesByClass(ig.CommandPreview)[0].defaultCommand;ig.input.pressed("click")&&(this.isAbortionCommand()&&e!==i?this.removeCurrentCommand():(this.movePlayer(),this.resetNameOnDefaultCommand(e,i),this.checkForActiveCommand(e),this.checkForActiveCompundableCommand())),this.TryToInteract(e)},TryToInteract:function(e){var i=ig.game.getEntityByName(ig.game.getEntitiesByClass(ig.CommandPreview)[0].entityName),t=ig.game.getEntityByName(ig.game.getEntitiesByClass(ig.CommandPreview)[0].compoundableEntityName),s=ig.game.getEntitiesByClass(ig.CommandPreview)[0];i instanceof ig.EntityLevelchange==0&&t instanceof ig.EntityLevelchange==0&&(s.hasActiveCompoundableCommand&&this.hasTwoInventoryItems(i,t)?(t.combine(i),this.removeCurrentCommand()):this.isUseWithCommand(e)?ig.game.getEntitiesByClass(ig.CommandPreview)[0].hasCombinedCommand=!0:s.hasActiveCompoundableCommand&&this.hasEntityToInteract(t)?(t.combine(i),this.removeCurrentCommand(),this.player.moveToStop()):this.hasEntityToInteract(i)&&(i.interact(e),this.removeCurrentCommand(),this.player.moveToStop()))},isUseWithCommand:function(e){return this.hasActiveCommand&&this.hasMouseOverInventory()&&"Benutze"===e},hasTwoInventoryItems:function(e,i){return"inventory"===e.category&&"inventory"===i.category},hasEntityToInteract:function(e){return this.hasActiveCommand&&this.hasPlayerNearEntity(e)||this.hasActiveCommand&&this.hasMouseOverInventory()},hasMouseOverInventory:function(){return ig.input.mouse.y+ig.game.screen.y>=153&&ig.input.mouse.y+ig.game.screen.y<=185&&ig.input.mouse.x+ig.game.screen.x>=177&&ig.input.mouse.x+ig.game.screen.x<=303},hasPlayerNearEntity:function(e){return this.player.distanceEdgeTo(e)<=e.interactionDistance},resetNameOnDefaultCommand:function(e,i){if(e===i){for(var t=ig.game.entities,s=!1,n=0,a=ig.game.entities.length;n<a;n++)this.entityIsinFocus(t[n])&&"player"!==t[n].name&&"cursor"!==t[n].name&&"command"!==t[n].name&&"preview"!==t[n].name&&void 0!==t[n].name&&"spawner"!==t[n].name&&"textbox"!==t[n].name&&(s=!1);s||(ig.game.getEntitiesByClass(ig.CommandPreview)[0].entityName="")}},checkForActiveCommand:function(e){""!==e&&""!==ig.game.getEntitiesByClass(ig.CommandPreview)[0].entityName&&(this.hasActiveCommand=!0)},checkForActiveCompundableCommand:function(){var e=ig.game.getEntitiesByClass(ig.CommandPreview)[0];""!==e.entityName&&""!==e.compoundableEntityName&&e.setHasActiveCompoundableCommand(!0)},entityIsinFocus:function(e){return e.pos.x<=ig.input.mouse.x+ig.game.screen.x&&ig.input.mouse.x+ig.game.screen.x<=e.pos.x+e.size.x&&e.pos.y<=ig.input.mouse.y+ig.game.screen.y&&ig.input.mouse.y+ig.game.screen.y<=e.pos.y+e.size.y},isAbortionCommand:function(){for(var e=ig.game.entities,i=!0,t=ig.game.getEntityByName(ig.game.getEntitiesByClass(ig.CommandPreview)[0].entityName),s=ig.game.getEntityByName(ig.game.getEntitiesByClass(ig.CommandPreview)[0].compoundableEntityName),n=0,a=ig.game.entities.length;n<a;n++)this.entityIsinFocus(e[n])&&"player"!==e[n].name&&"cursor"!==e[n].name&&t instanceof ig.EntityLevelchange==0&&s instanceof ig.EntityLevelchange==0&&(i=!1);return i},removeCurrentCommand:function(){var e=ig.game.getEntitiesByClass(ig.CommandPreview)[0];e.setCurrentCommand(""),e.setHasCombinedCommand(!1),e.setHasActiveCompoundableCommand(!1),this.hasActiveCommand=!1},movePlayer:function(){this.isClickOnGameWorld()&&this.player.moveTo({x:ig.input.mouse.x+ig.game.screen.x,y:ig.input.mouse.y+ig.game.screen.y},{avoidEntities:!1})},isClickOnGameWorld:function(){return ig.input.mouse.y+ig.game.screen.y<=135}})}),ig.baked=!0,ig.module("plusplus.ui.ui-interactive").requires("plusplus.ui.ui-element","plusplus.helpers.utils").defines(function(){"use strict";var e=ig.utils;ig.UIInteractive=ig.global.UIInteractive=ig.UIElement.extend({targetable:!0,enabled:!0,onActivated:null,onDeactivated:null,initTypes:function(){this.parent(),e.addType(ig.EntityExtended,this,"type","INTERACTIVE")},initProperties:function(){this.parent(),this.onActivated=new ig.Signal,this.onDeactivated=new ig.Signal},resetExtras:function(){this.parent(),this.setEnabled(this.enabled)},setEnabled:function(e){e?this.enable():this.disable()},enable:function(){this.enabled=!0,this.animRelease(this.getDirectionalAnimName("disabled"))},disable:function(){this.activated&&this.deactivate(),this.enabled=!1,this.animOverride(this.getDirectionalAnimName("disabled"),{lock:!0})},activate:function(e){this.enabled&&(this.activateComplete(e),this.parent(e))},deactivate:function(e){this.enabled&&(this.deactivateComplete(e),this.parent(e))},activateComplete:function(e){this.onActivated.dispatch(this)},deactivateComplete:function(e){this.onDeactivated.dispatch(this)},cleanup:function(){ig.game.hasLevel||(this.onActivated.removeAll(),this.onActivated.forget(),this.onDeactivated.removeAll(),this.onDeactivated.forget()),this.parent()}})}),ig.baked=!0,ig.module("plusplus.ui.ui-button").requires("plusplus.ui.ui-interactive").defines(function(){"use strict";ig.UIButton=ig.global.UIButton=ig.UIInteractive.extend({alwaysToggleActivate:!0,activateComplete:function(e){this.parent(e),this.animRelease(),this.alwaysToggleActivate?this.animOverride(this.getDirectionalAnimName("tapped")):this.animOverride(this.getDirectionalAnimName("pressed"),{lock:!0})},deactivateComplete:function(e){this.parent(e),this.animRelease(),this.alwaysToggleActivate?this.animOverride(this.getDirectionalAnimName("tapped")):this.animOverride(this.getDirectionalAnimName("released"),{lock:!0})}})}),ig.baked=!0,ig.module("game.ui.command").requires("plusplus.core.config","plusplus.ui.ui-button").defines(function(){ig.CONFIG,ig.Command=ig.global.Command=ig.UIButton.extend({animInit:"mouseOut",fixed:!1,posAsPct:!1,name:"command",command:"",zIndex:5,animSettings:{mouseOut:{frameTime:1,sequence:[0]},mouseOver:{frameTime:1,sequence:[1]}},inFocus:function(){return this.pos.x<=ig.input.mouse.x+ig.game.screen.x&&ig.input.mouse.x+ig.game.screen.x<=this.pos.x+this.size.x&&this.pos.y<=ig.input.mouse.y+ig.game.screen.y&&ig.input.mouse.y+ig.game.screen.y<=this.pos.y+this.size.y},handleMouseOver:function(){this.inFocus()?this.animOverride("mouseOver"):this.animOverride("mouseOut")},handleCommandInput:function(){if(this.inFocus()&&ig.input.pressed("click")){var e=ig.game.getEntitiesByClass(ig.CommandPreview)[0];e.setCurrentCommand(this.command),e.setEntityName(""),e.setHasCombinedCommand(!1),ig.game.commandExecution.hasActiveCommand=!1}},update:function(){this.parent(),this.handleMouseOver(),this.handleCommandInput()}})}),ig.baked=!0,ig.module("game.ui.command-give").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandGive=ig.global.CommandGive=ig.Command.extend({command:"Gib",size:{x:16,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_give.gif",16,10)})}),ig.baked=!0,ig.module("game.ui.command-open").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandOpen=ig.global.CommandOpen=ig.Command.extend({command:"Öffne",size:{x:28,y:12},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_open.gif",28,12)})}),ig.baked=!0,ig.module("game.ui.command-look").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandLook=ig.global.CommandLook=ig.Command.extend({command:"Schau",size:{x:31,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_look.gif",31,10)})}),ig.baked=!0,ig.module("game.ui.command-use").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandUse=ig.global.CommandUse=ig.Command.extend({command:"Benutze",size:{x:40,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_use.gif",40,10)})}),ig.baked=!0,ig.module("game.ui.command-close").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandClose=ig.global.CommandClose=ig.Command.extend({command:"Schließe",size:{x:42,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_close.gif",42,10)})}),ig.baked=!0,ig.module("game.ui.command-press").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandPress=ig.global.CommandPress=ig.Command.extend({command:"Drücke",size:{x:34,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_press.gif",34,10)})}),ig.baked=!0,ig.module("game.ui.command-pickup").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandPickUp=ig.global.CommandPickUp=ig.Command.extend({command:"Nimm",size:{x:25,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_pickup.gif",25,10)})}),ig.baked=!0,ig.module("game.ui.command-talk").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandTalk=ig.global.CommandTalk=ig.Command.extend({command:"Rede",size:{x:25,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_talk.gif",25,10)})}),ig.baked=!0,ig.module("game.ui.command-pull").requires("plusplus.core.config","plusplus.ui.ui-button","game.ui.command").defines(function(){var e=ig.CONFIG;ig.CommandPull=ig.global.CommandPull=ig.Command.extend({command:"Ziehe",size:{x:27,y:10},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"ui/ui_button_pull.gif",27,10)})}),ig.baked=!0,ig.module("game.ui.command-preview").requires("plusplus.core.config","plusplus.ui.ui-text").defines(function(){var e=ig.CONFIG;ig.CommandPreview=ig.global.CommandPreview=ig.UIText.extend({name:"preview",fixed:!1,posAsPct:!1,defaultCommand:"Gehe zu",hasDefaultCommandInventory:!1,hasCombinedCommand:!1,hasActiveCompoundableCommand:!1,currentCommand:"",entityName:"",compoundableEntityName:"",text:"",font:new ig.Font(e.PATH_TO_MEDIA+"command_preview_font_11px.png"),centerCommandPreview:function(){this.pos.x=e.GAME_WIDTH_VIEW/2-this.size.x/2},entityIsinFocus:function(e){
return e.pos.x<=ig.input.mouse.x+ig.game.screen.x&&ig.input.mouse.x+ig.game.screen.x<=e.pos.x+e.size.x&&e.pos.y<=ig.input.mouse.y+ig.game.screen.y&&ig.input.mouse.y+ig.game.screen.y<=e.pos.y+e.size.y},declareEntityName:function(){for(var e=ig.game.entities,i="",t=0,s=ig.game.entities.length;t<s;t++)this.entityIsinFocus(e[t])&&"player"!==e[t].name&&"cursor"!==e[t].name&&"command"!==e[t].name&&"preview"!==e[t].name&&void 0!==e[t].name&&"spawner-a"!==e[t].name&&"spawner-b"!==e[t].name&&"textbox"!==e[t].name&&(i=e[t].name);ig.game.commandExecution.hasActiveCommand||(this.entityName=i),this.hasCombinedCommand&&i!==this.entityName&&!this.hasActiveCompoundableCommand?this.compoundableEntityName=i:this.hasActiveCompoundableCommand||(this.compoundableEntityName="")},showCommandPreview:function(){""===this.currentCommand?this.renderDefaultCommand():this.renderSelectedCommand()},renderDefaultCommand:function(){this.currentCommand=this.defaultCommand,this.text=this.currentCommand+" "+this.entityName},renderSelectedCommand:function(){"Schau"===this.currentCommand&&""!==this.entityName?this.text=this.currentCommand+" "+this.entityName+" an":"Rede"===this.currentCommand&&""!==this.entityName?this.text=this.currentCommand+" mit "+this.entityName:this.handleInventoryMouseOverCommand()},handleInventoryMouseOverCommand:function(){this.hasMouseOverInventory()&&this.hasDefaultCommandOnActiveEntity()?(this.currentCommand="Schau",this.text=this.currentCommand+" "+this.entityName+" an",this.hasDefaultCommandInventory=!0):this.hasDefaultCommandInventory?(this.currentCommand=this.defaultCommand,this.text=this.currentCommand+" "+this.entityName,this.hasDefaultCommandInventory=!1):this.hasCombinedCommand?this.text=this.currentCommand+" "+this.entityName+" mit "+this.compoundableEntityName:this.text=this.currentCommand+" "+this.entityName},setHasCombinedCommand:function(e){this.hasCombinedCommand=e},setHasActiveCompoundableCommand:function(e){this.hasActiveCompoundableCommand=e},setEntityName:function(e){this.entityName=e},setCurrentCommand:function(e){this.currentCommand=e},hasMouseOverInventory:function(){return ig.input.mouse.y+ig.game.screen.y>=153&&ig.input.mouse.y+ig.game.screen.y<=185&&ig.input.mouse.x+ig.game.screen.x>=177&&ig.input.mouse.x+ig.game.screen.x<=303},hasDefaultCommandOnActiveEntity:function(){return"Gehe zu"===this.currentCommand&&""!==this.entityName},update:function(){this.parent(),this.declareEntityName(),this.showCommandPreview(),ig.game.commandExecution.execute()},reposition:function(){this.parent(),this.centerCommandPreview()}})}),ig.baked=!0,ig.module("game.ui.pacui").requires("game.ui.command-give","game.ui.command-open","game.ui.command-look","game.ui.command-use","game.ui.command-close","game.ui.command-press","game.ui.command-pickup","game.ui.command-talk","game.ui.command-pull","game.ui.command-preview","plusplus.core.config").defines(function(){"use strict";ig.CONFIG,ig.Pacui=ig.Class.extend({init:function(){this.spawnCommands(),this.spawnCommandPreview()},spawnCommands:function(){ig.game.spawnEntity(ig.CommandGive,16,151),ig.game.spawnEntity(ig.CommandOpen,16,161),ig.game.spawnEntity(ig.CommandLook,16,175),ig.game.spawnEntity(ig.CommandUse,61,151),ig.game.spawnEntity(ig.CommandClose,61,163),ig.game.spawnEntity(ig.CommandPress,61,175),ig.game.spawnEntity(ig.CommandPickUp,117,151),ig.game.spawnEntity(ig.CommandTalk,117,163),ig.game.spawnEntity(ig.CommandPull,116,175)},spawnCommandPreview:function(){ig.game.spawnEntity(ig.CommandPreview,0,135)}})}),ig.baked=!0,ig.module("game.ui.inventory").requires("plusplus.core.config").defines(function(){"use strict";ig.CONFIG,ig.Inventory=ig.Class.extend({slots:[{x:177,y:153},{x:209,y:153},{x:241,y:153},{x:273,y:153}],inventoryItems:[],addItem:function(e,i){i&&this.removeWorldItem(i);var t=ig.game.spawnEntity(e,this.slots[this.inventoryItems.length].x,this.slots[this.inventoryItems.length].y);this.inventoryItems.push(t)},removeWorldItem:function(e){ig.game.removeEntity(e)},removeInventoryItem:function(e){for(var i=0,t=this.inventoryItems.length;i<t;i++)if(this.inventoryItems[i].name===e.name){this.inventoryItems.erase(this.inventoryItems[i]);break}ig.game.removeEntity(e),this.respawnInventoryItems()},respawnInventoryItems:function(){if(this.inventoryItems.length>0){this.clearInventory();for(var e=0,i=this.inventoryItems.length;e<i;e++)ig.game.spawnEntity(this.inventoryItems[e],this.slots[e].x,this.slots[e].y)}},clearInventory:function(){for(var e=0,i=this.inventoryItems.length;e<i;e++)ig.game.removeEntity(this.inventoryItems[e])}})}),ig.baked=!0,ig.module("game.entities.item-lemon").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-lemon").defines(function(){var e=ig.CONFIG;ig.EntityItemLemon=ig.global.EntityItemLemon=ig.EntityExtended.extend({name:"Monsterzitrone",collides:ig.Entity.COLLIDES.NEVER,size:{x:6,y:3},interactionDistance:10,matchingInventoryItem:ig.EntityInventoryItemLemon,animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"item-lemon.gif",6,3),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},interact:function(e){"Nimm"===e?(ig.game.inventory.addItem(this.matchingInventoryItem,this),ig.game.roomState.lemon.isPickedUp=!0,ig.game.getPlayer().speak("Eine Zitrone. Endlich.")):"Schau"===e?ig.game.getPlayer().speak("Eine riesige Zitrone ... unglaublich!"):"Rede"===e?ig.game.getPlayer().speak("Na Zitrone, bist du SAUER auf mich?"):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.inventory-item-bottle").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemBottle=ig.global.EntityInventoryItemBottle=ig.EntityExtended.extend({name:"Wasserflasche",state:"closed",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-bottle.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?"closed"===this.state?ig.game.getPlayer().speak("Der Verschluß der Flasche ist eckig - wie seltsam."):ig.game.getPlayer().speak("Die Flasche ist offen."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Öffne"===e?"closed"===this.state?ig.game.getPlayer().speak("Mist. Ich bekomme den Verschluß nicht auf, er sitzt zu fest."):ig.game.getPlayer().speak("Die Flasche ist bereits offen."):"Ziehe"===e||"Drücke"===e?ig.game.getPlayer().speak("Nein, ich will die Flasche nicht kaputt machen."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Schraubenschlüssel"===e.name?(ig.game.getPlayer().speak("Damit konnte ich die Flasche öffnen!","Den Schraubenschlüssel brauche ich wohl nicht mehr."),this.state="open",ig.game.inventory.removeInventoryItem(e)):"Dino-Ei"===e.name?"open"===this.state?ig.game.getPlayer().speak("Das Ei passt nicht in die Flasche. Ich muss das Ei in einem Behälter einweichen damit es sich auflöst."):ig.game.getPlayer().speak("Die Flasche ist immer noch zu."):ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-bottle").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-bottle").defines(function(){var e=ig.CONFIG;ig.EntityItemBottle=ig.global.EntityItemBottle=ig.EntityExtended.extend({name:"Wasserflasche",collides:ig.Entity.COLLIDES.NEVER,size:{x:8,y:8},interactionDistance:4,matchingInventoryItem:ig.EntityInventoryItemBottle,animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"item-bottle.gif",8,8),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},interact:function(e){"Nimm"===e?(ig.game.inventory.addItem(this.matchingInventoryItem,this),ig.game.roomState.bottle.isPickedUp=!0,ig.game.getPlayer().speak("Zeig mal die Flasche - ist jetzt meine Flasche.")):"Schau"===e?ig.game.getPlayer().speak("Eine ungeöffnete Flasche Sprudelwasser."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Öffne"===e?ig.game.getPlayer().speak("Ich sollte sie erst einstecken."):"Benutze"===e?ig.game.getPlayer().speak("Ich sollte sie erst einstecken."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.inventory-item-wrench").requires("plusplus.core.entity","plusplus.core.config").defines(function(){var e=ig.CONFIG;ig.EntityInventoryItemWrench=ig.global.EntityInventoryItemWrench=ig.EntityExtended.extend({name:"Schraubenschlüssel",size:{x:30,y:16},animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"inventory-item-wrench.gif",30,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},category:"inventory",interact:function(e){"Schau"===e?ig.game.getPlayer().speak("Ein handelsüblicher Schraubenschlüssel."):"Rede"===e?ig.game.getPlayer().speak("Hallo, ich verkaufe diese feinen Lederjacken."):"Nimm"===e?ig.game.getPlayer().speak("Das besitze ich doch schon."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){"Wasserflasche"===e.name?(ig.game.getPlayer().speak("Damit konnte ich die Flasche öffnen!","Den Schraubenschlüssel brauche ich wohl nicht mehr."),e.state="open",ig.game.inventory.removeInventoryItem(this)):"Dino-Ei"===e.name?ig.game.getPlayer().speak("Das Ei ist zu hart. Selbst der Schraubenschlüssel hilft mir da nicht weiter."):ig.game.getPlayer().speak("Die Kombination - er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.entities.item-wrench").requires("plusplus.core.entity","plusplus.core.config","game.entities.inventory-item-wrench").defines(function(){var e=ig.CONFIG;ig.EntityItemWrench=ig.global.EntityItemWrench=ig.EntityExtended.extend({name:"Schraubenschlüssel",collides:ig.Entity.COLLIDES.NEVER,size:{x:3,y:6},interactionDistance:14,matchingInventoryItem:ig.EntityInventoryItemWrench,animSheet:new ig.AnimationSheet(e.PATH_TO_MEDIA+"item-wrench.gif",3,6),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]}},interact:function(e){"Nimm"===e?(ig.game.inventory.addItem(this.matchingInventoryItem,this),ig.game.roomState.wrench.isPickedUp=!0,ig.game.getPlayer().speak("Das brauche ich, oder?")):"Schau"===e?ig.game.getPlayer().speak("Der Schraubenschlüssel, er ist grau."):"Benutze"===e?ig.game.getPlayer().speak("Erst muss ich ihn einstecken."):"Rede"===e?ig.game.getPlayer().speak("Hallo Herr Schraubenschlüssel."):ig.game.getPlayer().speak("Der Befehl, er macht keinen Sinn.")},combine:function(e){ig.game.getPlayer().speak("Die Kombination, er macht keinen Sinn.")}})}),ig.baked=!0,ig.module("game.components.room-state").requires("plusplus.core.config","game.entities.item-lemon","game.entities.item-bottle","game.entities.item-wrench").defines(function(){"use strict";ig.CONFIG,ig.RoomState=ig.Class.extend({lemon:{className:ig.EntityItemLemon,isPickedUp:!1},bottle:{className:ig.EntityItemBottle,isPickedUp:!1},wrench:{className:ig.EntityItemWrench,isPickedUp:!1},createState:function(){var e=ig.game.currentLevel;"testroom"===e&&(this.bottle.isPickedUp||ig.game.spawnEntity(this.bottle.className,180,103)),"testroom2"===e&&this.bottle.isPickedUp,"kitchen"===e&&(this.lemon.isPickedUp||ig.game.spawnEntity(this.lemon.className,182,78)),"junkroom"===e&&(this.wrench.isPickedUp||ig.game.spawnEntity(this.wrench.className,149,69))}})}),ig.baked=!0,ig.module("game.main").requires("plusplus.core.plusplus","game.components.pacloader","game.entities.player","game.levels.titlescreen","game.levels.ending","game.levels.testroom","game.levels.testroom2","game.levels.floor","game.levels.junkroom","game.levels.kitchen","game.components.command-execution","game.ui.pacui","game.ui.inventory","game.components.room-state","plusplus.entities.conversation").defines(function(){"use strict";var e=ig.CONFIG,i=ig.GameExtended.extend({clearColor:"#ff1111",currentLevel:null,hasUntoldBackgroundStory:!0,init:function(){this.parent(),this.loadLevelDeferred("testroom","spawner-a"),this.gui=new ig.Pacui,this.roomState=new ig.RoomState,this.inventory=new ig.Inventory,this.setCursorLayer()},loadLevelDeferred:function(e,i){this.currentLevel=e,this.parent(e,i)},buildLevel:function(){this.parent(),this.centerStaticCamera(),this.roomState.createState(),this.commandExecution=new ig.CommandExecution,this.inventory.respawnInventoryItems()},inputStart:function(){ig.input.bind(ig.KEY.MOUSE1,"click")},tellBackgroundStory:function(){ig.game.spawnEntity(ig.EntityConversation,0,0),ig.game.getPlayer().dance()},showEnding:function(){ig.system.setGame(t)},setCursorLayer:function(){this.addLayer(new ig.Layer("cursor",{zIndex:e.Z_INDEX_ABOVE_ALL}))},centerStaticCamera:function(){ig.game.screen.x=0,ig.game.screen.y=0,ig.game.screen.x-=ig.system.realWidth/2/ig.system.scale-e.GAME_WIDTH_VIEW/2,ig.game.screen.y-=ig.system.realHeight/2/ig.system.scale-e.GAME_HEIGHT_VIEW/2},resize:function(){this.parent(),null!==ig.game&&this.centerStaticCamera()},update:function(){this.parent(),this.hasUntoldBackgroundStory&&(this.tellBackgroundStory(),this.hasUntoldBackgroundStory=!1),ig.game.sortEntities("entities")}}),t=(ig.GameExtended.extend({clearColor:"#000000",init:function(){this.parent(),this.setCursorLayer(),this.loadLevelDeferred("titlescreen"),new ig.Sound(e.PATH_TO_MEDIA+"music/title-theme.*").play()},inputStart:function(){ig.input.bind(ig.KEY.MOUSE1,"click")},setCursorLayer:function(){this.addLayer(new ig.Layer("cursor",{zIndex:e.Z_INDEX_ABOVE_ALL}))},centerStaticCamera:function(){ig.game.screen.x=0,ig.game.screen.y=0,ig.game.screen.x-=ig.system.realWidth/2/ig.system.scale-e.GAME_WIDTH_VIEW/2,ig.game.screen.y-=ig.system.realHeight/2/ig.system.scale-e.GAME_HEIGHT_VIEW/2},resize:function(){this.parent(),null!==ig.game&&this.centerStaticCamera()},update:function(){this.parent(),ig.input.pressed("click")&&ig.system.setGame(i)}}),ig.GameExtended.extend({clearColor:"#000000",init:function(){this.parent(),this.loadLevelDeferred("ending"),new ig.Sound(e.PATH_TO_MEDIA+"music/title-theme.*").play()},centerStaticCamera:function(){ig.game.screen.x=0,ig.game.screen.y=0,ig.game.screen.x-=ig.system.realWidth/2/ig.system.scale-e.GAME_WIDTH_VIEW/2,ig.game.screen.y-=ig.system.realHeight/2/ig.system.scale-e.GAME_HEIGHT_VIEW/2},resize:function(){this.parent(),null!==ig.game&&this.centerStaticCamera()}}));ig.main("#canvas",i,60,e.GAME_WIDTH,e.GAME_HEIGHT,1,ig.pacLoader)});